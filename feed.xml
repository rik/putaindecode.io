<?xml version="1.0" encoding="UTF-8"?><rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title><![CDATA[putaindecode.io]]></title><description><![CDATA[putaindecode.io]]></description><link>http://putaindecode.io</link><generator>RSS for Node</generator><lastBuildDate>Tue, 31 Oct 2017 09:37:56 GMT</lastBuildDate><atom:link href="http://putaindecode.io/feed.xml" rel="self" type="application/rss+xml"/><item><title><![CDATA[Se lancer dans le TDD]]></title><description><![CDATA[<h2 id="introduction"><a href="#introduction" class="phenomic-HeadingAnchor">#</a>Introduction</h2>
<p>Tout commence en octobre 1999 lorsque <a href="https://fr.wikipedia.org/wiki/Kent_Beck">Kent Beck</a>
pr√©sente une nouvelle m√©thode de programmation bas√©e sur AGILE: l'eXtreme Programmming abr√©g√© <em>XP</em>.<br>
l'<em>XP</em> d√©finit des pratiques de d√©veloppement optimis√©es am√©liorant la production et
la robustesse du code.<br>
Parmi les principes les plus connus de sa m√©thode on pourra citer <strong>l'int√©gration continue</strong>
aussi appel√©e <em>CI</em> pour <em>Continuous Integration</em> et <strong>la programmation en bin√¥me</strong>
ou <em>pair programming</em> en anglais.</p>
<p>L'aspect qui nous int√©resse ici est un autre pilier de la m√©thode qui consiste √† piloter
le d√©veloppement par les tests alias <em>TDD</em>.</p>
<p>Le TDD est une pratique controvers√©e car co√ªteuse √† mettre en place.
Popularis√©e par les d√©veloppeurs elle peine √† √©merger.</p>
<p>Avec la multiplication des environnements d'execution, la complexit√© des applications web
et l'essort des projets Open-Source, les d√©veloppeurs se heurtent √† des probl√®mes de
compatibilit√©s crois√©es et d'inconsistances.<br>
Aujourd‚Äôhui les standards sont de plus en plus permissifs et favorisent
ainsi les comportements √† risque. La plupart du temps, les syst√®mes sont capables de
corriger vos erreurs, des fois sans m√™me vous en avertir.</p>
<p>Dans ce contexte :</p>
<ul>
<li>Comment √©crire un code multi-plateforme fonctionnel ?</li>
<li>Comment √™tre s√ªr que les ajouts ne cassent pas le code plus ancien ?</li>
<li>Comment √™tre s√ªr que le code se comporte comme voulu ?</li>
</ul>
<p>Commencer par vous imposer des pratiques de d√©veloppement rigoureuses est imp√©ratif
mais les tests seront un compl√©ment indispensable √† la qualit√© de votre code.</p>
<p>Heureusement, le TDD apporte alors une r√©ponse √©l√©gante √† l'ensemble de ces probl√©matiques.</p>
<h2 id="tdd-vous-avez-dit-tdd-"><a href="#tdd-vous-avez-dit-tdd-" class="phenomic-HeadingAnchor">#</a>TDD, vous avez dit TDD ?</h2>
<p>Le Test Driven Development <em>(D√©veloppement Dirig√© par les Tests)</em>,
est une technique de d√©veloppement qui impose l‚Äô√©criture de tests
avant m√™me l‚Äô√©criture de la premi√®re ligne de code.</p>
<p>Dans la th√©orie, la m√©thode requiert l‚Äôintervention d‚Äôau moins
deux intervenants diff√©rents, une personne √©crit les tests, l‚Äôautre
le code test√©. Cela permet d‚Äô√©viter les probl√®mes li√©s √† la subjectivit√©.</p>
<p>Dans la pratique les choses sont plus compliqu√©es,
parfois on d√©veloppe seul ou on √©crit soit m√™me les tests qui
garantissent l‚Äôint√©grit√© d'une nouvelle feature dans un projet collaboratif.</p>
<blockquote>
<p>Quoi qu‚Äôil arrive, un test peu efficace vaudra toujours mieux que pas de test du tout.
Le but √©tant de prendre l‚Äôhabitude d‚Äôen √©crire et d‚Äô√™tre objectif dans leur r√©daction.</p>
</blockquote>
<p>Le TDD tend √† se d√©mocratiser et elle requiert l‚Äôeffort de chacun pour devenir un standard.
Tout d√©veloppeur soucieux de son environnement et de son h√©ritage doit se poser s√©rieusement
la question.<br>
Les frameworks de tests, les guides et les documentations sur le sujet fleurissent,
vous pouvez donc vous lancer sans crainte.</p>
<p>On peut d√©couper le TDD en 5 √©tapes distinctes :</p>
<ol>
<li>Ecrire un test.</li>
<li>V√©rifier qu‚Äôil √©choue.</li>
<li>Ecrire le code <strong>suffisant</strong> pour que le test passe.</li>
<li>V√©rifier que le test passe.</li>
<li>Optimiser le code et v√©rifier qu‚Äôil n‚Äôy ai pas de r√©gression.</li>
</ol>
<p>Pour simplifier cette logique on peut regrouper ces cinq √©tapes en trois grandes id√©es :</p>
<ul>
<li><strong>Tester d‚Äôabord</strong>, qui correspond aux 2 premi√®res √©tapes.</li>
<li><strong>Rendre fonctionnel</strong>, qui englobe les points 3 et 4.</li>
<li><strong>Rendre meilleur</strong>, qui n‚Äôest autre que l‚Äô√©tape 5.</li>
</ul>
<p>Bill Wake d√©finit ainsi la m√©thode <a href="http://xp123.com/articles/3a-arrange-act-assert/">3A</a>,
pour Arrange, Act, Assert <em>(Arranger, Agir, Affirmer)</em>.<br>
Il insiste sur le fait que la m√©thode ne d√©finit pas un ordre immuable,
l‚Äô<em>affirmation</em> peut ainsi venir avant l‚Äô<em>action</em>, etc...</p>
<ul>
<li><strong>Arranger</strong> : Phase de pr√©paration de l‚Äôenvironnement de test dans laquelle
on d√©clare les variables et les fonctions.</li>
<li><strong>Agir</strong> : Phase qui met √† l‚Äô√©preuve notre environnement en lui faisant subir des mutations.</li>
<li><strong>Affirmer</strong> : On formule des attentes √† propos de l'environement
(variables, fonctions, param√®tres).</li>
</ul>
<h2 id="tdd--concepts-de-base"><a href="#tdd--concepts-de-base" class="phenomic-HeadingAnchor">#</a>TDD : concepts de base</h2>
<p>Pour la s√©rie de tests suivante on utilisera EcmaScript 6 et la methode
<a href="https://developer.mozilla.org/fr/docs/Web/API/Console/assert"><code>.assert()</code></a>
de la console navigateur: Vous pourrez ainsi reproduire ces tests vous-m√™me.</p>
<p>Objectif : Ecrire une fonction <code>countWords()</code> qui compte les mots d'une phrase.</p>
<p><strong>ITERATION 1</strong> : √©criture et √©chec du test initial</p>
<p>On √©crit tout d'abord une affirmation de base.</p>
<pre><code class="hljs language-js"><span class="hljs-built_in">console</span>.assert(countWords(<span class="hljs-string">''</span>) === <span class="hljs-number">0</span>, <span class="hljs-string">'test 0: le texte ne contient aucun mot'</span>);</code></pre>
<blockquote>
<p><code>Uncaught ReferenceError: countWords is not defined</code></p>
</blockquote>
<p>Apr√®s execution la console rejette le test.
On doit d'abord d√©finir <code>countWords()</code>.</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">const</span> countWords = <span class="hljs-function"><span class="hljs-params">()</span> =></span> {};
<span class="hljs-built_in">console</span>.assert(countWords(<span class="hljs-string">''</span>) === <span class="hljs-number">0</span>, <span class="hljs-string">'test 0: le texte ne contient aucun mot'</span>);</code></pre>
<blockquote>
<p><code>Assertion failed: test 0: le texte ne contient aucun mot</code></p>
</blockquote>
<p><code>countWords()</code> est d√©finie et le test √©choue mais l'erreur a chang√©.<br>
Il faut √† pr√©sent d√©finir la logique du coeur de notre fonction.</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">const</span> countWords = <span class="hljs-function"><span class="hljs-params">text</span> =></span> text || <span class="hljs-number">0</span>;
<span class="hljs-built_in">console</span>.assert(countWords(<span class="hljs-string">''</span>) === <span class="hljs-number">0</span>, <span class="hljs-string">'test 0: le texte ne contient aucun mot'</span>);</code></pre>
<blockquote>
<p><code>undefined</code></p>
</blockquote>
<p>La console ne renvoie rien, le test est donc pass√©.  </p>
<blockquote>
<p><code>countWords()</code> √©tant tr√®s simple nous omettrons les phases d'optimisation.
On peut aussi consid√©rer que les it√©rations suivantes comme des optimisations.</p>
</blockquote>
<p><strong>ITERATION 2</strong> : test pour les phrases d'un seul mot</p>
<p>Tr√®s bien. Essayons √† pr√©sent une phrase d'un seul mot.</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">const</span> countWords = <span class="hljs-function"><span class="hljs-params">text</span> =></span> text || <span class="hljs-number">0</span>;
<span class="hljs-built_in">console</span>.assert(countWords(<span class="hljs-string">''</span>) === <span class="hljs-number">0</span>, <span class="hljs-string">'test 0: le texte ne contient aucun mot'</span>);
<span class="hljs-built_in">console</span>.assert(countWords(<span class="hljs-string">'nope'</span>) === <span class="hljs-number">1</span>, <span class="hljs-string">'test 1: le texte contient 1 mot'</span>);</code></pre>
<blockquote>
<p><code>Assertion failed: test 1: le texte contient 1 mot</code></p>
</blockquote>
<p><code>countWords()</code> ne compte pas correctement, ajoutons le code suffisant pour passer le test.</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">const</span> countWords = <span class="hljs-function"><span class="hljs-params">text</span> =></span> text ? text.split(<span class="hljs-string">' '</span>).length : <span class="hljs-number">0</span>;
<span class="hljs-built_in">console</span>.assert(countWords(<span class="hljs-string">''</span>) === <span class="hljs-number">0</span>, <span class="hljs-string">'test 0: le texte ne contient aucun mot'</span>);
<span class="hljs-built_in">console</span>.assert(countWords(<span class="hljs-string">'nope'</span>) === <span class="hljs-number">1</span>, <span class="hljs-string">'test 1: le texte contient 1 mot'</span>);</code></pre>
<blockquote>
<p><code>undefined</code></p>
</blockquote>
<p>Le test est pass√©, ajoutons un autre cas standard.</p>
<p><strong>ITERATION 3</strong> : test pour les phrases de plusieurs mots</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">const</span> countWords = <span class="hljs-function"><span class="hljs-params">text</span> =></span> text ? text.split(<span class="hljs-string">' '</span>).length : <span class="hljs-number">0</span>;
<span class="hljs-built_in">console</span>.assert(countWords(<span class="hljs-string">''</span>) === <span class="hljs-number">0</span>, <span class="hljs-string">'test 0: le texte ne contient aucun mot'</span>);
<span class="hljs-built_in">console</span>.assert(countWords(<span class="hljs-string">'nope'</span>) === <span class="hljs-number">1</span>, <span class="hljs-string">'test 1: le texte contient 1 mot'</span>);
<span class="hljs-built_in">console</span>.assert(countWords(<span class="hljs-string">'tdd is fun bro'</span>) === <span class="hljs-number">4</span>, <span class="hljs-string">'test 2: le texte contient 4 mots'</span>);</code></pre>
<blockquote>
<p><code>undefined</code></p>
</blockquote>
<p>Le nouveau test passe sans modification, on peut continuer.</p>
<p><strong>ITERATION 4</strong> : test pour les phrases contenant des espaces au d√©but et √† la fin</p>
<p>V√©rifions √† pr√©sent la robustesse de la fonction.</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">const</span> countWords = <span class="hljs-function"><span class="hljs-params">text</span> =></span> text ? text.split(<span class="hljs-string">' '</span>).length : <span class="hljs-number">0</span>;
<span class="hljs-built_in">console</span>.assert(countWords(<span class="hljs-string">''</span>) === <span class="hljs-number">0</span>, <span class="hljs-string">'test 0: le texte ne contient aucun mot'</span>);
<span class="hljs-built_in">console</span>.assert(countWords(<span class="hljs-string">'nope'</span>) === <span class="hljs-number">1</span>, <span class="hljs-string">'test 1: le texte contient 1 mot'</span>);
<span class="hljs-built_in">console</span>.assert(countWords(<span class="hljs-string">'tdd is fun bro'</span>) === <span class="hljs-number">4</span>, <span class="hljs-string">'test 2: le texte contient 4 mots'</span>);
<span class="hljs-built_in">console</span>.assert(countWords(<span class="hljs-string">' so is skateboarding '</span>) === <span class="hljs-number">3</span>, <span class="hljs-string">'test 3: le texte contient 3 mots'</span>);</code></pre>
<blockquote>
<p><code>Assertion failed: test 3: le texte contient 3 mots</code></p>
</blockquote>
<p>Aie.. notre fonction n'est pas assez solide. Corrigeons la pour capter ce nouveau cas en supprimant les
espaces inutiles avant et apr√®s le texte.</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">const</span> countWords = <span class="hljs-function"><span class="hljs-params">text</span> =></span> text ? text.trim().split(<span class="hljs-string">' '</span>).length : <span class="hljs-number">0</span>;
<span class="hljs-built_in">console</span>.assert(countWords(<span class="hljs-string">''</span>) === <span class="hljs-number">0</span>, <span class="hljs-string">'test 0: le texte ne contient aucun mot'</span>);
<span class="hljs-built_in">console</span>.assert(countWords(<span class="hljs-string">'nope'</span>) === <span class="hljs-number">1</span>, <span class="hljs-string">'test 1: le texte contient 1 mot'</span>);
<span class="hljs-built_in">console</span>.assert(countWords(<span class="hljs-string">'tdd is fun bro'</span>) === <span class="hljs-number">4</span>, <span class="hljs-string">'test 2: le texte contient 4 mots'</span>);
<span class="hljs-built_in">console</span>.assert(countWords(<span class="hljs-string">' so is skateboarding '</span>) === <span class="hljs-number">3</span>, <span class="hljs-string">'test 3: le texte contient 3 mots'</span>);</code></pre>
<blockquote>
<p><code>undefined</code></p>
</blockquote>
<p>Parfait, La fonction est am√©lior√©e! Ajoutons quand m√™me un dernier test pour √™tre sur.</p>
<p><strong>ITERATION 5</strong> : test pour les phrases contenant un nombre in√©gal d'espaces entre les mots</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">const</span> countWords = <span class="hljs-function"><span class="hljs-params">text</span> =></span> text ? text.trim().split(<span class="hljs-string">' '</span>).length : <span class="hljs-number">0</span>;
<span class="hljs-built_in">console</span>.assert(countWords(<span class="hljs-string">''</span>) === <span class="hljs-number">0</span>, <span class="hljs-string">'test 0: le texte ne contient aucun mot'</span>);
<span class="hljs-built_in">console</span>.assert(countWords(<span class="hljs-string">'nope'</span>) === <span class="hljs-number">1</span>, <span class="hljs-string">'test 1: le texte contient 1 mot'</span>);
<span class="hljs-built_in">console</span>.assert(countWords(<span class="hljs-string">'tdd is fun bro'</span>) === <span class="hljs-number">4</span>, <span class="hljs-string">'test 2: le texte contient 4 mots'</span>);
<span class="hljs-built_in">console</span>.assert(countWords(<span class="hljs-string">' so is skateboarding '</span>) === <span class="hljs-number">3</span>, <span class="hljs-string">'test 3: le texte contient 3 mots'</span>);
<span class="hljs-built_in">console</span>.assert(countWords(<span class="hljs-string">`  I'm 28, I love $#@! and    multi-spaces  `</span>) === <span class="hljs-number">7</span>, <span class="hljs-string">'test 4: le texte contient 7 mots'</span>);</code></pre>
<blockquote>
<p><code>Assertion failed: test 4: le texte contient 7 mots</code></p>
</blockquote>
<p>Et mince.. Encore un cas particulier, modifions l'algorithme en cons√©quence.
On doit ici retirer les espaces inutiles entre les mots.</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">const</span> countWords = <span class="hljs-function"><span class="hljs-params">text</span> =></span> text ? text.trim().replace(<span class="hljs-regexp">/\s+/g</span>, <span class="hljs-string">' '</span>).split(<span class="hljs-string">' '</span>).length : <span class="hljs-number">0</span>;
<span class="hljs-built_in">console</span>.assert(countWords(<span class="hljs-string">''</span>) === <span class="hljs-number">0</span>, <span class="hljs-string">'test 0: le texte ne contient aucun mot'</span>);
<span class="hljs-built_in">console</span>.assert(countWords(<span class="hljs-string">'nope'</span>) === <span class="hljs-number">1</span>, <span class="hljs-string">'test 1: le texte contient 1 mot'</span>);
<span class="hljs-built_in">console</span>.assert(countWords(<span class="hljs-string">'tdd is fun bro'</span>) === <span class="hljs-number">4</span>, <span class="hljs-string">'test 2: le texte contient 4 mots'</span>);
<span class="hljs-built_in">console</span>.assert(countWords(<span class="hljs-string">' so is skateboarding '</span>) === <span class="hljs-number">3</span>, <span class="hljs-string">'test 3: le texte contient 3 mots'</span>);
<span class="hljs-built_in">console</span>.assert(countWords(<span class="hljs-string">`  I'm 28, I love $#@! and    multi-spaces  `</span>) === <span class="hljs-number">7</span>, <span class="hljs-string">'test 4: le texte contient 7 mots'</span>);</code></pre>
<blockquote>
<p><code>undefined</code></p>
</blockquote>
<p>Le test final est pass√© sans que les pr√©c√©dents n'√©chouent.</p>
<p>On notera que l'√©criture de tests est un processus it√©ratif.<br>
La phase d'optimisation implique l'√©criture d'un nouveau test qui √©choue
et relance donc une nouvelle it√©ration.</p>
<p>Evidemment <code>countWords()</code> est tr√®s largement sous-optimis√©e et ne couvre pas tous les cas sp√©ciaux.
On aurait pu ajouter une v√©rification sur le param√®tre <code>text</code> et compter avec une expression r√©guli√®re comme ceci :</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">const</span> countWords = <span class="hljs-function"><span class="hljs-params">text</span> =></span> <span class="hljs-keyword">typeof</span> text === <span class="hljs-string">'string'</span> &#x26;&#x26; text.trim() ? text.match(<span class="hljs-regexp">/\S+\s{0,1}/g</span>).length : <span class="hljs-number">0</span>;</code></pre>
<p>L'id√©e ici est que coder est un processus incr√©mental et que chaque nouveau cycle doit √™tre initi√©
par un besoin sp√©cifique d√©fini par un test d√©di√©.  </p>
<p>L'√©criture des tests est simple: on d√©compose notre script en une suite d'affirmations
correspondant chacune √† une fonctionnalit√© pr√©cise de notre algorithme.</p>
<p>Gr√¢ce √† ce processus on √©vite :</p>
<ul>
<li><strong>les r√©gressions</strong>: la suite valide de tests est la garantie que le code reste
fonctionnel malgr√© les √©volutions de l'algorithm.</li>
<li><strong>le code mort</strong>: chaque morceau de code √©crit est test√© et a son utilit√©.</li>
<li><strong>le code non document√©</strong>: chaque comportement est d√©crit de mani√®re fonctionnelle.</li>
</ul>
<h2 id="bdd--des-tests-pour-tous"><a href="#bdd--des-tests-pour-tous" class="phenomic-HeadingAnchor">#</a>BDD : Des tests pour tous</h2>
<p>Une variante plus agnostique de la logique du d√©veloppeur existe et permet √† des
intervenants externes de faire partie int√©grante du processus cr√©atif.</p>
<p>le BDD, Behaviour Driven Development (D√©veloppement Dirig√© par le Comportement),
permet de d√©finir de mani√®re compr√©hensible pour tous les intervenants les
sp√©cifications d‚Äôune fonctionnalit√©. Cela permet aussi aux d√©veloppeurs de comprendre
le comportement g√©n√©ral sans √©voquer les d√©tails techniques.
La discussion est donc facilit√©e entre les diff√©rents acteurs.  </p>
<p>Pour illustrer cette variante adaptons l'exemple pr√©c√©dent :</p>
<blockquote>
<p>Note : Pour ex√©cuter ce type de code vous aurez besoin d'un <em>test-runner</em> comme
<a href="https://facebook.github.io/jest/">Jest</a>, <a href="https://mochajs.org">Mocha</a> ou <a href="https://karma-runner.github.io">Karma</a>.</p>
</blockquote>
<pre><code class="hljs language-js"><span class="hljs-keyword">const</span> countWords = <span class="hljs-function"><span class="hljs-params">text</span> =></span> text ? text.trim().replace(<span class="hljs-regexp">/\s+/g</span>, <span class="hljs-string">' '</span>).split(<span class="hljs-string">' '</span>).length : <span class="hljs-number">0</span>;

describe(<span class="hljs-string">'countWords()'</span>, () => {
  it(<span class="hljs-string">'doit traiter un texte vide'</span>, () => {
    expect(countWords(<span class="hljs-string">''</span>)).toBe(<span class="hljs-number">0</span>);
  });

  it(<span class="hljs-string">'doit traiter un texte d\'un seul mot'</span>, () => {
    expect(countWords(<span class="hljs-string">'nope'</span>)).toBe(<span class="hljs-number">1</span>);
  });

  it(<span class="hljs-string">'doit traiter un texte de n mots'</span>, () => {
    expect(countWords(<span class="hljs-string">'tdd is fun bro'</span>)).toBe(<span class="hljs-number">4</span>);
  });

  it(<span class="hljs-string">'doit traiter un texte avec des espaces aux extr√©mit√©s'</span>, () => {
    expect(countWords(<span class="hljs-string">' so is skateboarding '</span>)).toBe(<span class="hljs-number">3</span>);
  });

  it(<span class="hljs-string">'doit traiter un texte avec des espaces in√©gaux entre les mots'</span>, () => {
    expect(countWords(<span class="hljs-string">`  I'm 28, I love $#@! and    multi-spaces  `</span>)).toBe(<span class="hljs-number">7</span>);
  });
});</code></pre>
<p>Voici le r√©sultat du run :</p>
<p><img src="./testrunner.png" alt="r√©sultat du run de tests"></p>
<p>La relecture est simplifi√©e pour tous les participants non technique.</p>
<h2 id="conclusion"><a href="#conclusion" class="phenomic-HeadingAnchor">#</a>Conclusion</h2>
<p>Le TDD est destin√© √† √™tre incorpor√© √† un processus d'<a href="http://putaindecode.io/fr/articles/ci/">Int√©gration Continue</a>
pour s'assurer du bon fonctionnement de l'application sur tous les environnements
de production apr√®s chaque nouveau <code>commit</code>.  </p>
<p>J'esp√®re vous avez appr√©ci√© la demo et que √ßa vous a donn√© envie de
tester le TDD pour apporter √©quilibre et harmonie √† votre code.  </p>
<p>Dans tous les cas, je peux vous certifier que les autres codeurs vont
en seront reconnaissant, croyez-moi.</p>
]]></description><link>http://putaindecode.io/fr/articles/tdd/</link><guid isPermaLink="true">http://putaindecode.io/fr/articles/tdd/</guid><pubDate>Tue, 31 Oct 2017 00:00:00 GMT</pubDate></item><item><title><![CDATA[Swift - la fonction: une closure particuli√®re]]></title><description><![CDATA[<p><strong>Swift</strong> est un langage simple pour les d√©butants, tout en offrant de grandes possibilit√©es aux d√©veloppeurs exp√©riment√©s. Les <em>fonctions</em> Swift sont un bon exemple de cette fa√ßon d‚Äôavoir pens√© le langage.</p>
<h2 id="les-fonctions"><a href="#les-fonctions" class="phenomic-HeadingAnchor">#</a>Les fonctions</h2>
<h3 id="d√©claration-simple"><a href="#d%C3%A9claration-simple" class="phenomic-HeadingAnchor">#</a>D√©claration simple</h3>
<p>La d√©claration et l‚Äôutilisation de <em>fonctions</em> est simple. On commence avec le mot cl√© <code>func</code> suivi du <em>nom</em>, puis des <em>param√®tres</em> entre parenth√®ses (a.k.a. <code>input</code>) :</p>
<pre><code class="hljs language-swift"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">sayHello</span><span class="hljs-params">(name:String, age:UInt)</span></span>{
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"Hello <span class="hljs-subst">\(name)</span>, you are <span class="hljs-subst">\(age)</span>"</span>)
}</code></pre>
<p>L‚Äôappel se fait aussi simplement que √ßa : <code>sayHello(name:"Bob", age: 32)</code>. Le mot cl√© <code>_</code> permet d'enlever le label du param√®tre dans l'appel si besoin :</p>
<pre><code class="hljs language-swift"><span class="hljs-comment">// Declaration</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">sayHello</span><span class="hljs-params">(name:String,<span class="hljs-number">_</span> age:UInt)</span></span>{
 <span class="hljs-built_in">print</span>(<span class="hljs-string">"Hello <span class="hljs-subst">\(name)</span>, you are <span class="hljs-subst">\(age)</span>"</span>)
}
<span class="hljs-comment">// Appel</span>
sayHello(name:<span class="hljs-string">"Bob"</span>, <span class="hljs-number">32</span>)</code></pre>
<p>Mais vous perdrez en clart√© de code suivant les cas. Par exemple, avec <code>min(3,6)</code> on voit tout de suite ce que fait la fonction. Alors que <code>sayHelloTo("Bob", 32)</code>, le <code>32</code> pourrait √™tre beaucoup de choses.</p>
<blockquote>
<p>Les param√®tres sont obligatoirement typ√©s, mais peuvent √™tre optionnels (en autorisant la valeur nil) avec la notation ? (e.g. Int?, String?).</p>
</blockquote>
<p>Vous pouvez aussi d√©finir des valeurs par d√©fauts pour les param√®tres :</p>
<pre><code class="hljs language-swift"><span class="hljs-comment">// Declaration</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">sayHello</span><span class="hljs-params">(name:String, <span class="hljs-number">_</span> age:UInt? = <span class="hljs-literal">nil</span>)</span></span>{
    <span class="hljs-keyword">if</span> age == <span class="hljs-literal">nil</span> {
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"Hello <span class="hljs-subst">\(name)</span>"</span>)
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"Hello <span class="hljs-subst">\(name)</span>, you are <span class="hljs-subst">\(age!)</span>"</span>) <span class="hljs-comment">//! permet de pas afficher Optinal(value)</span>
    }
}
<span class="hljs-comment">// Appel</span>
sayHello(name:<span class="hljs-string">"Bob"</span>) <span class="hljs-comment">// -> Hello Bob</span>
sayHello(name:<span class="hljs-string">"Bob"</span>, <span class="hljs-number">32</span>) <span class="hljs-comment">// ->  Hello Bob, you are 32</span></code></pre>
<p>La plupart du temps nos fonctions servent √† nous retourner des informations. Pour cela on utilise <code>-></code> en signe de retour suivi du type de la valeur retourn√©e.</p>
<pre><code>func formatHelloSentence(name:String, age:UInt? = nil) -> String {
    if age == nil {
        return "Hello \(name)"
    } else {
        return "Hello \(name), you are \(age)"
    }
}
// Appel
let helloSentence = formatHelloSentence(name:"Bob", age: 32)
</code></pre>
<h3 id="retours-multiples-ou-tuples"><a href="#retours-multiples-ou-tuples" class="phenomic-HeadingAnchor">#</a>Retours multiples ou Tuples</h3>
<p>Apple n‚Äôest pas connu pour sa g√©n√©rosit√©, mais dans Swift ils en ont fait autrement <code>:troll:</code> : on peut retourner plusieurs valeurs avec une seule fonction. Pour cela on utilise un <code>Tuple</code> : un collection de variables ordonn√©es.</p>
<pre><code class="hljs language-swift"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">hardFunction</span><span class="hljs-params">(fInputs:[Float])</span></span>->(<span class="hljs-type">Int</span>,<span class="hljs-type">Int</span>,<span class="hljs-type">Float</span>,<span class="hljs-type">String</span>) {    
    <span class="hljs-keyword">var</span> a = <span class="hljs-number">0</span>
    <span class="hljs-keyword">var</span> b = <span class="hljs-number">0</span>
    <span class="hljs-keyword">var</span> f : <span class="hljs-type">Float</span> = <span class="hljs-number">0.0</span>
    <span class="hljs-keyword">var</span> str = <span class="hljs-string">""</span>
    <span class="hljs-comment">//...</span>
    <span class="hljs-keyword">return</span> (a,b,f,str)
}</code></pre>
<p>Ici cette fonction prend en param√®tres un tableau de <code>Float</code> et retourne un <em>Tuple</em> compos√© de deux <code>Int</code>, un <code>Float</code> et un <code>String</code> dans cet ordre. Vous pouvez alors utiliser le <em>Tuple</em> comme une structure en utilisant l‚Äôindex des √©l√©ments du <em>Tuple</em> comme nom de variable (ex: <code>0</code>pour le premier <code>Int</code>, <code>3</code> pour le <code>String</code>).</p>
<pre><code class="hljs language-swift"><span class="hljs-keyword">let</span> myTuple = hardFunction([<span class="hljs-number">2.4</span>,<span class="hljs-number">2.6</span>,<span class="hljs-number">1.8</span>])
<span class="hljs-keyword">let</span> myTupleString = myTuple.<span class="hljs-number">3</span></code></pre>
<p>Mais ceci reste assez confus, alors on peut nommer les √©l√©ments.</p>
<pre><code class="hljs language-swift"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">hardFunction</span><span class="hljs-params">(fInputs:[Float])</span></span>->(valSup:<span class="hljs-type">Int</span>,
        valMax:<span class="hljs-type">Int</span>,
        average:<span class="hljs-type">Float</span>,
        errorString:<span class="hljs-type">String</span>) {
    <span class="hljs-comment">//...</span>
}

<span class="hljs-comment">//utilisation</span>
<span class="hljs-keyword">let</span> myTuple = hardFunction([<span class="hljs-number">2.4</span>,<span class="hljs-number">2.6</span>,<span class="hljs-number">1.8</span>])
<span class="hljs-keyword">let</span> myTupleString = myTuple.errorString <span class="hljs-comment">// myTuple.3 marche encore</span></code></pre>
<p>L'ex√©cution du code permettant d'avoir les valeurs <em>Tuple</em> n'est effectu√©e qu'√† la demande de ces valeurs. Dans l'exemple ci-dessus, le code de <code>hardFunction</code> ne sera appel√© qu'√† la derni√®re ligne, car c'est l√† qu'on a besoin de <code>errorString</code>, pas avant.</p>
<p> Et la notion de <em>Closure</em> fait son entr√©e!</p>
<h2 id="la-closure-la-variable-fonction"><a href="#la-closure-la-variable-fonction" class="phenomic-HeadingAnchor">#</a>La closure: la variable-fonction</h2>
<h3 id="qu√©saco"><a href="#qu%C3%A9saco" class="phenomic-HeadingAnchor">#</a>Qu√©saco</h3>
<p><strong>Une <em>closure</em> est une partie de code, avec param√®tres et sorties, qui peut √™tre encapsul√© dans une variable, et ex√©cut√©e √† la demande</strong>. Si vous d√©veloppez en C++ ou Objective-C vous connaissez peut-√™tre d√©j√† les <em>blocks</em> et en Java ou C# les <em>lambdas</em> qui sont des <em>features</em> tr√®s (tr√®s) proches.</p>
<h3 id="d√©claration"><a href="#d%C3%A9claration" class="phenomic-HeadingAnchor">#</a>D√©claration</h3>
<p>Une <em>closure</em>  se d√©clare gr√¢ce au <code>{}</code> et peut √™tre appel√©e (ex√©cut√©e) gr√¢ce aux parenth√®ses :</p>
<pre><code class="hljs language-swift"> <span class="hljs-keyword">let</span> helloClosure = {
     <span class="hljs-built_in">print</span>(<span class="hljs-string">"hello, I‚Äôm a closure"</span>)
 }

 helloClosure() <span class="hljs-comment">// Le code est ex√©cut√© ici</span></code></pre>
<p>√áa vous rappelle rien ? L‚Äôappel d‚Äôune <em>fonction</em> ! En r√©alit√©, la <em>fonction</em> est une <em>closure</em> particuli√®re associ√© √† un contexte (Object, environnement, Bundle...) pour r√©aliser des optimisations et une meilleur compr√©hension du code.</p>
<blockquote>
<p>Pour une <em>closure</em> "√† l‚Äôair libre", on dit d‚Äôelle, qu‚Äôelle est <em>Self Contained</em> alors qu‚Äôune fonction est contenue par un contexte (<code>class</code> par exemple)</p>
</blockquote>
<p>Comme les fonctions, les <em>closures</em>  ont des param√®tres d‚Äôentr√©e et de retour:  </p>
<pre><code class="hljs language-swift"><span class="hljs-keyword">let</span> complexClosure = {(name:<span class="hljs-type">String</span>, age:<span class="hljs-type">Float</span>) -> <span class="hljs-type">Bool</span> <span class="hljs-keyword">in</span>
    <span class="hljs-comment">// Code</span>
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>
}
<span class="hljs-keyword">let</span> success = complexClosure(<span class="hljs-string">"Louis"</span>,<span class="hljs-number">32</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"Louis has <span class="hljs-subst">\(success)</span>"</span>)</code></pre>
<p>Ainsi, les valeurs dans la premi√®re partie apr√®s la <code>{</code> sont les param√®tres d‚Äôentr√©es et apr√®s la <code>-></code> ce sont les param√®tres de sortie. Le code √† ex√©cuter est apr√®s le <code>in</code>.</p>
<blockquote>
<p>Comme vous avez d√ª le remarquer, les <em>closures</em> n‚Äôont pas de param√®tres nominatif. IL faut passer les param√®tres d'entr√©e dans l'ordre de la d√©claration.</p>
</blockquote>
<h3 id="closure-et-type"><a href="#closure-et-type" class="phenomic-HeadingAnchor">#</a>Closure et Type</h3>
<p>Toute variable est typ√©e en <em>Swift</em>, implicitement ou explicitement. Pour les <em>closures</em> le type est souvent implicite, aussi bien qu‚Äôon en oublie souvent qu‚Äôelles sont typ√©es. Le type d‚Äôune closure va √™tre d√©fini par ses param√®tres d‚Äôentr√©e et de sortie. Ainsi la <em>complexClosure</em>  ci-dessus est du type : <code>((String, Float)) -> (Bool)</code>.</p>
<p>Je peux alors √©crire ce code puisque les closures sont du m√™me type :</p>
<pre><code class="hljs language-swift"><span class="hljs-keyword">let</span> otherComplexClosure = { (surname:<span class="hljs-type">String</span>,size:<span class="hljs-type">Float</span>) -> <span class="hljs-type">Bool</span> <span class="hljs-keyword">in</span>
    <span class="hljs-comment">// Other complexe Code</span>
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>
}
complexClosure = otherComplexClosure</code></pre>
<h3 id="utilisation-du-contexte"><a href="#utilisation-du-contexte" class="phenomic-HeadingAnchor">#</a>Utilisation du contexte</h3>
<p>Les <em>closures</em> ont une connaissance du contexte qui l‚Äôentoure. Ce qui veut dire que si la closure est cr√©√© dans une m√©thode, elle aura acc√®s :</p>
<ul>
<li>au contexte de classe en passant par <code>self</code> (variables, autre fonctions...)</li>
<li>au contexte de la fonction (param√®tres, fonctions internes...)</li>
</ul>
<pre><code class="hljs language-swift"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Animal</span> </span>{
    <span class="hljs-keyword">var</span> name = <span class="hljs-string">"Boby"</span>

    <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">crier</span><span class="hljs-params">(cri:String)</span></span>{
        <span class="hljs-keyword">let</span> uselessClosure = {
            <span class="hljs-built_in">print</span>(<span class="hljs-string">"<span class="hljs-subst">\(<span class="hljs-keyword">self</span>.name)</span> cri <span class="hljs-subst">\(cri)</span>"</span>)
        }
        uselessClosure()
    }
}</code></pre>
<h3 id="trailing-closure"><a href="#trailing-closure" class="phenomic-HeadingAnchor">#</a>Trailing Closure</h3>
<p>Pour finir, un peu d'esth√©tisme car on aime tous le <em>beau</em> code. La <em>Trailing Closure</em> est une syntaxe d'appel de fonction qui permet de rendre le code plus facile √† lire.</p>
<p>Prenant la fonction suivante, prenant une <code>URL</code> est une closure de type <code>Void->Void</code> :</p>
<pre><code class="hljs language-swift"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">doLongTask</span><span class="hljs-params">(on file:URL,
        completion:<span class="hljs-params">()</span></span></span> -> ()){
    <span class="hljs-comment">//long task</span>
    completion()
}</code></pre>
<p>On alors l'appeler cette fonction comme ceci :</p>
<pre><code class="hljs language-swift">doLongTask(on: aFileURL, completion:{
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"Task Applied on <span class="hljs-subst">\(aFileURL)</span>"</span>)
})</code></pre>
<p>Avec du code plus complexe, √ßa commence √† devenir difficile √† lire. Or si le dernier param√®tre d'une fonction est une <em>closure</em>, on peut alors √©crire l'appel comme ceci :</p>
<pre><code class="hljs language-swift">doLongTask(on: aFileURL){
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"Task Applied on <span class="hljs-subst">\(aFileURL)</span>"</span>)
}</code></pre>
<h2 id="pro-tip"><a href="#pro-tip" class="phenomic-HeadingAnchor">#</a>Pro Tip</h2>
<p>Imaginons une classe <code>A</code> ayant une variable <code>event</code>  et un classe <code>B</code> ayant une fonction <code>awesomeEvent</code> ayant le m√™me type que la variable <code>event</code> de la classe <code>A</code>. Je peux alors allouer, √† la variable <code>event</code>, le code de <code>awesomeEvent</code>.</p>
<pre><code class="hljs language-swift"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">A</span> </span>{
    <span class="hljs-keyword">var</span> event : ((<span class="hljs-type">String</span>)-><span class="hljs-type">Void</span>)?
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">B</span> </span>{
    <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">awesome</span><span class="hljs-params">(name:String)</span></span>{
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"Awesome <span class="hljs-subst">\(name)</span>"</span>)
    }
}

<span class="hljs-keyword">let</span> b = <span class="hljs-type">B</span>()
<span class="hljs-keyword">let</span> a = <span class="hljs-type">A</span>()

a.event = b.awesome
a.event?(<span class="hljs-string">"Dude"</span>)</code></pre>
<p><a href="http://swift.sandbox.bluemix.net/#/repl/59ecdb8508529b23242b5696">Ex√©cutez ce code sur IBM Swift Sandbox c'est magique!</a></p>
<h2 id="conclusion"><a href="#conclusion" class="phenomic-HeadingAnchor">#</a>Conclusion</h2>
<p>Voil√† vous savez tout, ou presque, sur les fonctions et les closures. Les closures ont vraiment la part belle en Swift, donc apprenez √† les utiliser et les comprendre pour simplifiez votre code. Elles sont partout dans les API iOS et macOS.</p>
<p>Et un petit conseil: faite attention √† l'√©tat de vos <em>closures</em> dans vos <code>Thread</code> si vous ne voulez pas de fuite üòä</p>
]]></description><link>http://putaindecode.io/fr/articles/swift/closure/</link><guid isPermaLink="true">http://putaindecode.io/fr/articles/swift/closure/</guid><pubDate>Thu, 26 Oct 2017 00:00:00 GMT</pubDate></item><item><title><![CDATA[Introduction aux pattern des observables]]></title><description><![CDATA[<p>En JavaScript, nous pouvons ex√©cuter du code de mani√®re synchrone (bloquant) ou
asynchrone (non bloquant).</p>
<p>Prenons une fonction <code>logValue</code>, qui prend une valeur et l'affiche dans la
console :</p>
<pre><code class="hljs language-javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">logValue</span>(<span class="hljs-params">value</span>) </span>{
  <span class="hljs-built_in">console</span>.log(value);
}</code></pre>
<p>Nous allons passer <code>logValue</code> comme callback √† la m√©thode
<code>Array.prototype.forEach</code>, qui va l'ex√©cuter de mani√®re <strong>synchrone</strong> :</p>
<pre><code class="hljs language-JavaScript"><span class="hljs-keyword">const</span> arrayOfValues = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>]

arrayOfValues.forEach(logValue)
<span class="hljs-comment">// Log 1, 2, 3, 4 puis 5</span></code></pre>
<p>On peut √©galement passer <code>logValue</code> comme callback de <code>setTimeout</code>, qui va
l'ex√©cuter de mani√®re <strong>asynchrone</strong> :</p>
<pre><code class="hljs language-JavaScript">setTimeout(logValue, <span class="hljs-number">3000</span>, <span class="hljs-string">"Hello world!"</span>)
logValue(<span class="hljs-string">"How are you?"</span>)
<span class="hljs-comment">// Log "How are you?"</span>
<span class="hljs-comment">// Log "Hello world!" 3 secondes plus tard</span></code></pre>
<p>Une fonction est agnostique: elle peut √™tre appel√©e de mani√®re synchrone ou
asynchrone, c'est la fa√ßon dont elle est ex√©cut√©e qui d√©finira le "mode".</p>
<p>Un cas o√π il est utile d'utiliser des APIs asynchrones avec Node.js: les acc√®s
au <em>file-system</em>. Si vous lisez un gros fichier en mode synchrone, il va bloquer
l'ex√©cution de votre programme tant qu'il n'a pas fini, mieux vaut attendre
qu'il vous l'envoie quand il est pr√™t.</p>
<p>Node.js propose l'API suivante: <code>fs.readFile(fileToRead, options, callback)</code></p>
<pre><code class="hljs language-JavaScript">fs.readFile(<span class="hljs-string">"./alphabet.txt"</span>, {<span class="hljs-attr">encoding</span>: <span class="hljs-string">"utf-8"</span>}, (err, data) => {
  <span class="hljs-keyword">if</span> (err) {
    onError(err)
  } <span class="hljs-keyword">else</span> {
    onData(data)
  }
})</code></pre>
<p>Cet exemple montre une API utilisant un simple callback qui est ex√©cut√© lorsque
<code>readFile</code> a lu le fichier ou √©chou√© √† le faire.</p>
<p>Un autre cas o√π utiliser des APIs asynchrones est particuli√®rement important :
les appels r√©seaux. On ne peut pas se permettre de <em>freeze</em> toute notre
interface pendant que la requ√™te r√©seau tourne.</p>
<pre><code class="hljs language-JavaScript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">logValue</span>(<span class="hljs-params">value</span>) </span>{ <span class="hljs-built_in">console</span>.log(value) }
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">logError</span>(<span class="hljs-params">err</span>) </span>{ <span class="hljs-built_in">console</span>.error(err) }

fetch(<span class="hljs-string">"https://api.github.com/users/wyeo"</span>)
  .then(<span class="hljs-function"><span class="hljs-params">res</span> =></span> res.json())
  .then(logValue) <span class="hljs-comment">// Log le payload JSON lorsque la requ√™te est termin√©e</span>
  .catch(logError) <span class="hljs-comment">// Lance une erreur dans la console si quelque chose s'est mal pass√©</span></code></pre>
<p>Dans cet exemple, l'API renvoie une <code>Promise</code>: <a href="/fr/articles/js/es2015/promises/">une structure repr√©sentant une
valeur potentielle</a>. Lorsque sa valeur est
disponible, la promesse est <em>remplie</em>, et ex√©cutera les callbacks qu'on lui a
pass√© dans <code>.then</code>, si elle constate une erreur, elle ex√©cutera les callbacks
qu'on lui a pass√© dans <code>.catch</code>.</p>
<p>Les <code>Promise</code> ne permettent cependant pas de traiter de la donn√©e au fur et √†
mesure de son arriv√©e: elle est remplie une seule fois.</p>
<p>C'est l√† que les <code>Observable</code> arrivent √† la rescousse.</p>
<p>Un <code>Observable</code> est un objet impl√©mentant une m√©thode <code>.subscribe</code> qui prend
comme param√®tre un <code>Observer</code>. Ce dernier a cette forme :</p>
<pre><code class="hljs language-javascript"><span class="hljs-keyword">const</span> observer = {
  <span class="hljs-attr">next</span>: <span class="hljs-function"><span class="hljs-params">val</span> =></span> <span class="hljs-built_in">console</span>.log(val), <span class="hljs-comment">// une fonction √† ex√©cuter √† chaque nouvel √©venement</span>
  error: <span class="hljs-function"><span class="hljs-params">err</span> =></span> <span class="hljs-built_in">console</span>.error(err), <span class="hljs-comment">// une fonction √† ex√©cuter en cas d'erreur</span>
  complete: <span class="hljs-function"><span class="hljs-params">()</span> =></span> <span class="hljs-built_in">console</span>.info(<span class="hljs-string">"Complete!"</span>) <span class="hljs-comment">// une fonction √† ex√©cuter lorsque l'observable a fini</span>
};</code></pre>
<p>Impl√©mentons na√Øvement un <code>Observable</code> qui va r√©agir lorsqu'un user va taper sur
son clavier et se consid√©rer termin√© une fois <code>Enter</code> press√©:</p>
<pre><code class="hljs language-javascript"><span class="hljs-keyword">const</span> KeyboardObservable = {
  <span class="hljs-attr">subscribe</span>: <span class="hljs-function"><span class="hljs-params">observer</span> =></span> {
    <span class="hljs-keyword">const</span> handleKeyUp = <span class="hljs-function"><span class="hljs-params">event</span> =></span> {
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> event.keyCode === <span class="hljs-string">"number"</span>) {
        <span class="hljs-keyword">if</span> (event.keyCode === <span class="hljs-number">13</span> <span class="hljs-comment">/* Enter */</span>) {
          <span class="hljs-built_in">document</span>.removeEventListener(<span class="hljs-string">"keyup"</span>, handleKeyUp);
          observer.complete();
        } <span class="hljs-keyword">else</span> {
          observer.next(event.keyCode);
        }
      } <span class="hljs-keyword">else</span> {
        observer.error(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"No keyCode found"</span>));
      }
    };
    <span class="hljs-built_in">document</span>.addEventListener(<span class="hljs-string">"keyup"</span>, handleKeyUp);
    <span class="hljs-comment">// subscribe retourne la "soucription", contenant une fonction pour la stopper</span>
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">unsubscribe</span>: <span class="hljs-function"><span class="hljs-params">()</span> =></span> <span class="hljs-built_in">document</span>.removeEventListener(<span class="hljs-string">"keyup"</span>, handleKeyUp)
    };
  }
};

<span class="hljs-keyword">let</span> keys = [];
KeyboardObservable.subscribe({
  <span class="hljs-attr">next</span>: <span class="hljs-function"><span class="hljs-params">keyCode</span> =></span> keys.push(<span class="hljs-built_in">String</span>.fromCharCode(keyCode)),
  <span class="hljs-attr">error</span>: <span class="hljs-function"><span class="hljs-params">error</span> =></span> <span class="hljs-built_in">console</span>.error(error),
  <span class="hljs-attr">complete</span>: <span class="hljs-function"><span class="hljs-params">()</span> =></span> alert(keys.join(<span class="hljs-string">""</span>))
});</code></pre>
<p>Un <code>Observable</code> fonctionne √† la fois pour du code synchrone et asynchrone, et il
s'agit d'un pattern qui peut s'appliquer √† des cas o√π <code>Promise</code> manque de
granularit√©, puisqu'il permet de traiter la donn√©e au fur et √† mesure de son
arriv√©e. <em>In fine</em>, un observable est un <em>event emitter</em> avec un concept de
completion.</p>
<p>Il existe d'ailleurs un <a href="https://tc39.github.io/proposal-observable/"><em>proposal</em> en stage
1</a> pour en faire une API de la
specification de JavaScript. On peut tr√®s bien imaginer que les observables
deviennent une interface tr√®s r√©pandue dans un futur proche.</p>
<p>Dans les prochains articles, nous verrons pourquoi et comment combiner des
observables ainsi que les cas d'usage au sein d'une application React.</p>
]]></description><link>http://putaindecode.io/fr/articles/js/observable/</link><guid isPermaLink="true">http://putaindecode.io/fr/articles/js/observable/</guid><pubDate>Mon, 23 Oct 2017 00:00:00 GMT</pubDate></item><item><title><![CDATA[Podcast 7: React 16, GraphQL, IDLs, RPCs et mauvaise foi sur l'iPhone X]]></title><description><![CDATA[<p>On se retrouve pour un nouvel √©pisode avec un joli programme: on vous y parle de
React 16, de GraphQL, des IDLs et des RPCs. En plus de √ßa, on vous offre une
belle dose de mauvaise foi dans un d√©bat sur l'iPhone X.</p>
<p>Moi, Matthias (<a href="https://twitter.com/bloodyowl">https://twitter.com/bloodyowl</a>), vous pr√©sente ce podcast en
compagnie de mes fid√®les acolytes :</p>
<ul>
<li>Mathieu (<a href="https://twitter.com/Zoontek">https://twitter.com/Zoontek</a>)</li>
<li>Georges (<a href="https://twitter.com/skinnyfoetusboy">https://twitter.com/skinnyfoetusboy</a>)</li>
</ul>
<p>Les petits liens qui vont bien :</p>
<ul>
<li>React 16: <a href="https://reactjs.org/blog/2017/09/26/react-v16.0.html">https://reactjs.org/blog/2017/09/26/react-v16.0.html</a></li>
<li>GraphQL: <a href="http://graphql.org">http://graphql.org</a></li>
<li>Relay: <a href="https://facebook.github.io/relay/">https://facebook.github.io/relay/</a></li>
<li>Apollo: <a href="https://www.apollodata.com">https://www.apollodata.com</a></li>
<li>ProtoBuf: <a href="https://github.com/google/protobuf">https://github.com/google/protobuf</a></li>
<li>Thrift: <a href="https://thrift.apache.org">https://thrift.apache.org</a></li>
<li>gRPC: <a href="https://grpc.io">https://grpc.io</a></li>
<li>iPhone X: <a href="https://www.apple.com/iphone-x/">https://www.apple.com/iphone-x/</a></li>
</ul>
<p>La track du g√©n√©rique: <a href="https://soundcloud.com/matthias-le-brun/arrow">https://soundcloud.com/matthias-le-brun/arrow</a></p>
<iframe width="100%" height="300" scrolling="no" frameborder="no" src="https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/348401054&amp;color=%23ff5500&amp;auto_play=false&amp;hide_related=true&amp;show_comments=true&amp;show_user=true&amp;show_reposts=false&amp;show_teaser=false&amp;visual=true"></iframe>
<ul>
<li>Le
<a href="http://feeds.soundcloud.com/users/soundcloud:users:273901232/sounds.rss">RSS</a></li>
<li>Sur iTunes : <a href="https://itunes.apple.com/fr/podcast/putain-de-code-!/id1185311825?l=en&#x26;mt=2">Putain de
Code</a></li>
</ul>
]]></description><link>http://putaindecode.io/fr/articles/podcast/7/</link><guid isPermaLink="true">http://putaindecode.io/fr/articles/podcast/7/</guid><pubDate>Wed, 18 Oct 2017 00:00:00 GMT</pubDate></item><item><title><![CDATA[Utiliser Reason avec JavaScript]]></title><description><![CDATA[<p>Dans un <a href="/fr/articles/reason/introduction-reason/">pr√©c√©dent article</a>, on vous
pr√©sentait une nouvelle syntaxe pour OCaml:
<a href="https://reasonml.github.io">ReasonML</a>, elle rend le langage plus accessible en
le rapprochant de JavaScript moderne.</p>
<p>√Ä l'aide du projet
<a href="https://bucklescript.github.io/bucklescript/Manual.html">BuckleScript</a> qui
supporte Reason nativement, on peut compiler notre code Reason vers JavaScript
tr√®s facilement. Le cr√©ateur de BuckleScript utilisait √† l'origine un autre
projet appel√© <a href="http://ocsigen.org/js_of_ocaml/">js_of_ocaml</a>. Trouvant qu'il
serait possible d'optimiser et de rendre plus lisible le code JavaScript en
sortie si le compiler commen√ßait son travail √† une √©tape plus haut niveau (une
repr√©sentation du programme contenant des informations suppl√©mentaires, alors
que js_of_ocaml utilise du bytecode), il propose ce changement √† la team
js_of_ocaml qui refuse, et d√©cide donc de se lancer dans le projet qui deviendra
BuckleScript.</p>
<p>Pour d√©marrer un projet avec BuckleScript et Reason, on ouvre son terminal, et
c'est parti:</p>
<p>On installe BuckleScript:</p>
<pre><code class="hljs language-console"><span class="hljs-meta">$</span><span class="bash"> npm install -g bs-platform</span></code></pre>
<p>On initialise le projet:</p>
<pre><code class="hljs language-console"><span class="hljs-meta">$</span><span class="bash"> bsb -init my-app -theme basic-reason</span></code></pre>
<p>Hop, votre projet est pr√™t dans <code>my-app</code>.</p>
<p>Maintenant la question est: comment est-ce que je peux utiliser du JS dans
Reason et vice-versa ?</p>
<h2 id="les-ffi-ou-foreign-function-interface"><a href="#les-ffi-ou-foreign-function-interface" class="phenomic-HeadingAnchor">#</a>Les FFI (ou Foreign Function Interface)</h2>
<p>OCaml g√®re naturellement les <code>FFI</code>, notamment pour appeler des fonctions <code>C</code>
lorsqu'il compile vers du code natif.</p>
<p>BuckleScript vient les overloader pour les adapter √† JavaScript.</p>
<p>Cr√©ons une FFI pour la fonction <code>alert</code> :</p>
<pre><code class="hljs language-reason">[@bs.<span class="hljs-keyword">val</span>] <span class="hljs-keyword">external</span> alert : <span class="hljs-built_in">string</span> => <span class="hljs-built_in">unit</span> = <span class="hljs-string">""</span>;</code></pre>
<p>On d√©finit:</p>
<ul>
<li>une fonction externe nomm√©e <code>alert</code></li>
<li>qui prend une <code>string</code> et ne retourne <em>rien</em> (ici repr√©sent√© par la valeur
<code>unit</code>)</li>
<li>qui est une valeur √† simplement r√©cup√©rer (<code>[@bs.val]</code>)</li>
</ul>
<p>Si on regarde le code JavaScript en sortie, c'est vide. En effet, <code>external</code> est
un moyen de d√©finir comment acc√©der √† une valeur ainsi que son type. Si en
revanche on utilise la function <code>alert</code> dans le module:</p>
<pre><code class="hljs language-reason">[@bs.<span class="hljs-keyword">val</span>] <span class="hljs-keyword">external</span> alert : <span class="hljs-built_in">string</span> => <span class="hljs-built_in">unit</span> = <span class="hljs-string">""</span>;

alert(<span class="hljs-string">"Hello!"</span>);</code></pre>
<p>On voit dans l'output que BuckleScript a <em>inlin√©</em> l'appel de <code>alert</code>, il n'a pas
cr√©e de repr√©sentation interm√©diaire.</p>
<pre><code class="hljs language-javascript"><span class="hljs-comment">// Generated by BUCKLESCRIPT VERSION 1.9.1, PLEASE EDIT WITH CARE</span>
<span class="hljs-meta">"use strict"</span>;

alert(<span class="hljs-string">"Hello!"</span>);

<span class="hljs-comment">/*  Not a pure module */</span></code></pre>
<p>Maintenant amusons nous √† cr√©er des bindings pour jQuery, juste pour le fun:</p>
<pre><code class="hljs language-reason">/* <span class="hljs-type">On</span> cr√©e un <span class="hljs-keyword">type</span> opaque pour repr√©senter un objet jQuery */
<span class="hljs-keyword">type</span> jQuery;

/* <span class="hljs-type">On</span> <span class="hljs-keyword">type</span> le <span class="hljs-keyword">module</span> jQuery */
[@bs.<span class="hljs-keyword">module</span>] <span class="hljs-keyword">external</span> jQuery : <span class="hljs-built_in">string</span> => jQuery = <span class="hljs-string">"jquery"</span>;

/* <span class="hljs-type">On</span> <span class="hljs-keyword">type</span> la m√©thod `on`, <span class="hljs-type">BuckleScript</span> peut naturellement typer
  le pattern de chaining, assez commun en <span class="hljs-type">JS</span>, √† l'aide de l'annotation
  `bs.send.pipe: <span class="hljs-keyword">type</span>` */
[@bs.send.pipe: jQuery] <span class="hljs-keyword">external</span> on : <span class="hljs-built_in">string</span> => (<span class="hljs-type">Dom</span>.event => <span class="hljs-built_in">unit</span>) => jQuery = <span class="hljs-string">""</span>;

jQuery(<span class="hljs-string">".selector"</span>)
  |> on(<span class="hljs-string">"click"</span>, (_) => alert(<span class="hljs-string">"hey"</span>));</code></pre>
<p>Ce qui va nous sortir:</p>
<pre><code class="hljs language-javascript"><span class="hljs-comment">// Generated by BUCKLESCRIPT VERSION 1.9.1, PLEASE EDIT WITH CARE</span>
<span class="hljs-meta">"use strict"</span>;

<span class="hljs-keyword">var</span> JQuery = <span class="hljs-built_in">require</span>(<span class="hljs-string">"jquery"</span>);

JQuery(<span class="hljs-string">".selector"</span>).on(<span class="hljs-string">"click"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  alert(<span class="hljs-string">"hey"</span>);
  <span class="hljs-keyword">return</span> <span class="hljs-comment">/* () */</span> <span class="hljs-number">0</span>;
});

<span class="hljs-comment">/*  Not a pure module */</span></code></pre>
<p>Comme on peut le constater, le code de sortie ressemble beaucoup √† ce qu'on
pourrait √©crire √† la main.</p>
<p>Pour en savoir un peu plus sur les FFI JavaScript:</p>
<ul>
<li><a href="https://bucklescript.github.io/bucklescript/Manual.html">La documentation de
BuckleScript</a></li>
<li><a href="https://github.com/reasonml-community">Les projets de bindings cr√©es par la
communaut√©</a> (ceux nomm√©s
<code>bs-{nom-de-lib-js}</code>)</li>
</ul>
<h2 id="les-objets"><a href="#les-objets" class="phenomic-HeadingAnchor">#</a>Les objets</h2>
<p>On peut directement utiliser des objets JavaScript en Reason. Pour acc√©der √† une
propri√©t√©, on utilise <code>##</code>.</p>
<pre><code class="hljs language-reason"><span class="hljs-meta">myJsObject#</span><span class="bash"><span class="hljs-comment">#property</span></span></code></pre>
<p>√áa d√©panne, mais au sein de notre code Reason, on pr√©f√©rera bien souvent
utiliser des records: ils ont une repr√©sentation plus l√©g√®re et sont par d√©faut
immutables. Pour effectuer une conversion, on proc√®de de la mani√®re suivante:</p>
<pre><code class="hljs language-reason"><span class="hljs-keyword">type</span> jsUser = {
  .
  <span class="hljs-string">"id"</span>: <span class="hljs-built_in">string</span>,
  <span class="hljs-string">"username"</span>: <span class="hljs-built_in">string</span>,
  <span class="hljs-comment">/* valeur pouvant √™tre null, undefined, ou la valeur */</span>
  <span class="hljs-string">"birthdate"</span>: Js.Null_undefined.t(<span class="hljs-built_in">string</span>),
  <span class="hljs-comment">/* "light" ou "dark", les enums sont souvent repr√©sent√©s par des strings en JS */</span>
  <span class="hljs-string">"theme"</span>: <span class="hljs-built_in">string</span>
};

<span class="hljs-comment">/* En Reason, les enums sont repr√©sent√©s par des variants */</span>
<span class="hljs-keyword">type</span> theme =
  | Light
  | Dark;

<span class="hljs-keyword">type</span> user = {
  id: <span class="hljs-built_in">string</span>,
  username: <span class="hljs-built_in">string</span>,
  <span class="hljs-comment">/* pas de null ou undefined, on utilise un type option */</span>
  birthdate: option(<span class="hljs-built_in">string</span>),
  theme
};

<span class="hljs-comment">/* une fonction de transformation JS -> Reason */</span>
<span class="hljs-keyword">let</span> fromJs = <span class="hljs-function">(<span class="hljs-params">jsUser</span>) =></span> {
  id: jsUser##id,
  username: jsUser##username,
  <span class="hljs-comment">/* BuckleScript propose des helpers pour les conversions */</span>
  birthdate: Js.Null_undefined.to_opt(jsUser##birthdate),
  theme:
    <span class="hljs-keyword">switch</span> jsUser##theme {
    | <span class="hljs-string">"dark"</span> => Dark
    | <span class="hljs-string">"light"</span>
    <span class="hljs-comment">/* On match une cha√Æne de caract√®re, le match n'est pas exhaustif,
         on doit donc d√©finir la valeur de fallback (par defaut) √† l'aide
         de `_`
       */</span>
    | _ => Light
    }
};

<span class="hljs-comment">/* Pour cr√©er un objet JS en Reason, il suffit de l'√©crire comme un
     record, mais avec des cl√©s entre quotes, comme du JSON.
   */</span>
<span class="hljs-keyword">let</span> toJs = <span class="hljs-function">(<span class="hljs-params">user</span>) =></span> {
  <span class="hljs-string">"id"</span>: user.id,
  <span class="hljs-string">"username"</span>: user.username,
  <span class="hljs-string">"birthdate"</span>: Js.Null_undefined.from_opt(user.birthdate),
  <span class="hljs-string">"theme"</span>:
    <span class="hljs-keyword">switch</span> user.theme {
    | <span class="hljs-function"><span class="hljs-params">Light</span> =></span> <span class="hljs-string">"light"</span>
    | <span class="hljs-function"><span class="hljs-params">Dark</span> =></span> <span class="hljs-string">"dark"</span>
    }
};</code></pre>
<p>Le code en sortie:</p>
<pre><code class="hljs language-javascript"><span class="hljs-comment">// Generated by BUCKLESCRIPT VERSION 1.9.1, PLEASE EDIT WITH CARE</span>
<span class="hljs-meta">"use strict"</span>;

<span class="hljs-keyword">var</span> Js_primitive = <span class="hljs-built_in">require</span>(<span class="hljs-string">"bs-platform/lib/js/js_primitive.js"</span>);
<span class="hljs-keyword">var</span> Js_null_undefined = <span class="hljs-built_in">require</span>(<span class="hljs-string">"bs-platform/lib/js/js_null_undefined.js"</span>);

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fromJs</span>(<span class="hljs-params">jsUser</span>) </span>{
  <span class="hljs-keyword">var</span> match = jsUser.theme;
  <span class="hljs-keyword">var</span> tmp;
  <span class="hljs-keyword">switch</span> (match) {
    <span class="hljs-keyword">case</span> <span class="hljs-string">"dark"</span>:
      tmp = <span class="hljs-comment">/* Dark */</span> <span class="hljs-number">1</span>;
      <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> <span class="hljs-string">"light"</span>:
      tmp = <span class="hljs-comment">/* Light */</span> <span class="hljs-number">0</span>;
      <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">default</span>:
      tmp = <span class="hljs-comment">/* Light */</span> <span class="hljs-number">0</span>;
  }
  <span class="hljs-keyword">return</span> <span class="hljs-comment">/* record */</span> [
    <span class="hljs-comment">/* id */</span> jsUser.id,
    <span class="hljs-comment">/* username */</span> jsUser.username,
    <span class="hljs-comment">/* birthdate */</span> Js_primitive.null_undefined_to_opt(jsUser.birthdate),
    <span class="hljs-comment">/* theme */</span> tmp
  ];
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">toJs</span>(<span class="hljs-params">user</span>) </span>{
  <span class="hljs-keyword">var</span> match = user[<span class="hljs-comment">/* theme */</span> <span class="hljs-number">3</span>];
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">id</span>: user[<span class="hljs-comment">/* id */</span> <span class="hljs-number">0</span>],
    <span class="hljs-attr">username</span>: user[<span class="hljs-comment">/* username */</span> <span class="hljs-number">1</span>],
    <span class="hljs-attr">birthdate</span>: Js_null_undefined.from_opt(user[<span class="hljs-comment">/* birthdate */</span> <span class="hljs-number">2</span>]),
    <span class="hljs-attr">theme</span>: match !== <span class="hljs-number">0</span> ? <span class="hljs-string">"dark"</span> : <span class="hljs-string">"light"</span>
  };
}

exports.fromJs = fromJs;
exports.toJs = toJs;
<span class="hljs-comment">/* No side effect */</span></code></pre>
<h2 id="les-standard-libs"><a href="#les-standard-libs" class="phenomic-HeadingAnchor">#</a>Les standard-libs</h2>
<p>Si le besoin s'en fait sentir, BuckleScript propose naturellement la stdlib de
JavaScript.</p>
<pre><code class="hljs language-reason"><span class="hljs-keyword">let</span> myArray = [|<span class="hljs-type">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>|<span class="hljs-type">];

myArray</span>
  |<span class="hljs-type">> Js</span>.Array.map((item) => item * <span class="hljs-number">2</span>)
  |<span class="hljs-type">> Js</span>.Array.reduce((acc, item) => acc + item, <span class="hljs-number">0</span>);</code></pre>
<p>vous sortira:</p>
<pre><code class="hljs language-javascript"><span class="hljs-comment">// Generated by BUCKLESCRIPT VERSION 1.9.1, PLEASE EDIT WITH CARE</span>
<span class="hljs-meta">"use strict"</span>;

<span class="hljs-keyword">var</span> myArray = <span class="hljs-comment">/* array */</span> [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>];

myArray
  .map(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">item</span>) </span>{
    <span class="hljs-keyword">return</span> item &#x3C;&#x3C; <span class="hljs-number">1</span>;
  })
  .reduce(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">acc, item</span>) </span>{
    <span class="hljs-keyword">return</span> (acc + item) | <span class="hljs-number">0</span>;
  }, <span class="hljs-number">0</span>);

exports.myArray = myArray;
<span class="hljs-comment">/*  Not a pure module */</span></code></pre>
<h2 id="la-technique-bourrin"><a href="#la-technique-bourrin" class="phenomic-HeadingAnchor">#</a>La technique bourrin</h2>
<p>Pour les cas extr√™mes ou vous voulez juste balancer une fonction JS, vous
pouvez:</p>
<pre><code class="hljs language-reason"><span class="hljs-comment">/* %bs.raw pour une expression, %%bs.raw pour un bloc de code arbitraire */</span>
<span class="hljs-keyword">let</span> log: <span class="hljs-function"><span class="hljs-params">string</span> =></span> unit = [%bs.raw {|
  <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">a</span>) </span>{
    <span class="hljs-built_in">console</span>.log(a);
  }
|}];

log(<span class="hljs-string">"ok"</span>);</code></pre>
<p>qui vous sort un joli:</p>
<pre><code class="hljs language-javascript"><span class="hljs-comment">// Generated by BUCKLESCRIPT VERSION 1.9.1, PLEASE EDIT WITH CARE</span>
<span class="hljs-meta">"use strict"</span>;

<span class="hljs-keyword">var</span> Curry = <span class="hljs-built_in">require</span>(<span class="hljs-string">"bs-platform/lib/js/curry.js"</span>);

<span class="hljs-keyword">var</span> log = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) </span>{
  <span class="hljs-built_in">console</span>.log(a);
};

Curry._1(log, <span class="hljs-string">"ok"</span>);

exports.log = log;
<span class="hljs-comment">/* log Not a pure module */</span></code></pre>
<h2 id="conclusion"><a href="#conclusion" class="phenomic-HeadingAnchor">#</a>Conclusion</h2>
<p>OCaml peut en grande majorit√© √™tre compil√© en JavaScript tr√®s simple, parce
qu'il partage beaucoup de concepts avec ce dernier. Il est assez simple de cr√©er
des ponts entre les deux langages √† l'aide des FFI. L'√©norme avantage de cette
feature, c'est que l'on peut commencer √† utiliser Reason incr√©mentalement sur
son projet sans avoir √† tout r√©√©crire d'un coup.</p>
<p>Bisous bisous.</p>
]]></description><link>http://putaindecode.io/fr/articles/reason/interop/</link><guid isPermaLink="true">http://putaindecode.io/fr/articles/reason/interop/</guid><pubDate>Tue, 10 Oct 2017 00:00:00 GMT</pubDate></item><item><title><![CDATA[Introduction √† ReasonML (ou pourquoi j'ai arr√™t√© d'utiliser JavaScript)]]></title><description><![CDATA[<p>Les bugs c'est chiant, surtout quand on sait qu'on aurait pu les √©viter. Avec
JavaScript, c'est plus facile d'en avoir que de les √©viter.</p>
<p>JavaScript, on ne peut pas y √©chapper parce que c'est partout, parce que c'est
le langage de programmation le plus utilis√© sur Terre, et parce que c'est le
seul truc qui (pour l'instant) tourne nativement dans le navigateur. Et puis
c'est pas si mal, c'est facile de l'apprendre en bidouillant un peu, c'est tr√®s
permissif et pas trop frustrant pour d√©buter.</p>
<p>Le probl√®me c'est que c'est facile d'en faire, mais c'est tr√®s dur d'en faire
<strong>bien</strong> (moins que CSS, mais quand m√™me). On s'est tous d√©j√† retrouv√© avec
<code>undefined is not a function</code>, <code>null is not an object</code> ou un bon gros <code>[object Object]</code> qui tra√Æne dans la console.</p>
<h2 id="pourquoi-est-ce-que-cest-comme-√ßa-"><a href="#pourquoi-est-ce-que-cest-comme-%C3%A7a-" class="phenomic-HeadingAnchor">#</a>Pourquoi est-ce que c'est comme √ßa ?</h2>
<p>JavaScript est un langage dynamiquement et faiblement typ√©, ce qui veut dire :</p>
<ul>
<li>qu'une fonction ne sait pas ce qu'elle prend ou retourne comme type
d'arguments, c'est √† vous de g√©rer</li>
<li>que le programme n'en a aucune id√©e non plus tant qu'il n'execute pas la
portion de code</li>
</ul>
<p>Tout √ßa fait qu'il est tr√®s difficile de faire confiance √† du code JavaScript.</p>
<figure>
<img src="./js.png" alt="js" />
<figcaption>Source: MIT</figcaption>
</figure>
<p>Il existe Flow et TypeScript (dont on a parl√© dans un <a href="/fr/articles/js/flow/">pr√©c√©dent
article</a> et un <a href="fr/articles/podcast/3/">podcast</a>), deux
projets qui permettent d'apporter du typage statique pour s√©curiser son code.
Ils contraignent votre usage de JavaScript, mais devront toujours se battre
contre sa permissivit√©.</p>
<p>√áa revient au final √† coller des rustines sur vos pneus avant d'aller rouler sur
des clous, √ßa va vous prot√©ger un peu, mais √ßa reste de base pas bien malin
d'aller rouler sur des clous.</p>
<p>Il existe des langages qui ont la judicieuse id√©e de balayer la route pour virer
les clous avant d'y aller : les langages typ√©s fortement et statiquement (10
points pour Gryffondor pour cette m√©taphore fil√©e).</p>
<p>OCaml est un de ces langages. Il est de la famille ML et a √©t√© cr√©√© en France
dans les ann√©es 90. Il est √† peu pr√®s aussi √¢g√© que JavaScript mais est beaucoup
plus sage. Il est certes fortement et statiquement typ√©, mais il inf√®re la
plupart des types du programme (ce qui veut dire que vous n'avez pas √†
renseigner les types partout, il va l'extrapoler d√®s qu'il le peut). En bonus,
il poss√®de de <a href="https://ocaml.org/learn/tutorials/comparison_of_standard_containers.html">bonnes
data-structures</a>.</p>
<p>Seulement voil√†, OCaml, comme beaucoup de langages fonctionnels n'a pas vraiment
mis l'accent sur l'accessibilit√© pour les d√©butants, et a une syntaxe qu'on peut
pour le moins qualifier de pas tr√®s friendly: elle n'a rien de bien mal, mais
mettez quelqu'un qui vient de JS/PHP/Java devant, √ßa va pas lui causer des
masses:</p>
<pre><code class="hljs language-ocaml"><span class="hljs-keyword">let</span> <span class="hljs-keyword">rec</span> qsort = <span class="hljs-keyword">fun</span> <span class="hljs-keyword">value</span> ->
  <span class="hljs-keyword">match</span> <span class="hljs-keyword">value</span> <span class="hljs-keyword">with</span>
   | <span class="hljs-literal">[]</span> -> <span class="hljs-literal">[]</span>
   | pivot :: rest ->
       <span class="hljs-keyword">let</span> is_less x = x &#x3C; pivot <span class="hljs-keyword">in</span>
       <span class="hljs-keyword">let</span> left, right = <span class="hljs-type">List</span>.partition is_less rest <span class="hljs-keyword">in</span>
       qsort left @ [pivot] @ qsort right;;</code></pre>
<figure>
<img src="./giphy.gif" alt="" />
<figcaption>fig. 1: dev JS devant du code OCaml</figcaption>
</figure>
<p>C'est l√† qu'intervient Reason, un projet initi√© par <a href="https://twitter.com/jordwalke">le cr√©ateur de
React</a>. Les premi√®res it√©rations de React √©taient
d'ailleurs cod√©es dans un langage cousin de OCaml, le SML.</p>
<p>C'est en gros:</p>
<ul>
<li>OCaml</li>
<li>avec une syntaxe <em>beginner-friendly</em></li>
<li>avec un tooling le rendant plus simple √† utiliser</li>
<li>qui peut compiler vers JavaScript et de multiples plateformes</li>
</ul>
<p>Avec son type system, OCaml propose un langage <em>safe-by-design</em>, chose que m√™me
avec une palanqu√©e d'outils, on ne peut pas atteindre avec JavaScript.</p>
<p>Le langage propose par d√©faut une approche fonctionnelle et immutable, mais
permet cependant de choisir d'utiliser des structures mutables et de l'orient√©
objet au besoin.</p>
<h2 id="le-langage"><a href="#le-langage" class="phenomic-HeadingAnchor">#</a>Le langage</h2>
<p>Reason comporte plus de types de primitifs que JavaScript:</p>
<pre><code class="hljs language-reason"><span class="hljs-comment">/* pas un gros "number" fourre tout, magique */</span>
<span class="hljs-number">1</span>; <span class="hljs-comment">/* int */</span>
<span class="hljs-number">1.0</span>; <span class="hljs-comment">/* float */</span>
<span class="hljs-comment">/* un caract√®re est d'un type diff√©rent de string */</span>
<span class="hljs-string">"foo"</span>; <span class="hljs-comment">/* string */</span>
'a'; <span class="hljs-comment">/* char */</span>
<span class="hljs-comment">/* on trouve list ET array, chacun peut √™tre utilis√© pour diff√©rents cas */</span>
[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]; <span class="hljs-comment">/* list */</span>
[| <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span> |]; <span class="hljs-comment">/* array */</span>
<span class="hljs-comment">/* pas de null, mais des valeurs de type `option` qui contiennent
  soit une valeur, soit rien */</span>
Some(<span class="hljs-number">1</span>); <span class="hljs-comment">/* option int */</span>
None; <span class="hljs-comment">/* option int */</span></code></pre>
<p>Puisqu'il est fortement typ√©, il est impossible de mixer les types comme en
JavaScript, vous devrez obligatoirement les convertir:</p>
<pre><code class="hljs language-reason"><span class="hljs-number">1</span> + <span class="hljs-number">1.0</span>;
<span class="hljs-comment">/* Error:
  This expression has type int but an expression was expected of type float */</span>
<span class="hljs-number">1</span> + int_of_float(<span class="hljs-number">1.0</span>);
<span class="hljs-comment">/* - : int = 2 */</span></code></pre>
<p>La plupart des op√©rations de transformations de type primitifs vers un autre
sont accessibles dans le module <code>Pervasives</code> qui contient plein de petits
utilitaires bien pratiques. Toutes les fonctions de ce module sont accessibles
directement dans n'importe quel de vos fichiers.</p>
<p>Les fonctions de Reason sont beaucoup plus puissantes qu'en JavaScript:</p>
<pre><code class="hljs language-reason">let <span class="hljs-keyword">add </span>= (a, <span class="hljs-keyword">b) </span>=> a + <span class="hljs-keyword">b;
</span><span class="hljs-comment">/* int => int => int */</span>
<span class="hljs-keyword">add(1, </span><span class="hljs-number">2</span>)<span class="hljs-comment">;</span>
<span class="hljs-comment">/* 3 */</span>
<span class="hljs-keyword">add(1, </span><span class="hljs-number">2</span>.<span class="hljs-number">0</span>)<span class="hljs-comment">;</span>
<span class="hljs-comment">/* This expression has type float but an expression was expected of type int */</span>

<span class="hljs-comment">/* Les fonctions sont "auto-curried", ce qui signifie qu'une fonction
   qui n'a pas re√ßu tous ses param√®tres retourne une nouvelle fonction
  qui va recevoir les param√®tres manquants */</span>
let <span class="hljs-keyword">addOne </span>= <span class="hljs-keyword">add(1);
</span><span class="hljs-comment">/* int => int */</span>

<span class="hljs-comment">/* Les fonctions peuvent avoir des param√®tres nomm√©s, optionnels et avec des valeurs par d√©faut */</span>
let sayHi = (~name, ~punct=<span class="hljs-string">"!"</span>, ()) => <span class="hljs-string">"Hello "</span> ++ name ++ punct<span class="hljs-comment">;</span>
<span class="hljs-comment">/* name::string => string */</span>
sayHi(~name=<span class="hljs-string">"you"</span>, ())<span class="hljs-comment">;</span>
<span class="hljs-comment">/* "Hello you!" */</span>
<span class="hljs-comment">/* L'ordre des arguments nomm√©s n'a pas d'importance*/</span>
sayHi(~punct,<span class="hljs-string">"?"</span>, ~name=<span class="hljs-string">"you"</span>, ())<span class="hljs-comment">;</span>
<span class="hljs-comment">/* "Hello you?" */</span></code></pre>
<p>Pour d√©finir l'√©quivalent d'un <em>plain-object</em> JavaScript en Reason, on utilise
des records:</p>
<pre><code class="hljs language-reason">/* On doit typer les records */
<span class="hljs-keyword">type</span> <span class="hljs-keyword">user</span> <span class="hljs-title">= {
  username</span>: <span class="hljs-keyword">string</span>,
  age: int
};

/* Les records ont un nombre de cl√©s fini, vous <span class="hljs-keyword">ne</span> pouvez pas en
  ommettre une ou en mettre une en trop */
let <span class="hljs-keyword">user</span> <span class="hljs-title">= { username</span>: <span class="hljs-string">"Bob"</span> };
/* Error: Some record fields are undefined: age */

let <span class="hljs-keyword">user</span> <span class="hljs-title">= { username</span>: <span class="hljs-string">"Bob"</span>, age: <span class="hljs-number">20</span> };

/* Les records sont immutables par d√©faut */
let olderUser = {...user, age: user.age + <span class="hljs-number">1</span> };</code></pre>
<p>Reason poss√®de un syst√®me de module tr√®s puissant: par d√©faut, chaque fichier de
votre codebase est un module, mais vous pouvez √©galement d√©clarer des modules
<em>dans</em> un module.</p>
<pre><code class="hljs language-reason"><span class="hljs-keyword">module</span> User = {
  <span class="hljs-keyword">type</span> t = {
    id: <span class="hljs-built_in">string</span>,
    username: <span class="hljs-built_in">string</span>,
    email: option(<span class="hljs-built_in">string</span>)
  };
  <span class="hljs-keyword">let</span> make = <span class="hljs-function">(<span class="hljs-params">~id, ~username, ~email</span>) =></span> {id, username, email};
  <span class="hljs-keyword">let</span> sayHi = <span class="hljs-function">(<span class="hljs-params">user</span>) =></span> <span class="hljs-string">"Hello "</span> ++ user.username ++ <span class="hljs-string">"!"</span>;
};

<span class="hljs-comment">/* Pour utiliser un module, tapez son nom, tout simplement */</span>
User.make(~id=<span class="hljs-string">"0"</span>, ~username=<span class="hljs-string">"bloodyowl"</span>, ~email=None)
  <span class="hljs-comment">/* (ah oui, le pipe existe d√©j√† ici, pas besoin d'attendre ES2050)*/</span>
  |> User.sayHi
  |> print_endline;
<span class="hljs-comment">/* "Hello bloodyowl" */</span>

<span class="hljs-comment">/* On peut √©galement rendre toutes les valeurs d'un module accessibles localement */</span>
User.(
  make(~id=<span class="hljs-string">"0"</span>, ~username=<span class="hljs-string">"bloodyowl"</span>, ~email=None)
    |> sayHi
    |> print_endline
);

<span class="hljs-comment">/* Carr√©ment les rendre accessibles globalement dans le module */</span>
open User;

make(~id=<span class="hljs-string">"0"</span>, ~username=<span class="hljs-string">"bloodyowl"</span>, ~email=None)
  |> sayHi
  |> print_endline;

<span class="hljs-comment">/* Ou m√™me √©tendre un module statiquement et proprement,
  √ßa vous parle √ßa, Prototype et MooTools ?! */</span>
<span class="hljs-keyword">module</span> UserThatCanSayBye = {
  include User;
  <span class="hljs-keyword">let</span> sayBye = <span class="hljs-function">(<span class="hljs-params">user</span>) =></span> <span class="hljs-string">"Bye "</span> ++ user.username ++ <span class="hljs-string">"!"</span>;
};</code></pre>
<p>Il existe √©galement des functors, qui sont des sortes de fonctions retournant
des modules √† partir d'autres modules, mais on ne l'abordera pas dans cet
article.</p>
<p>Reason poss√®de √©galement des variants, il s'agit de types pouvant avoir
diff√©rents cas. Prenons l'exemple d'un message de chat:</p>
<pre><code class="hljs language-reason">type <span class="hljs-built_in">image</span> = {url: <span class="hljs-keyword">string</span>, <span class="hljs-built_in">width</span>: <span class="hljs-keyword">int</span>, <span class="hljs-built_in">height</span>: <span class="hljs-keyword">int</span>};

<span class="hljs-comment">/* chaque cas du variant peut prendre des param√®tres */</span>
type message =
  | <span class="hljs-keyword">String</span>(<span class="hljs-keyword">string</span>) <span class="hljs-comment">/* soit une cha√Æne de caract√®res */</span>
  | Image(<span class="hljs-built_in">image</span>) <span class="hljs-comment">/* soit une image */</span>
  | Emoji(<span class="hljs-keyword">string</span>); <span class="hljs-comment">/* soit un gros emoji */</span>

let stringMessage = <span class="hljs-keyword">String</span>(<span class="hljs-string">"Hello"</span>); <span class="hljs-comment">/* On cr√©e la valeur avec son constructeur */</span>
let imageMessage = Image({url: <span class="hljs-string">"https://fakeimg.pl/300x300"</span>, <span class="hljs-built_in">width</span>: <span class="hljs-number">300</span>, <span class="hljs-built_in">height</span>: <span class="hljs-number">300</span>});
let emojiMessage = Emoji({js|üê´|js}); <span class="hljs-comment">/* Quand la string contient de caract√®res unicode,
  on doit utiliser {js|votre string|js} */</span></code></pre>
<p>Ici, notre type <code>message</code> est bien d√©limit√©, et ses valeurs ne peuvent √™tre que
celles que l'on a d√©fini.</p>
<p>Pour utiliser les valeurs d'un variant, on peut les extraire √† l'aide de
<code>switch</code>, qui va <em>pattern-matcher</em> pour nous permettre d'identifier et
d'extraire les valeurs.</p>
<pre><code class="hljs language-reason"><span class="hljs-comment">/* Petit bonus, l'exemple utilise ReasonReact, mais on d√©taillera √ßa dans un prochain article */</span>
<span class="hljs-keyword">let</span> component = ReasonReact.statelessComponent(<span class="hljs-string">"ChatMessage"</span>);

<span class="hljs-keyword">let</span> make = <span class="hljs-function">(<span class="hljs-params">~message, _children</span>) =></span> {
  ...component,
  <span class="hljs-attr">render</span>: <span class="hljs-function">(<span class="hljs-params">_</span>) =></span>
    &#x3C;div>
      (<span class="hljs-keyword">switch</span> message {
        | <span class="hljs-built_in">String</span>(value) => ReasonReact.stringToElement(value)
        | Image({<span class="hljs-attr">url</span>: src, width, height}) => <span class="xml"><span class="hljs-tag">&#x3C;<span class="hljs-name">img</span> <span class="hljs-attr">width</span> <span class="hljs-attr">height</span> <span class="hljs-attr">src</span> /></span>
        /* Si par m√©garde j'oublie un cas possible dans un switch, je vais avoir un joli warning du
          compiler qui me dira:
            This pattern-matching is not exhaustive.
            Here is an example of a value that is not matched:
              Emoji
        */
        | Emoji(value) =>
          </span>&#x3C;div style=(ReactDOMRe.Style.make(~fontSize="40px", ()))>
            (ReasonReact.stringToElement(value))
          &#x3C;/div><span class="xml">
      })
    <span class="hljs-tag">&#x3C;/<span class="hljs-name">div</span>></span></span>
};</code></pre>
<p>En Reason, les <em>let bindings</em> ont automatiquement le block parent comme scope,
on peut du coup √©crire des choses comme ceci :</p>
<pre><code class="hljs language-reason"><span class="hljs-keyword">let</span> <span class="hljs-attr">value</span> = {
  <span class="hljs-keyword">let</span> <span class="hljs-attr">a</span> = <span class="hljs-number">1</span>;
  <span class="hljs-keyword">let</span> <span class="hljs-attr">b</span> = <span class="hljs-number">2</span>;
  a + b; <span class="hljs-comment">/* la derni√®re expression est toujours retourn√©e par d√©faut */</span>
};
<span class="hljs-comment">/* let value : int = 3 */</span>
a
<span class="hljs-comment">/* Error: Unbound value a */</span></code></pre>
<p>Voil√† pour l'introduction √† ReasonML, pour en d√©couvrir un peu plus je vous
invite √† aller lire la <a href="https://reasonml.github.io/">documentation officielle</a>.
On verra dans les prochains articles comment fonctionne
<a href="https://reasonml.github.io/reason-react">ReasonReact</a> (les bindings Reason vers
React, avec quelques petites features sympathiques en plus), et comment
l'adopter incr√©mentalement dans sa codebase pour avoir du code plus s√ªr, et
<em>(spoilers)</em>, plus rapide que si vous l'√©criviez √† la main.</p>
<p>Bisous bisous.</p>
]]></description><link>http://putaindecode.io/fr/articles/reason/introduction-reason/</link><guid isPermaLink="true">http://putaindecode.io/fr/articles/reason/introduction-reason/</guid><pubDate>Mon, 02 Oct 2017 00:00:00 GMT</pubDate></item><item><title><![CDATA[Podcast 6: L'air chaud]]></title><description><![CDATA[<p>Un √©pisode en petit comit√©:</p>
<ul>
<li>Zoontek (<a href="https://twitter.com/Zoontek">https://twitter.com/Zoontek</a>)</li>
<li>Matthias (<a href="https://twitter.com/bloodyowl">https://twitter.com/bloodyowl</a>)</li>
</ul>
<p>On vous parle de ReasonML, une nouvelle syntaxe et tooling pour rendre OCaml
plus accessible, et on s'attarde un peu sur ce dernier, ainsi que sur
l'√©cosyst√®me permettant √† Reason d'√™tre utilis√© avec JavaScript.</p>
<p>On vous pr√©sente √©galement de mani√®re d√©taill√©e ReactNative, le framework qui
permet de cr√©er des applications natives avec React en JavaScript.</p>
<p>Les quelques liens (si peu):</p>
<ul>
<li>Reason <a href="https://facebook.github.io/reason/">https://facebook.github.io/reason/</a></li>
<li>OCaml <a href="https://ocaml.org">https://ocaml.org</a></li>
<li>Les containers OCaml
<a href="https://ocaml.org/learn/tutorials/comparison_of_standard_containers.html">https://ocaml.org/learn/tutorials/comparison_of_standard_containers.html</a></li>
<li>js_of_ocaml <a href="http://ocsigen.org/js_of_ocaml/">http://ocsigen.org/js_of_ocaml/</a></li>
<li>BuckleScript <a href="http://bucklescript.github.io/bucklescript/Manual.html">http://bucklescript.github.io/bucklescript/Manual.html</a></li>
<li>BuckleScript Reason (online demo)
<a href="http://bucklescript.github.io/bucklescript/reason-demo/">http://bucklescript.github.io/bucklescript/reason-demo/</a></li>
<li>BuckleScript benchmark <a href="https://github.com/neonsquare/bucklescript-benchmark">https://github.com/neonsquare/bucklescript-benchmark</a></li>
<li>ReasonReact <a href="https://reasonml.github.io/reason-react/">https://reasonml.github.io/reason-react/</a></li>
<li>ReReactPrimitives (petit travail perso qui peut aider √† aborder la syntaxe)
<a href="https://github.com/bloodyowl/reReactPrimitives">https://github.com/bloodyowl/reReactPrimitives</a></li>
<li>BuckleScript TEA <a href="https://github.com/OvermindDL1/bucklescript-tea">https://github.com/OvermindDL1/bucklescript-tea</a></li>
<li>Discord ReasonML <a href="https://discord.gg/reasonml">https://discord.gg/reasonml</a></li>
<li>ReactNative <a href="https://facebook.github.io/react-native/">https://facebook.github.io/react-native/</a></li>
<li>ReactNative Changelog <a href="https://github.com/facebook/react-native/releases">https://github.com/facebook/react-native/releases</a></li>
<li>MetroBundler <a href="https://github.com/facebook/metro-bundler">https://github.com/facebook/metro-bundler</a></li>
<li>Create React Native App
<a href="https://facebook.github.io/react-native/blog/2017/03/13/introducing-create-react-native-app.html">https://facebook.github.io/react-native/blog/2017/03/13/introducing-create-react-native-app.html</a></li>
<li>Expo <a href="https://expo.io">https://expo.io</a></li>
<li>Qui utilise ReactNative ?
<a href="https://facebook.github.io/react-native/showcase.html">https://facebook.github.io/react-native/showcase.html</a></li>
<li>Animated <a href="https://github.com/animatedjs/animated">https://github.com/animatedjs/animated</a></li>
<li>ReactNativeWeb <a href="https://github.com/necolas/react-native-web/">https://github.com/necolas/react-native-web/</a></li>
<li>ReactPrimitives <a href="https://github.com/lelandrichardson/react-primitives">https://github.com/lelandrichardson/react-primitives</a></li>
<li>NativeModules
<a href="https://facebook.github.io/react-native/docs/native-modules-ios.html">https://facebook.github.io/react-native/docs/native-modules-ios.html</a></li>
<li>React Navigation <a href="https://github.com/react-community/react-navigation">https://github.com/react-community/react-navigation</a></li>
<li>React Native Maps airbnb/react-native-maps</li>
<li>Lottie React Native <a href="https://github.com/airbnb/lottie-react-native">https://github.com/airbnb/lottie-react-native</a></li>
<li>React Native Vector Icons <a href="https://github.com/oblador/react-native-vector-icons">https://github.com/oblador/react-native-vector-icons</a></li>
<li>React Native Animatable <a href="https://github.com/oblador/react-native-animatable">https://github.com/oblador/react-native-animatable</a></li>
<li>BuckleScript React Native <a href="https://github.com/BuckleTypes/bs-react-native">https://github.com/BuckleTypes/bs-react-native</a></li>
</ul>
<p>La track du g√©n√©rique:</p>
<p><a href="https://soundcloud.com/matthias-le-brun/moon">https://soundcloud.com/matthias-le-brun/moon</a></p>
<iframe width="100%" height="450" scrolling="no" frameborder="no" src="https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/329979777&amp;auto_play=false&amp;hide_related=false&amp;show_comments=true&amp;show_user=true&amp;show_reposts=false&amp;visual=true"></iframe>
<ul>
<li>Le
<a href="http://feeds.soundcloud.com/users/soundcloud:users:273901232/sounds.rss">RSS</a></li>
<li>Sur iTunes : <a href="https://itunes.apple.com/fr/podcast/putain-de-code-!/id1185311825?l=en&#x26;mt=2">Putain de
Code</a></li>
</ul>
]]></description><link>http://putaindecode.io/fr/articles/podcast/6/</link><guid isPermaLink="true">http://putaindecode.io/fr/articles/podcast/6/</guid><pubDate>Tue, 27 Jun 2017 00:00:00 GMT</pubDate></item><item><title><![CDATA[Podcast 5: On va tous crever !]]></title><description><![CDATA[<p>Tr√®s certainement notre pire √©pisode, en tout cas le plus p√©nible √† monter.</p>
<p>Sont pr√©sents mentalement dans la pi√®ce dans laquelle s'est d√©roul√©
l'enregistrement :</p>
<ul>
<li>Georges (<a href="https://twitter.com/skinnyfoetusboy">https://twitter.com/skinnyfoetusboy</a>)</li>
<li>Mathieu (<a href="https://twitter.com/Zoontek">https://twitter.com/Zoontek</a>)</li>
<li>Matthias (<a href="https://twitter.com/bloodyowl">https://twitter.com/bloodyowl</a>)</li>
</ul>
<p>Est pr√©sent physiquement:</p>
<ul>
<li>Maxime Thirouin ouin ouin (<a href="https://twitter.com/MoOx">https://twitter.com/MoOx</a>)</li>
</ul>
<p>On vous parle du concept d'immutabilit√©, du nouvel outil Prettier ainsi que du
langage Go que Mathieu nous pr√©sente.</p>
<p>Liens: -Prettier: <a href="https://github.com/prettier/prettier">https://github.com/prettier/prettier</a> -LearnXInYMinutes:
<a href="https://learnxinyminutes.com">https://learnxinyminutes.com</a></p>
<p>Erratum par avance:</p>
<ul>
<li>Go en JS, √ßa existe: <a href="https://github.com/gopherjs/gopherjs">https://github.com/gopherjs/gopherjs</a></li>
<li>Go a vraiment une tabulation √† la con: <a href="https://golang.org/cmd/gofmt/">https://golang.org/cmd/gofmt/</a></li>
</ul>
<iframe width="100%" height="450" scrolling="no" frameborder="no" src="https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/320551397&amp;auto_play=false&amp;hide_related=false&amp;show_comments=true&amp;show_user=true&amp;show_reposts=false&amp;visual=true"></iframe>
<ul>
<li>Le
<a href="http://feeds.soundcloud.com/users/soundcloud:users:273901232/sounds.rss">RSS</a></li>
<li>Sur iTunes : <a href="https://itunes.apple.com/fr/podcast/putain-de-code-!/id1185311825?l=en&#x26;mt=2">Putain de
Code</a></li>
</ul>
]]></description><link>http://putaindecode.io/fr/articles/podcast/5/</link><guid isPermaLink="true">http://putaindecode.io/fr/articles/podcast/5/</guid><pubDate>Wed, 03 May 2017 00:00:00 GMT</pubDate></item><item><title><![CDATA[Podcast 4: √áa scale pas quand on sait en faire (feat. iAmNotCyril)]]></title><description><![CDATA[<p>On se retrouve avec un √©pisode un poil plus long et arros√©, avec Mathieu
(<a href="https://twitter.com/Zoontek">https://twitter.com/Zoontek</a>), Georges (<a href="https://twitter.com/skinnyfoetusboy">https://twitter.com/skinnyfoetusboy</a>),
Maxime (<a href="https://twitter.com/MoOx">https://twitter.com/MoOx</a>), Matthias (<a href="https://twitter.com/bloodyowl">https://twitter.com/bloodyowl</a>) et
le premier invit√© de l'√©mission : Cyril (<a href="https://twitter.com/IAmNotCyril">https://twitter.com/IAmNotCyril</a>),
d√©veloppeur front-end chez Netcats (<a href="https://twitter.com/gonetcats">https://twitter.com/gonetcats</a>).</p>
<p>Est-ce que le m√©tier d'int√©grateur va dispara√Ætre ? On d√©bat des m√©tiers
gravitant autour du front-end web, de ce que c'√©tait hier, de ce que c'est
aujourd'hui, de comment on pense que ce sera demain, le tout avec une bonne dose
de mauvaise foi‚Ñ¢.</p>
<p>On parle aussi d'√©diteurs de code de fa√ßon presque intelligible: Sublime Text vs
Atom vs VSCo‚Ä¶ le mieux c'est de laisser Mathieu parler de ce dernier.</p>
<p>Les liens:</p>
<ul>
<li>Sublime Text:
<a href="https://web.archive.org/web/20080701071916/http://www.sublimetext.com/">https://web.archive.org/web/20080701071916/http://www.sublimetext.com/</a></li>
<li>Atom: <a href="https://atom.io">https://atom.io</a></li>
<li>VSCode: <a href="https://code.visualstudio.com">https://code.visualstudio.com</a></li>
</ul>
<iframe width="100%" height="450" scrolling="no" frameborder="no" src="https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/313086300%3Fsecret_token%3Ds-uDXSJ&amp;auto_play=false&amp;hide_related=false&amp;show_comments=true&amp;show_user=true&amp;show_reposts=false&amp;visual=true"></iframe>
<ul>
<li>Le
<a href="http://feeds.soundcloud.com/users/soundcloud:users:273901232/sounds.rss">RSS</a></li>
<li>Sur iTunes : <a href="https://itunes.apple.com/fr/podcast/putain-de-code-!/id1185311825?l=en&#x26;mt=2">Putain de
Code</a></li>
</ul>
]]></description><link>http://putaindecode.io/fr/articles/podcast/4/</link><guid isPermaLink="true">http://putaindecode.io/fr/articles/podcast/4/</guid><pubDate>Tue, 21 Mar 2017 00:00:00 GMT</pubDate></item><item><title><![CDATA[Formatez votre JavaScript avec prettier]]></title><description><![CDATA[<p>Rob Pike et Ken Thompson ont con√ßu le langage de programmation Go de fa√ßon √† ce
que celui-ci soit √† port√©e des jeunes d√©veloppeurs : si vous d√©couvrez et
commencez √† apprendre le Go le lundi, vous devriez √™tre en mesure d'√™tre
productif le mercredi. Le langage est extr√™mement minimaliste, il y a rarement
plus d'une fa√ßon de faire quelque chose.</p>
<p>Seulement voil√†, le d√©veloppeur tortur√© se posera toujours un tas de questions
essentielles : tabs ou spaces ? 2, 4 ou 8 spaces ? Single quotes ou double
quotes ? Apr√®s quelles structures de contr√¥le passer une ligne ? Mais aussi les
√©ternels : vim ou emacs ? Flow ou TypeScript ? Maintenir ce projet Angular 1 ou
d√©missionner comme un prince ?</p>
<p><em>N.B. : Pour information, les bonnes r√©ponses sont bien √©videmment spaces, 2,
single quotes, vim, flow, la d√©mission</em></p>
<p>C'est pour r√©pondre √† ce probl√®me (enfin, ceux li√©s au formatage de votre code)
que Go int√®gre un formatting tool (<code>fmt</code>, comme la commande Unix), intitul√©
<a href="https://golang.org/cmd/gofmt/">gofmt</a>.</p>
<ol>
<li>Vous codez comme vous le sentez</li>
<li>Vous sauvegardez votre fichier</li>
<li>Votre code est automatiquement format√©</li>
<li>Vous vous sentez frustr√©</li>
<li>Tr√®s vite, vous vous rendez compte que c'est pour votre bien, et que perdre
du temps ou d√©battre sur ce genre de d√©tails, c'est tout sauf utile</li>
</ol>
<p>Autre avantage non n√©gligeable : le code Go que vous trouverez dans d'autres
packages, des exemples, etc. sera toujours format√© de la m√™me fa√ßon.</p>
<p><em>√Ä noter : Reason offre quelque chose de similaire avec
<a href="https://facebook.github.io/reason/tools.html">refmt</a>.</em></p>
<p>Cette solution officielle n'existe pas en JS. Mais c'est ici qu'intervient
<a href="https://github.com/prettier/prettier">prettier</a> (et non
<a href="https://www.npmjs.com/package/jsfmt">jsfmt</a>, qui existe mais ne semble plus
maintenu), un projet relativement r√©cent, en version <code>0.21</code> √† l'heure o√π j'√©cris
ces lignes. Compatible <em>out of the box</em> avec le JS ES2017, JSX, flow, il offre
√©galement le moins de configuration possible (ce qui est une bonne chose). Le
projet est activement suivi par Facebook, qui discute m√™me la possibilit√© de
s'en servir sur la codebase de
<a href="https://github.com/facebook/react/pull/9101">React</a>.</p>
<h2 id="comment-√ßa-fonctionne-"><a href="#comment-%C3%A7a-fonctionne-" class="phenomic-HeadingAnchor">#</a>Comment √ßa fonctionne ?</h2>
<p>Croyez-le ou non, ce n'est pas "tellement" complexe. √Ä la mani√®re de babel ou
flow, prettier utilise un AST parser (Abstract Syntax Tree parser) afin
d'analyser le contenu de votre fichier JS, suite √† quoi il va simplement
formater votre code sans tenir compte de la forme pr√©c√©dente, en ne gardant que
ce qui est important: le fond, pas la forme.</p>
<p>Je vous invite √† jouer avec <a href="https://astexplorer.net/">AST explorer</a> pour
comprendre beaucoup plus simplement comment tout cela fonctionne.</p>
<h2 id="installation"><a href="#installation" class="phenomic-HeadingAnchor">#</a>Installation</h2>
<pre><code class="hljs language-console">npm install --save-dev prettier</code></pre>
<p>Ou, pour les meilleurs d'entre vous :</p>
<pre><code class="hljs language-console">yarn add --dev prettier</code></pre>
<p>¬Ø\<em>( „ÉÑ )</em>/¬Ø</p>
<h2 id="configuration"><a href="#configuration" class="phenomic-HeadingAnchor">#</a>Configuration</h2>
<p>Car oui, il y en a tout de m√™me un peu. Il est possible de r√©gler:</p>
<ul>
<li>La longueur maximale des lignes (<code>printWidth</code>, <code>80</code> caract√®res par d√©faut)</li>
<li>Le nombre d'espaces pour l'indentation (<code>tabWidth</code>, <code>2</code> par d√©faut, pas de
tabs)</li>
<li>Single quotes / double quotes (<code>singleQuote</code>, <code>false</code> par d√©faut)</li>
<li>S'il faut ajouter des virgules en fin de certaines structures (comme les
objets, mais aussi dans les param√®tres de fonction, ce qui est possible depuis
peu) (<code>trailingComma</code>, <code>none</code> par d√©faut, <code>es5</code> et <code>all</code> sont √©galement
possibles)</li>
<li>S'il faut ajouter des espaces dans un objet √©crit sur une seule ligne
(<code>bracketSpacing</code>, <code>true</code> par d√©faut)</li>
<li>Comment fermer les balises JSX (<code>jsxBracketSameLine</code>, <code>false</code> par d√©faut)</li>
<li>Quel parser utiliser (<code>parser</code>, <code>babylon</code> par d√©faut, <code>flow</code> est disponible)</li>
</ul>
<blockquote>
<p>Mais attends‚Ä¶ Si l'on peut malgr√© tout configurer tout √ßa, ce n'est plus
vraiment un style standard ?</p>
</blockquote>
<p>Oui et non, car il y aura toujours beaucoup de d√©tails sur lesquels il nous sera
impossible de choisir, les options resteront minimalistes. Par exemple, vous ne
pourrez jamais retirer les points-virgules.</p>
<p><code>EDIT: Il semblerait que malgr√© ce qui a pu √™tre annonc√© par l'auteur de prettier, une option --no-semicolons soit dans les tuyaux.</code></p>
<p>Dans tous les cas, prettier reste un outil extr√™mement pratique pour forcer le
formatage du code au sein de votre √©quipe.</p>
<p>Ouvrez votre <code>package.json</code>, c'est parti.</p>
<pre><code class="hljs language-json">{
  <span class="hljs-attr">"scripts"</span>: {
    <span class="hljs-attr">"prettify"</span>: <span class="hljs-string">"prettier src/**/*.js"</span>
  },
  <span class="hljs-attr">"devDependencies"</span>: {
    <span class="hljs-attr">"prettier"</span>: <span class="hljs-string">"^0.21.0"</span>
  }
}</code></pre>
<p><code>npm run prettify</code> ou <code>yarn run prettify</code> formateront automatiquement tous les
fichiers <code>.js</code> contenus dans votre dossier <code>/src</code>. Bon j'avoue, c'est assez
basique comme usage. Ajoutons-y notre config pr√©f√©r√©e.</p>
<pre><code class="hljs language-json">{
  <span class="hljs-attr">"scripts"</span>: {
    <span class="hljs-attr">"prettify"</span>:
      <span class="hljs-string">"prettier --single-quote --trailing-comma all --write '{src,__{tests,mocks}__}/**/*.js'"</span>
  },
  <span class="hljs-attr">"devDependencies"</span>: {
    <span class="hljs-attr">"prettier"</span>: <span class="hljs-string">"^0.21.0"</span>
  }
}</code></pre>
<p><code>npm run prettify</code> ou <code>yarn run prettify</code> formateront maintenant automatiquement
tous les fichiers <code>.js</code> contenus dans vos dossiers <code>/src</code>, <code>__tests__</code> et
<code>__mocks__</code>, en utilisant le parser de flow, pr√©f√©rant les single quotes et en
ajoutant une virgule en fin de chaque structure possible.</p>
<p>OK. Mais si un membre de l'√©quipe oublie d'ex√©cuter le script avant de commiter
son code ? <strong>We got this !</strong> (avec 2 d√©pendances de plus).</p>
<pre><code class="hljs language-json">{
  <span class="hljs-attr">"scripts"</span>: {
    <span class="hljs-attr">"precommit"</span>: <span class="hljs-string">"lint-staged"</span>,
    <span class="hljs-attr">"prettify"</span>:
      <span class="hljs-string">"prettier --single-quote --trailing-comma all --write '{src,__{tests,mocks}__}/**/*.js'"</span>
  },
  <span class="hljs-attr">"lint-staged"</span>: {
    <span class="hljs-attr">"{src,__{tests,mocks}__}/**/*.js"</span>: [
      <span class="hljs-string">"prettier --single-quote --trailing-comma all --write"</span>,
      <span class="hljs-string">"git add"</span>
    ]
  },
  <span class="hljs-attr">"devDependencies"</span>: {
    <span class="hljs-attr">"husky"</span>: <span class="hljs-string">"^0.13.2"</span>,
    <span class="hljs-attr">"lint-staged"</span>: <span class="hljs-string">"^3.3.1"</span>,
    <span class="hljs-attr">"prettier"</span>: <span class="hljs-string">"^0.21.0"</span>
  }
}</code></pre>
<h2 id="les-plugins"><a href="#les-plugins" class="phenomic-HeadingAnchor">#</a>Les plugins</h2>
<p>Si vous ne pouvez pas attendre le moment du commit pour admirer votre code
fraichement format√©, il existe d√©j√† pas mal de plugins, pour pas mal d'√©diteurs
: <code>prettier-atom</code>, <code>prettier-vscode</code>, <code>Jsprettier</code> (pour Sublime Text), mais
aussi pour emacs, vim, les IDE Jetbrain, etc. Tout est dans le
<a href="https://github.com/prettier/prettier/blob/master/README.md">README</a>.</p>
<p><em>Protip: Inutile de vous conforter au style de formatage de votre √©quipe au sein
de votre √©diteur si le code est √† nouveau format√© en pre-commit.</em></p>
<h2 id="quelques-exemples-cest-possible-"><a href="#quelques-exemples-cest-possible-" class="phenomic-HeadingAnchor">#</a>Quelques exemples, c'est possible ?</h2>
<p>J'ai mieux. Il est possible d'<a href="https://prettier.github.io/prettier">essayer en
ligne</a> ! ‚ú®</p>
<h2 id="donc-cest-bon-tu-conseilles-"><a href="#donc-cest-bon-tu-conseilles-" class="phenomic-HeadingAnchor">#</a>Donc c'est bon, tu conseilles ?</h2>
<p>C'est tout de m√™me √† r√©fl√©chir. Le projet est encore jeune et en beta, m√™me s'il
√©volue extr√™mement vite. Tout n'est pas encore parfaitement support√©, mais je
vous rassure, si vous n'utilisez pas le flow-parser vous ne risquez pas de
rencontrer beaucoup de probl√®mes avec la derni√®re version.</p>
<p>Des projets tels que
<a href="https://github.com/facebook/immutable-js/commit/9bcc8b54a17c3bbc94d70864121784bc91011e8f">immutable-js</a>,
<a href="https://github.com/necolas/react-native-web/commit/a2f25a46c495ca53a75e728cfb14dbdf67cdb342">react-native-web</a>
et
<a href="https://github.com/babel/babel/commit/bdbe2cfbc5ab5ba6f528b7ee3e4bf5ed940a47af">babel</a>
y sont d√©j√† pass√©s. Pourquoi pas vous ? üòâ</p>
]]></description><link>http://putaindecode.io/fr/articles/js/prettier/</link><guid isPermaLink="true">http://putaindecode.io/fr/articles/js/prettier/</guid><pubDate>Wed, 08 Mar 2017 00:00:00 GMT</pubDate></item><item><title><![CDATA[Podcast √©pisode 3]]></title><description><![CDATA[<h2 id="orga-nis√©"><a href="#orga-nis%C3%A9" class="phenomic-HeadingAnchor">#</a><em>Orga-nis√©</em></h2>
<p>Pour ce 3√®me √©pisode, on a miraculeusement <em>r√©ussi</em> √† faire plus court.</p>
<p>Y participent :</p>
<ul>
<li>Maxime alias <a href="https://twitter.com/MoOx">MoOx</a></li>
<li>Mathieu alias <a href="https://twitter.com/Zoontek">Zoontek</a></li>
<li>Matthias alias <a href="https://twitter.com/bloodyowl">bloodyowl</a></li>
</ul>
<p>et on vous y parle de :</p>
<ul>
<li>typing</li>
<li>OO vs FP (premier √©pisode d'une s√©rie, stay tuned)</li>
<li>monorepos</li>
</ul>
<p>On esp√®re que √ßa vous plaira !</p>
<p>Bisous.</p>
<iframe width="100%" height="450" scrolling="no" frameborder="no" src="https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/307914736&amp;auto_play=false&amp;hide_related=false&amp;show_comments=true&amp;show_user=true&amp;show_reposts=false&amp;visual=true"></iframe>
<ul>
<li>Le
<a href="http://feeds.soundcloud.com/users/soundcloud:users:273901232/sounds.rss">RSS</a></li>
<li>Sur iTunes : <a href="https://itunes.apple.com/fr/podcast/putain-de-code-!/id1185311825?l=en&#x26;mt=2">Putain de
Code</a></li>
</ul>
]]></description><link>http://putaindecode.io/fr/articles/podcast/3/</link><guid isPermaLink="true">http://putaindecode.io/fr/articles/podcast/3/</guid><pubDate>Thu, 16 Feb 2017 00:00:00 GMT</pubDate></item><item><title><![CDATA[Introduction √† styled-components]]></title><description><![CDATA[<p>Il existe de nombreuses approches et <a href="https://github.com/MicheleBertoli/css-in-js">solutions
diff√©rentes</a> pour g√©rer le CSS en
ReactJS, je vais parler ici de
<a href="https://github.com/styled-components/styled-components">styled-components</a> qui
permet de gagner en productivit√© et en qualit√© quand on veut cr√©er et distribuer
des composants UI.</p>
<p>La force de
<a href="https://github.com/styled-components/styled-components">styled-components</a>
c'est de faciliter la cr√©ation de composants visuels ReactJS minimalistes et
configurables, en combinant du <strong>CSS standard</strong> et <strong>un zeste de JavaScript</strong>.
Ces composants deviendront litt√©ralement les pi√®ces de lego qui pourront √™tre
utilis√©es et partag√©es entre les UIs de toutes vos applications, sites webs...</p>
<p>Si vous voulez jouer avec, je vous conseille d'utiliser
<a href="https://github.com/facebookincubator/create-react-app">create-react-app</a> pour
g√©n√©rer un projet vierge puis d'ajouter styled-components au projet : <code>npm i --save styled-components</code>.</p>
<p>Avec styled, on peut abstraire le CSS et le DOM de la vue, ce qui va grandement
simplifier le code de la partie "m√©tier" de l'application, et am√©liorer la
lisibilit√©.</p>
<h5 id="avant-"><a href="#avant-" class="phenomic-HeadingAnchor">#</a>Avant :</h5>
<pre><code class="hljs language-jsx"><span class="hljs-comment">// solution en pure CSS-in-JS</span>

<span class="hljs-keyword">const</span> styles = {
  <span class="hljs-attr">box</span>: {
    <span class="hljs-attr">width</span>: <span class="hljs-string">'60%'</span>,
    <span class="hljs-attr">border</span>: <span class="hljs-string">'1px solid silver'</span>
  },
  <span class="hljs-attr">title</span>: {
    <span class="hljs-attr">fontSize</span>: <span class="hljs-string">'1.2em'</span>,
    <span class="hljs-attr">fontWeight</span>: <span class="hljs-string">'bold'</span>
  },
  <span class="hljs-attr">description</span>: {
    <span class="hljs-attr">fontSize</span>: <span class="hljs-string">'0.8em'</span>
  },
  <span class="hljs-attr">important</span>: {
    <span class="hljs-attr">fontWeight</span>: <span class="hljs-string">'bold'</span>
  }
}

<span class="hljs-comment">// nos composants int√®grent les styles dans le code</span>
&#x3C;div className={ styles.box }>
  <span class="xml"><span class="hljs-tag">&#x3C;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">{</span> <span class="hljs-attr">styles.title</span> }></span>{ title }<span class="hljs-tag">&#x3C;/<span class="hljs-name">div</span>></span></span>
  &#x3C;div className={ classnames(styles.description, styles.important) }>{ description }&#x3C;<span class="hljs-regexp">/div>
&#x3C;/</span>div></code></pre>
<h5 id="apr√®s-"><a href="#apr%C3%A8s-" class="phenomic-HeadingAnchor">#</a>Apr√®s :</h5>
<pre><code class="hljs language-jsx"><span class="hljs-comment">// avec styled-components</span>

<span class="hljs-keyword">const</span> Box = styled.div<span class="hljs-string">`
  width: 60%;
  border: 1px solid silver;
`</span>

<span class="hljs-keyword">const</span> Title = styled.div<span class="hljs-string">`
  font-size: 1.2em;
  font-weight: bold;
`</span>

<span class="hljs-keyword">const</span> Description = styled.div<span class="hljs-string">`
  font-size: 0.8em;
  font-weight: <span class="hljs-subst">${ props => props.important ? <span class="hljs-string">'bold'</span> : <span class="hljs-string">'normal '</span>}</span>
`</span>

<span class="hljs-comment">// les composants sont pr√©-styl√©s, pas de bruit g√©n√©r√© par le styling</span>
&#x3C;Box>
  <span class="xml"><span class="hljs-tag">&#x3C;<span class="hljs-name">Title</span>></span>{ title }<span class="hljs-tag">&#x3C;/<span class="hljs-name">Title</span>></span></span>
  &#x3C;Description important>{ description }&#x3C;<span class="hljs-regexp">/Description>
&#x3C;/</span>Box></code></pre>
<h3 id="avantages-"><a href="#avantages-" class="phenomic-HeadingAnchor">#</a>Avantages :</h3>
<ul>
<li>
<p><a href="https://github.com/styled-components/styled-components/graphs/contributors">community
powered</a></p>
<ul>
<li>moving fast, <a href="https://github.com/styled-components/styled-components/tree/v2">v2 en
cours</a></li>
</ul>
</li>
<li>support des
<a href="https://github.com/styled-components/styled-components/blob/master/docs/theming.md">th√®mes</a></li>
<li><a href="https://github.com/styled-components/styled-components/blob/master/docs/css-we-support.md">syntaxe CSS
"classique"</a>
mais scop√© automatiquement</li>
<li>Gestion des media queries, pseudo-selectors, nesting</li>
<li>Un <a href="https://github.com/rofrischmann/inline-style-prefixer/">autoprefixer-like
int√©gr√©</a></li>
<li>Code "m√©tier" plus lisible</li>
<li>Compatible react-native</li>
<li>Compatible avec les <a href="https://facebook.github.io/jest/">snapshots Jest</a> out of
the box</li>
<li>Ne n√©cessite pas de loader Webpack sp√©cifique ‚ù§Ô∏è</li>
</ul>
<h3 id="inconv√©nients-"><a href="#inconv%C3%A9nients-" class="phenomic-HeadingAnchor">#</a>Inconv√©nients :</h3>
<ul>
<li>pas encore id√©al pour <a href="https://github.com/styled-components/styled-components/issues/134">des styles tr√®s
dynamiques</a></li>
<li>pas encore id√©al pour <a href="https://github.com/styled-components/styled-components/issues/124">le
server-side</a></li>
<li>syntaxe pas forcement bien <a href="https://github.com/styled-components/styled-components#linting">surlign√©e ou
lint√©e</a> mais
<a href="https://github.com/styled-components/styled-components#syntax-highlighting">des plugins
existent</a>.</li>
</ul>
<h3 id="fonctionnement"><a href="#fonctionnement" class="phenomic-HeadingAnchor">#</a>Fonctionnement</h3>
<p>Techniquement,
<a href="https://github.com/styled-components/styled-components">styled-components</a> va
pour chaque composant "styled" pr√©sent dans le DOM :</p>
<ul>
<li>injecter les classes CSS n√©cessaires pour ce composant dans le <code>&#x3C;head></code> de la
page, au runtime.</li>
<li>fournir au composant une props <code>className</code> unique (ainsi que ses <code>ownProps</code>)</li>
</ul>
<p>La syntaxe est certes exotique, le CSS √©tant d√©fini dans un template-string
ES2015, mais ceci rend le code tr√®s concis.</p>
<p>Pour en savoir plus sur les "Template Strings", ou "Litt√©raux de gabarits" en
Fran√ßais üá´üá∑ vous pouvez lire <a href="https://developer.mozilla.org/fr/docs/Web/JavaScript/Reference/Litt%C3%A9raux_gabarits">l'excellente doc chez
MDN</a>.</p>
<h3 id="usage-"><a href="#usage-" class="phenomic-HeadingAnchor">#</a>Usage :</h3>
<pre><code class="hljs language-jsx"><span class="hljs-keyword">import</span> styled <span class="hljs-keyword">from</span> <span class="hljs-string">'styled-components'</span>

<span class="hljs-comment">// exemple ici avec une div</span>
<span class="hljs-keyword">const</span> Title = styled.div<span class="hljs-string">`
  font-size: 3rem;
  color: #ff3333;
`</span>

<span class="hljs-comment">// utilisable comme ceci :</span>
&#x3C;Title>Hello, World&#x3C;<span class="hljs-regexp">/Title></span></code></pre>
<p>ceci qui g√©n√®rera automatiquement dans le DOM:</p>
<pre><code class="hljs language-html"><span class="hljs-tag">&#x3C;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"dxhUOh"</span>></span>Hello, World<span class="hljs-tag">&#x3C;/<span class="hljs-name">div</span>></span></code></pre>
<p>et injectera dans le CSS de la page le style associ√© :</p>
<pre><code class="hljs language-css"><span class="hljs-selector-class">.dxhUOh</span> {
  <span class="hljs-attribute">font-size</span>: <span class="hljs-number">3rem</span>;
  <span class="hljs-attribute">color</span>: <span class="hljs-number">#ff3333</span>;
}</code></pre>
<p><img src="./styled-1.png" width="200"/></p>
<h2 id="exemples"><a href="#exemples" class="phenomic-HeadingAnchor">#</a>Exemples</h2>
<h3 id="composition"><a href="#composition" class="phenomic-HeadingAnchor">#</a>Composition</h3>
<p>Les composants styled sont des composants ReactJS standards qui peuvent recevoir
des <code>children</code> et se composer les uns avec les autres.</p>
<pre><code class="hljs language-jsx"><span class="hljs-keyword">const</span> Box = styled.div<span class="hljs-string">`
  border: 1px solid silver;
  width: 80%;
  padding: 1em;
  text-align: center;
  background: #e7f3ff;
`</span>

<span class="hljs-keyword">const</span> Title = styled.div<span class="hljs-string">`
  font-size: 1.5em;
  color: #0080ff;
`</span>

&#x3C;Box>
  <span class="xml"><span class="hljs-tag">&#x3C;<span class="hljs-name">Title</span>></span>Hello, World<span class="hljs-tag">&#x3C;/<span class="hljs-name">Title</span>></span></span>
&#x3C;<span class="hljs-regexp">/Box></span></code></pre>
<p><img src="./styled-2.png" width="300"/></p>
<h3 id="etendre-des-composants-en-css"><a href="#etendre-des-composants-en-css" class="phenomic-HeadingAnchor">#</a>Etendre des composants en CSS</h3>
<p>Surcharger un composant avec du CSS :</p>
<pre><code class="hljs language-jsx"><span class="hljs-keyword">const</span> Title = styled.div<span class="hljs-string">`
  font-size: 3rem;
  color: #ff3333;
`</span>
<span class="hljs-keyword">const</span> BlueTitle = styled(Title)<span class="hljs-string">`
  color: #0080ff;
`</span>
&#x3C;Title>titre en rouge&#x3C;<span class="hljs-regexp">/Title>
&#x3C;BlueTitle>titre en bleu&#x3C;/</span>BlueTitle></code></pre>
<p><img src="./styled-3.png" width="200"/></p>
<h3 id="pseudo-classes"><a href="#pseudo-classes" class="phenomic-HeadingAnchor">#</a>Pseudo classes</h3>
<p>Les pseudo-classes, le nesting sont accept√©es</p>
<pre><code class="hljs language-jsx"><span class="hljs-keyword">const</span> Button = styled.button<span class="hljs-string">`
  font-size: 3rem;
  color: #ff3333;
  &#x26;:hover {
    color: #0080ff;
  }
`</span>;</code></pre>
<p><img src="./styled-hover.gif" width="100"/></p>
<h3 id="media-queries"><a href="#media-queries" class="phenomic-HeadingAnchor">#</a>Media queries</h3>
<p>Les medias queries sont possibles facilement :</p>
<pre><code class="hljs language-jsx"><span class="hljs-keyword">const</span> Cover = styled.div<span class="hljs-string">`
  background-image: url(http://putaindecode.io/assets/npm.png);
  background-repeat: no-repeat;
  background-size: contain;
  background-position: center center;
  width: 800px;
  height: 300px;

  @media (max-width: 800px) {
    width: 400px;
  }
`</span>;</code></pre>
<p>Usage avanc√© des media queries :
<a href="https://github.com/styled-components/styled-components/blob/master/docs/tips-and-tricks.md#media-templates">https://github.com/styled-components/styled-components/blob/master/docs/tips-and-tricks.md#media-templates</a></p>
<h3 id="composants-configurables"><a href="#composants-configurables" class="phenomic-HeadingAnchor">#</a>Composants configurables</h3>
<p>Mieux : comme le composant √† directement acc√®s aux <code>props</code> (attributs du
composant), on peut le configurer depuis le JavaScript :</p>
<pre><code class="hljs language-jsx"><span class="hljs-keyword">const</span> Title = styled.div<span class="hljs-string">`
  font-size: 3rem;
  color: <span class="hljs-subst">${props => props.blue ? <span class="hljs-string">'#0080ff'</span> : <span class="hljs-string">'#ff3333'</span>}</span>;
`</span>
&#x3C;Title>titre en rouge&#x3C;<span class="hljs-regexp">/Title>
&#x3C;Title blue>titre en bleu&#x3C;/</span>Title></code></pre>
<p><img src="./styled-3.png" width="200"/></p>
<h3 id="dans-un-composant-react-classique"><a href="#dans-un-composant-react-classique" class="phenomic-HeadingAnchor">#</a>Dans un composant React "classique"</h3>
<p>Avec la methode <code>styled.css</code>, une <code>className</code> unique est g√©n√©r√©e et peut √™tre
utilis√©e pour vos composants :</p>
<pre><code class="hljs language-jsx"><span class="hljs-keyword">import</span> Notification <span class="hljs-keyword">from</span> <span class="hljs-string">"./Notification"</span>;

<span class="hljs-keyword">const</span> warning = styled.css<span class="hljs-string">`
  color: #ff3333;
`</span>;

<span class="hljs-keyword">const</span> WarningNotification = <span class="hljs-function"><span class="hljs-params">()</span> =></span> &#x3C;Notification className={warning} />;</code></pre>
<h3 id="r√©utiliser-des-styles"><a href="#r%C3%A9utiliser-des-styles" class="phenomic-HeadingAnchor">#</a>R√©utiliser des styles</h3>
<p>Comme styled utilise des <a href="https://developer.mozilla.org/fr/docs/Web/JavaScript/Reference/Litt%C3%A9raux_gabarits">templates
literals</a>
vous pouvez utiliser n'importe quelle variable dans votre CSS :</p>
<pre><code class="hljs language-jsx"><span class="hljs-keyword">const</span> textStyle = <span class="hljs-string">`
  font-size: 2em;
  letter-spacing: 5px;
`</span>
<span class="hljs-keyword">const</span> TextRed = styled.div<span class="hljs-string">`
  <span class="hljs-subst">${textStyle}</span>
  color: #ff3333;
`</span>
<span class="hljs-keyword">const</span> TextBlue = styled.div<span class="hljs-string">`
  <span class="hljs-subst">${textStyle}</span>
  color: #0080ff;
`</span>
&#x3C;TextRed>texte en rouge&#x3C;<span class="hljs-regexp">/TextRed>
&#x3C;TextBlue>texte en bleu&#x3C;/</span>TextBlue></code></pre>
<p><img src="./styled-4.png" width="200"/></p>
<h3 id="attributs-html"><a href="#attributs-html" class="phenomic-HeadingAnchor">#</a>Attributs HTML</h3>
<p>Par d√©faut les composants styled passent toutes leur <code>props</code> au DOM, par exemple
ici, <code>placeholder</code>.</p>
<pre><code class="hljs language-jsx"><span class="hljs-keyword">const</span> SuperInput = styled.input<span class="hljs-string">`
  border: 2px solid silver;
  border-radius: 2px;
  text-align: center;
  font-size: 1.5em;
`</span>

&#x3C;SuperInput placeholder=<span class="hljs-string">"Your name"</span>/></code></pre>
<p><img src="./styled-5.png" width="200"/></p>
<h3 id="utiliser-le-theming"><a href="#utiliser-le-theming" class="phenomic-HeadingAnchor">#</a>Utiliser le theming</h3>
<p>Pour rendre son UI themable, il suffit d'encapsuler son App dans un composant
<code>ThemeProvider</code>; Chaque composant styled se verra alors fournir une props
<code>theme</code> avec toutes les variables du th√®me :</p>
<pre><code class="hljs language-jsx"><span class="hljs-keyword">const</span> Button = styled.button<span class="hljs-string">`
  background: <span class="hljs-subst">${props => props.theme.main || <span class="hljs-string">'silver'</span>}</span>;
`</span>

<span class="hljs-comment">// Create a green theme</span>
<span class="hljs-keyword">const</span> greenTheme = {
  <span class="hljs-attr">main</span>: <span class="hljs-string">'mediumseagreen'</span>,
}

<span class="hljs-comment">// Create a blue theme</span>
<span class="hljs-keyword">const</span> blueTheme = {
  <span class="hljs-attr">main</span>: <span class="hljs-string">'#0080ff'</span>,
}

&#x3C;ThemeProvider theme={greenTheme}>
  <span class="xml"><span class="hljs-tag">&#x3C;<span class="hljs-name">Button</span>></span>I'm green!<span class="hljs-tag">&#x3C;/<span class="hljs-name">Button</span>></span></span>
&#x3C;<span class="hljs-regexp">/ThemeProvider></span></code></pre>
<p>Et pour aller loin, consultez la <a href="https://github.com/styled-components/styled-components/blob/master/docs/theming.md#using-theming">documentation
officielle</a></p>
<h3 id="injecter-des-css-globaux"><a href="#injecter-des-css-globaux" class="phenomic-HeadingAnchor">#</a>Injecter des CSS globaux</h3>
<p>Parfois on a besoin d'int√©grer aussi du CSS "global". Par exemple pour les
fontes, ou lorsque l'on migre une grosse application.</p>
<p>Voici une fa√ßon de le faire avec styled :</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">import</span> { injectGlobal } <span class="hljs-keyword">from</span> <span class="hljs-string">"styled-components"</span>;

injectGlobal<span class="hljs-string">`
  @import url('https://fonts.googleapis.com/css?family=Roboto');
  * {
    font-family: 'Roboto', sans-serif;
  }
`</span>;</code></pre>
<p>Plus d'infos sur <a href="https://github.com/styled-components/styled-components/blob/master/docs/api.md#injectglobal">la doc
d'injectGlobal</a></p>
<h3 id="react-storybook"><a href="#react-storybook" class="phenomic-HeadingAnchor">#</a>React Storybook</h3>
<p>En ajoutant <a href="https://github.com/storybooks/react-storybook">react-storybook</a>
dans votre projet, vous pourrez facilement vous constituter une biblioth√®que
visuelle avec vos propres composants, hors-contexte, dans tous leurs √©tats
possibles, et avec du Hot-Reload ce qui est <strong>tr√®s tr√®s pratique dans la phase
de conception</strong>.</p>
<h3 id="autres-liens-"><a href="#autres-liens-" class="phenomic-HeadingAnchor">#</a>Autres liens :</h3>
<ul>
<li><a href="https://github.com/styled-components/styled-components/blob/master/docs">Documentation
officielle</a></li>
<li><a href="https://www.smashingmagazine.com/2017/01/styled-components-enforcing-best-practices-component-based-systems/">Enforcing Best Practices In Component-Based
Systems</a></li>
<li><a href="http://mxstbr.blog/2016/11/styled-components-magic-explained/">The magic behind üíÖ
styled-components</a></li>
<li><a href="https://github.com/MicheleBertoli/css-in-js">React CSS-in-JS techniques
comparison</a></li>
</ul>
]]></description><link>http://putaindecode.io/fr/articles/js/react/styled-components/</link><guid isPermaLink="true">http://putaindecode.io/fr/articles/js/react/styled-components/</guid><pubDate>Wed, 01 Feb 2017 00:00:00 GMT</pubDate></item><item><title><![CDATA[Podcast √©pisode 2]]></title><description><![CDATA[<h2 id="le-lendemain-des-trois-jours"><a href="#le-lendemain-des-trois-jours" class="phenomic-HeadingAnchor">#</a><em>Le lendemain des trois jours</em></h2>
<p>Y participent :</p>
<ul>
<li>Mathieu alias <a href="https://twitter.com/Zoontek">Zoontek</a></li>
<li>Georges alias <a href="https://twitter.com/skinnyfoetusboy">skinnyfoetusboy</a></li>
<li>Matthias alias <a href="https://twitter.com/bloodyowl">bloodyowl</a></li>
</ul>
<p>et on vous y parle de :</p>
<ul>
<li>solutions pour l'UI qu'on passe en revue</li>
<li>unit testing JS</li>
<li>nouveaux MacBook 2016</li>
</ul>
<p>On esp√®re que √ßa vous plaira !</p>
<p>Bisous.</p>
<iframe width="100%" height="450" scrolling="no" frameborder="no" src="https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/301667566&amp;auto_play=false&amp;hide_related=false&amp;show_comments=true&amp;show_user=true&amp;show_reposts=false&amp;visual=true"></iframe>
<ul>
<li>Le
<a href="http://feeds.soundcloud.com/users/soundcloud:users:273901232/sounds.rss">RSS</a></li>
<li>Sur iTunes : <a href="https://itunes.apple.com/fr/podcast/putain-de-code-!/id1185311825?l=en&#x26;mt=2">Putain de
Code</a></li>
</ul>
]]></description><link>http://putaindecode.io/fr/articles/podcast/2/</link><guid isPermaLink="true">http://putaindecode.io/fr/articles/podcast/2/</guid><pubDate>Thu, 12 Jan 2017 00:00:00 GMT</pubDate></item><item><title><![CDATA[Quelques petits hÕîÃûÃûÃ≠ÕôÕ†aÃò√ßÃ´ÃØÕìkÃµÕñÃòÃ¨Ã≥Ã±ÃØÃ§sÃ¥ÕéÃªÃØ typographiques]]></title><description><![CDATA[<p>On ne va pas se mentir, la typo c'est quand m√™me super important sur le web, et
il va falloir admettre que ce bon vieux Gutenberg avait eu un sacr√© flair √†
l'√©poque.</p>
<p>Ah, qu'il est bon de parcourir un web parfaitement typesett√©, avec de jolies
polices bien kern√©es et- NOPE. Au mieux une bonne grosse Arial bien crasse dans
ta face quand c'est pas de la Comic Sans MS rendue avec un cr√©nelage moisi sous
Windows XP, #geocities.</p>
<p>Heureusement, le web a progress√© depuis, et en tant que cr√©ateurs, nous pouvons
tous apporter notre petit morceau de plomb √† l'√©difice typographique avec
quelques petites astuces. Ce sont quelques unes de ces astuces que je vais vous
fournir ici, alors ouvrez bien les mirettes.</p>
<h3 id="ampersand-hacking-je-suis-s√ªr-que-√ßa-ne-sappelle-pas-comme-√ßa"><a href="#ampersand-hacking-je-suis-s%C3%BBr-que-%C3%A7a-ne-sappelle-pas-comme-%C3%A7a" class="phenomic-HeadingAnchor">#</a>Ampersand hacking (je suis s√ªr que √ßa ne s'appelle pas comme √ßa)</h3>
<p>Pas loin d'√™tre l'un des plus connus, il est √©galement l'un des plus simples.</p>
<p>Il consiste simplement √† remplacer un glyphe de votre texte par le glyphe
correspondant √† ce caract√®re depuis une autre typo. Je m'explique.</p>
<p><img src="./csslickbait.png" alt="cliquez pas, s√©rieux"></p>
<pre><code class="hljs language-html"><span class="hljs-tag">&#x3C;<span class="hljs-name">span</span>></span>
  Until the
  <span class="hljs-tag">&#x3C;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"amp"</span>></span>&#x26;amp;<span class="hljs-tag">&#x3C;/<span class="hljs-name">span</span>></span>
  of time
<span class="hljs-tag">&#x3C;/<span class="hljs-name">span</span>></span></code></pre>
<pre><code class="hljs language-css"><span class="hljs-selector-class">.amp</span> {
  <span class="hljs-attribute">font-family</span>: <span class="hljs-string">"Baskerville"</span>;
  <span class="hljs-attribute">font-style</span>: italic;
}</code></pre>
<p>Voil√†, c'est pas bien folichon mais √ßa fonctionne : vous pouvez d√®s √† pr√©sent
enrouler toutes vos esperluettes (si vous √™tes chef de projet, une esperluette
c'est un "et commercial") dans des <code>span</code> pour leur donner une bien chouette
gueule.</p>
<p>Mais √ßa c'est pour les quelques d'entre vous qui ont la main sur le contenu
textuel du projet, beaucoup d'autres n'ont pas ce luxe et se font fournir de
pauvres textes mal traduits servis par un vieux CMS miteux.</p>
<p>Ce serait chouette d'avoir un moyen pour sp√©cifier une typo pour certains
caract√®res au cas par cas, non ?</p>
<p>Bonne nouvelle.</p>
<h3 id="go-go-unicode-range-"><a href="#go-go-unicode-range-" class="phenomic-HeadingAnchor">#</a>Go Go Unicode-Range !</h3>
<p>Reprenons notre exemple pr√©c√©dent, que nous allons impl√©menter avec la feature
<code>unicode-range</code> de CSS.</p>
<pre><code class="hljs language-html"><span class="hljs-tag">&#x3C;<span class="hljs-name">span</span>></span>Until the &#x26;amp; of time<span class="hljs-tag">&#x3C;/<span class="hljs-name">span</span>></span></code></pre>
<pre><code class="hljs language-css">@<span class="hljs-keyword">font-face</span> {
  <span class="hljs-attribute">font-family</span>: BaskervilleAmpersand;
  <span class="hljs-attribute">font-style</span>: italic;
  <span class="hljs-attribute">font-weight</span>: normal;
  <span class="hljs-attribute">src</span>: <span class="hljs-built_in">url</span>(<span class="hljs-string">"path/to/your/font/i'm/not/your/mother/Baskerville.eot"</span>);
  <span class="hljs-attribute">unicode-range</span>: U+<span class="hljs-number">0026</span>; <span class="hljs-comment">/* unicode codepoint for &#x26;amp; */</span>
}

<span class="hljs-selector-tag">html</span> {
  <span class="hljs-attribute">font-family</span>: BaskervilleAmpersand, Helvetica, Arial, Serif;
}</code></pre>
<p>Ainsi, en tirant parti d'<code>unicode-range</code> et du stacking des polices, toutes les
esperluettes dans le corps de texte seront rendues en Baskerville et les autres
caract√®res tomberont en d√©faut sur Helvetica puis Arial, puis Serif en g√©n√©ral.
Bon, ne me faites pas dire ce que je n'ai pas dit, cette propri√©t√© CSS n'est pas
parfaite non plus, rien que le fait de devoir aller chercher les codepoints
unicode pour retrouver le caract√®re √† remplacer est assez lourd et fastidieux
(sauf si vous connaissez unicode par c≈ìur mais l√† vous me faites peur). L'autre
possibilit√© si vous utilisez PostCSS, c'est le plugin
<a href="https://github.com/ben-eb/postcss-unicode-characters"><code>postcss-unicode-characters</code></a>
par <a href="https://github.com/ben-eb">@beneb</a> qui simplifie grandement l'API
d'unicode-range et que je vous invite √† aller voir. Enfin, la bonne nouvelle
c'est que c'est une propri√©t√© relativement bien support√©e, √† partir d'IE9 vous
devriez vous en tirer.</p>
<h3 id="je-suis-sur-ie8"><a href="#je-suis-sur-ie8" class="phenomic-HeadingAnchor">#</a>Je suis sur IE8</h3>
<p>(mes condol√©ances) Une autre solution existe pour vous ! Il faut juste cr√©er sa
propre police et- non s√©rieux revenez c'est pas si horrible, promis. Bon,
reprenons. Pour ce genre de manipulations vous aurez besoin d'un √©diteur de
police, j'aime personnellement beaucoup BirdFont, qui a l'avantage d'√™tre
gratuit et disponible sur macOS, Windows, pas mal de versions de Linux et m√™me
OpenBSD. On entre ici dans la partie tr√®s proc√©duri√®re de cet article mais mieux
vaut √ßa que de vous laisser seuls dans l'interface spartiate de BirdFont.</p>
<p><img src="./birdfont.png"></p>
<p>Spartiate. Bref, le bouton tout en haut √† gauche, c'est le bouton "Nouvelle
police", vous pouvez cliquer dessus pour arriver √† l'√©cran suivant.</p>
<p><img src="./birdfont1.png"></p>
<p>√Ä partir de l√† vous allez devoir choisir un caract√®re √† remplacer. √áa peut √™tre
la lettre E comme √ßa peut √™tre l'emoji Pizza, personnellement j'ai d√©cid√© de
remplacer le symbole dit "paragraphe" ou "Simflouz" si vous avez jou√© aux Sims
(et "Sporeflouz" si vous avez jou√© √† Spore mais passons). Si votre caract√®re est
un peu dur √† trouver dans la liste, l'option de recherche est faite pour √ßa.
Double-cliquer sur un caract√®re vous emm√®nera √† l'interface d'√©dition.</p>
<p><img src="./birdfont3.png"></p>
<p>Nous voici dans l'interface d'√©dition de glyphe proprement dite. Elle ne vous
d√©paysera pas trop si vous avez d√©j√† utilis√© un outil de cr√©ation de SVG.
N'h√©sitez pas √† vous en donner √† c≈ìur joie si vous avez la fibre cr√©atrice,
personnellement comme vous pouvez le voir sur la capture, je suis d√©j√† un
artiste accompli. Le menu hamburger en haut √† droite vous permettra √©galement
d'importer directement un SVG en tant que glyphe si vous n'avez pas la chance de
dessiner aussi bien que moi et que vous pr√©f√©rez d√©l√©guer ce genre de t√¢ches √†
votre designer. Ensuite, depuis le m√™me menu hamburger, vous pourrez exporter
votre typo dans tous les formats que vous voudrez si tant est que vous vouliez
les exporter en TTF, EOT ou SVG.</p>
<p>De l√†, vous n'aurez plus qu'√† importer cette font comme dans le chapitre 2 et
vous pourrez enfin rajouter "typesetter" dans vos comp√©tences sur LinkedIn.</p>
<p>Vous n'avez plus qu'√† trouver les utilisations les plus int√©ressantes de ce
genre de pratiques (il y en a plein).</p>
<p>La bise.</p>
]]></description><link>http://putaindecode.io/fr/articles/css/remplacer-glyphes-font/</link><guid isPermaLink="true">http://putaindecode.io/fr/articles/css/remplacer-glyphes-font/</guid><pubDate>Tue, 10 Jan 2017 00:00:00 GMT</pubDate></item><item><title><![CDATA[Petit tour d'horizon de l'animation sur le web (et ailleurs)]]></title><description><![CDATA[<p>Les animations prennent une grande place dans les interfaces utilisateur. Loin
de n'apporter qu'un c√¥t√© esth√©tique, elles augmentent la performance per√ßue,
am√©liorent notre exp√©rience en nous aidant √† nous rep√©rer et en guidant notre
attention. Sur les applications natives, ces animations sont souvent plus
naturelles que sur le web, et pour cause, beaucoup de leurs animations sont des
<em>springs</em>.</p>
<p>Qu'est-ce qu'une animation <em>spring</em> ? Pour arriver √† le d√©finir, voyons comment
on a l'habitude de cr√©er des animations avec les technologies web.</p>
<p>CSS poss√®de deux propri√©t√©s permettant d'animer des valeurs: les <code>animation</code> et
les <code>transition</code>. Au del√† de la diff√©rence entre leurs capacit√©s au sein de CSS
(propri√©t√© VS ensemble de propri√©t√©s avec des √©tapes), les deux reposent sur le
m√™me m√©canisme. On va donc √©tudier le plus simple: <code>transition</code>.</p>
<pre><code class="hljs language-css"><span class="hljs-selector-class">.block</span> {
  <span class="hljs-attribute">transition</span>: <span class="hljs-number">300ms</span> linear transform;
}

<span class="hljs-selector-class">.block</span><span class="hljs-selector-pseudo">:hover</span> {
  <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">scale</span>(1.05);
}</code></pre>
<p>Cette transition est d√©finie sur un mod√®le simple : on fixe une dur√©e
d'animation (ici <code>300ms</code>) et un easing ‚Äî<em>ou </em>zizine<em> si vous √©coutez <a href="http://putaindecode.io/fr/articles/podcast/1/">le
podcast</a></em>‚Äî qui est une fonction
d'interpolation (ici <code>linear</code>).</p>
<p>L'easing est une fonction toute b√™te comme vous avez pu en voir au coll√®ge et
les avez dessin√©es sur votre calculatrice Casio ou Texas (si comme moi vous
√©tiez le seul p√©quin de la classe √† avoir l'autre mod√®le, √† devoir toujours se
d√©merder parce que les profs savaient pas comment la v√¥tre marchait).</p>
<p>Bref, une fonction d'easing est assez simple. Par exemple, la <code>linear</code> √ßa
revient √† :</p>
<p><img src="./Linear.png"></p>
<pre><code class="hljs language-js"><span class="hljs-keyword">const</span> linear = <span class="hljs-function"><span class="hljs-params">x</span> =></span> x; <span class="hljs-comment">// such complicated</span>
<span class="hljs-comment">// didn't even import `lodash.identity` from npm</span></code></pre>
<p>Le param√®tre <code>x</code> varie entre <code>0</code> et <code>1</code>, c'est la progression de l'animation. Ce
param√®tre vaut <code>0</code> quand vous √™tes au d√©but de l'animation et <code>1</code> √† la fin.</p>
<p>En faisant √† la main une version du syst√®me g√©rant l'animation, √ßa donne quelque
chose dans ce style :</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">const</span> transition = <span class="hljs-function">(<span class="hljs-params">{ duration, easing, onUpdate, startValue, endValue }</span>) =></span> {
  <span class="hljs-keyword">const</span> startDate = <span class="hljs-built_in">Date</span>.now(); <span class="hljs-comment">// le moment o√π commence l'animation</span>
  <span class="hljs-comment">// la fonction tick sera execut√©e p√©riodiquement</span>
  <span class="hljs-keyword">const</span> tick = <span class="hljs-function"><span class="hljs-params">()</span> =></span> {
    <span class="hljs-keyword">const</span> absoluteProgress = (<span class="hljs-built_in">Date</span>.now() - startDate) / duration; <span class="hljs-comment">// on calcule `x`</span>
    <span class="hljs-keyword">const</span> progress = <span class="hljs-built_in">Math</span>.min(absoluteProgress, <span class="hljs-number">1</span>); <span class="hljs-comment">// on fait gaffe de pas d√©border</span>
    <span class="hljs-keyword">const</span> progressWithEasing = easing(progress); <span class="hljs-comment">// on applique la fonction d'easing</span>
    <span class="hljs-comment">// pour calculer la valeur, on diminue progressivement la valeur initiale et l'on accroit la valeur finale</span>
    onUpdate(
      (<span class="hljs-number">1</span> - progressWithEasing) * startValue + progressWithEasing * endValue
    );
    <span class="hljs-keyword">if</span> (progress &#x3C; <span class="hljs-number">1</span>) {
      <span class="hljs-comment">// si c'est pas fini, on repart pour un tour</span>
      requestAnimationFrame(tick);
    }
  };
  tick();
};

myElement.onclick = <span class="hljs-function"><span class="hljs-params">()</span> =></span>
  transition({
    <span class="hljs-attr">duration</span>: <span class="hljs-number">500</span>,
    <span class="hljs-attr">easing</span>: <span class="hljs-function"><span class="hljs-params">x</span> =></span> x,
    <span class="hljs-attr">onUpdate</span>: <span class="hljs-function"><span class="hljs-params">value</span> =></span>
      (myElement.style.transform = <span class="hljs-string">`translateY(<span class="hljs-subst">${value + <span class="hljs-string">"px"</span>}</span>)`</span>),
    <span class="hljs-attr">startValue</span>: <span class="hljs-number">0</span>,
    <span class="hljs-attr">endValue</span>: <span class="hljs-number">200</span>
  });</code></pre>
<p>Pour d√©finir cette fonction d'easing, CSS vous permet √©galement de configurer
des courbes de B√©zier cubiques.</p>
<p>Une courbe de B√©zier cubique se d√©finit avec 4 points : <code>P0</code>, <code>P1</code>, <code>P2</code> et
<code>P3</code>. Il en est ensuite d√©riv√© une courbe √† partir de ces quatre points. C'est
avec ce m√©canisme que fonctionne la plume de la plupart des logiciels d'√©dition
d'image.</p>
<p><img src="./Bezier.png"></p>
<p>Vu que votre animation commence et finit √† des valeurs d√©finies √† l'avance, deux
points sont fix√©s √† l'avance : <code>P0</code> sera toujours <code>(0, 0)</code> et <code>P3</code> <code>(1, 1)</code>.</p>
<p>Vous avez avec CSS la libert√© de d√©finir <code>P1</code> et <code>P2</code> sous la forme
<code>cubic-bezier(P1x, P1y, P2x, P2y)</code>. Pour visualiser le fonctionnement, je vous
conseille de faire un tour sur <a href="http://cubic-bezier.com">cubic-bezier</a> de <a href="https://twitter.com/leaverou">Lea
Verou</a>.</p>
<p>Tout ce que nous avons vu jusque-l√† sont des animations <em>tim√©es</em> (vive les
anglicismes). Leur dur√©e est connue √† l'avance et est immuable, les variations
possibles se feront dans les limites de ces contraintes.</p>
<p>Ces animations sont tr√®s pratiques pour certaines animations basiques et
rempliront tr√®s bien leur mission, mais elles peuvent rapidement avoir des
limites :</p>
<p>Avec CSS :</p>
<ul>
<li>On n'a aucun contr√¥le sur l'ex√©cution de l'animation</li>
<li>Configurer des animations complexes complique la maintenance</li>
</ul>
<p>Avec un easing basique en g√©n√©ral :</p>
<ul>
<li><code>cubic-bezier</code> limite √©norm√©ment les possibilit√©s d'√©volution de la valeur
anim√©e (e.g. on souhaite que l'animation ait de l'√©lasticit√©, les
timing-functions ne permettent de faire qu'un seul d√©bord qui ne parait pas
"naturel").</li>
<li>Avoir des animations coh√©rentes dans toute notre UI est extr√™mement
contraignant avec CSS</li>
</ul>
<p>Pour l'√©lasticit√©, vous pouvez vous d√©brouiller avec <code>@keyframes</code>, hardcoder
toutes les valeurs, les <em>timer</em> √† la main, y passer des heures pour vous
retrouver avec 60 √©tapes dans votre animation et au final de ne pas √™tre
satisfait du r√©sultat, claquer la porte de votre boulot et partir √©lever des
brebis dans les Pyr√©n√©es.</p>
<p>C'est l√† qu'interviennent les <em>springs</em>.</p>
<p>Une animation spring vous expose en g√©n√©ral deux param√®tres : <code>tension</code> et
<code>friction</code> (ou <code>stiffness</code>, pour rigidit√© &#x26; <code>damping</code>, pour amortissement, selon
les syst√®mes). Ce sont des valeurs logiques dans ce contexte, puisqu'elles
viennent des lois de la physique (big up Newton).</p>
<p>Quelques exemples sur les <a href="http://facebook.github.io/rebound-js/examples/">demos de
Rebound.js</a> peuvent vous aider √†
visualiser ce que repr√©sentent ces param√®tres au sein de l'animation.</p>
<p>Afin d'ob√©ir √† des lois "logiques" de la physique, l'animation spring doit
prendre en compte √† chaque <code>tick</code> non seulement la valeur actuelle et celle
d'arriv√©e mais aussi sa rapidit√© actuelle : c'est ce qui lui permet d'encha√Æner
naturellement les animations.</p>
<p>√Ä chaque frame, il va ex√©cuter la fonction suivante pour d√©terminer la <code>value</code>
et <code>velocity</code> √† venir (note : ce c√¥t√© est une simplification du code utilis√© par
<a href="https://github.com/chenglou/react-motion">react-motion</a>).</p>
<pre><code class="hljs language-javascript"><span class="hljs-keyword">const</span> unitOfTime = <span class="hljs-number">1</span> / <span class="hljs-number">60</span>; <span class="hljs-comment">// the number of seconds in a frame</span>
<span class="hljs-keyword">const</span> precision = <span class="hljs-number">0.01</span>;

<span class="hljs-keyword">const</span> step = <span class="hljs-function">(<span class="hljs-params">lastValue, lastVelocity, toValue, stiffness, damping</span>) =></span> {
  <span class="hljs-keyword">const</span> spring = -stiffness * (lastValue - toValue);
  <span class="hljs-keyword">const</span> damper = -damping * lastVelocity;

  <span class="hljs-keyword">const</span> all = spring + damper;
  <span class="hljs-keyword">const</span> nextVelocity = lastVelocity + all * unitOfTime;
  <span class="hljs-keyword">const</span> nextValue = lastValue + nextVelocity * unitOfTime;

  <span class="hljs-keyword">const</span> shouldRest =
    <span class="hljs-built_in">Math</span>.abs(nextVelocity) &#x3C; precision &#x26;&#x26;
    <span class="hljs-built_in">Math</span>.abs(nextValue - toValue) &#x3C; precision;

  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">velocity</span>: shouldRest ? <span class="hljs-number">0</span> : nextVelocity,
    <span class="hljs-attr">value</span>: shouldRest ? toValue : nextValue
  };
};</code></pre>
<p>Ensuite, une simple fonction <code>spring</code> qui reproduit √† peu de choses pr√®s la
m√©canique de notre <code>createTransition</code> vu plus haut :</p>
<pre><code class="hljs language-javascript"><span class="hljs-keyword">const</span> spring = ({
  stiffness = <span class="hljs-number">180</span>,
  damping = <span class="hljs-number">12</span>,
  onRest = <span class="hljs-function"><span class="hljs-params">()</span> =></span> {},
  toValue
}) => <span class="hljs-function"><span class="hljs-params">onUpdate</span> =></span> {
  <span class="hljs-keyword">let</span> frame;
  <span class="hljs-keyword">const</span> tick = <span class="hljs-function"><span class="hljs-params">curr</span> =></span> {
    <span class="hljs-comment">// on calcule l'√©tat</span>
    <span class="hljs-keyword">const</span> { velocity, value } = step(
      curr.value,
      curr.velocity,
      toValue,
      stiffness,
      damping
    );
    onUpdate({ velocity, value });
    <span class="hljs-comment">// si l'animation n'est pas termin√©e</span>
    <span class="hljs-keyword">if</span> (velocity !== <span class="hljs-number">0</span> || value !== toValue) {
      <span class="hljs-comment">// on programme la prochaine frame</span>
      frame = requestAnimationFrame(<span class="hljs-function"><span class="hljs-params">()</span> =></span> tick({ value, velocity }));
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-comment">// sinon on pr√©vient que l'animation est au repos</span>
      onRest();
    }
  };
  <span class="hljs-keyword">return</span> {
    <span class="hljs-comment">// afin de permettre aux animations de s'encha√Æner, la fonction `start` prend l'√©tat actuel de la valeur</span>
    start: <span class="hljs-function"><span class="hljs-params">value</span> =></span> {
      frame = requestAnimationFrame(<span class="hljs-function"><span class="hljs-params">()</span> =></span> tick(value));
    },
    <span class="hljs-attr">stop</span>: <span class="hljs-function"><span class="hljs-params">()</span> =></span> {
      cancelAnimationFrame(frame);
    }
  };
};</code></pre>
<p>Il nous reste √† cr√©er une classe "observable" <code>Value</code> qui conserve l'√©tat et
l'animation active. Cela permet de stopper l'animation en cours avant de lancer
la suivante lorsque cela arrive.</p>
<pre><code class="hljs language-js"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Value</span> </span>{
  <span class="hljs-keyword">constructor</span>(initialValue) {
    <span class="hljs-keyword">this</span>.value = {
      <span class="hljs-attr">value</span>: initialValue,
      <span class="hljs-attr">velocity</span>: <span class="hljs-number">0</span>
    };
    <span class="hljs-keyword">this</span>.listeners = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Set</span>();
    <span class="hljs-keyword">this</span>.animation = <span class="hljs-literal">null</span>;
  }
  addListener(listener) {
    <span class="hljs-keyword">this</span>.listeners.add(listener);
    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =></span> {
      <span class="hljs-keyword">this</span>.listeners.delete(listener);
    };
  }
  updateValue(nextValue) {
    <span class="hljs-keyword">this</span>.value = nextValue;
    <span class="hljs-keyword">this</span>.listeners.forEach(<span class="hljs-function"><span class="hljs-params">listener</span> =></span> listener(<span class="hljs-keyword">this</span>.value.value));
  }
  animate(animation) {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.animation) {
      <span class="hljs-keyword">this</span>.animation.stop();
    }
    <span class="hljs-keyword">this</span>.animation = animation(<span class="hljs-function"><span class="hljs-params">v</span> =></span> <span class="hljs-keyword">this</span>.updateValue(v));
    <span class="hljs-keyword">this</span>.animation.start(<span class="hljs-keyword">this</span>.value);
  }
}</code></pre>
<p>Et voil√†, vous avez une animation :</p>
<pre><code class="hljs language-javascript"><span class="hljs-keyword">const</span> scale = <span class="hljs-keyword">new</span> Value(<span class="hljs-number">1</span>);

scale.addListener(<span class="hljs-function"><span class="hljs-params">value</span> =></span> (myElement.style.transform = <span class="hljs-string">`scale(<span class="hljs-subst">${value}</span>)`</span>));

myElement.onmousedown = <span class="hljs-function"><span class="hljs-params">()</span> =></span> {
  scale.animate(spring({ <span class="hljs-attr">toValue</span>: <span class="hljs-number">2</span> }));
};

myElement.onmouseup = <span class="hljs-function"><span class="hljs-params">()</span> =></span> {
  scale.animate(spring({ <span class="hljs-attr">toValue</span>: <span class="hljs-number">1</span> }));
};</code></pre>
<iframe width="100%" height="300" src="//jsfiddle.net/bloodyowl/36d0nc7r/embedded/" allowfullscreen="allowfullscreen" frameborder="0"></iframe>
<p>Les animations spring ont de nombreux avantages. Elles vous permettent
d'utiliser un vocabulaire coh√©rent avec celui du mouvement. Elles vous
permettent aussi de g√©rer de mani√®re intelligente le timing de vos animations :
plus besoin de <em>hardcoder</em> le temps qu'elles doivent mettre ; seule la
description du mouvement compte. Aussi, vous n'avez plus √† vous soucier des
changements de valeurs et de ses cons√©quences sur la coh√©rence globale d'une
animation : le syst√®me les g√®re et s'adapte.</p>
<p>Il existe plusieurs solutions pour les g√©rer :</p>
<ul>
<li>JS: <a href="http://facebook.github.io/rebound-js/examples/">Rebound.js</a></li>
<li>JS sp√©cifique React: <a href="https://github.com/chenglou/react-motion">react-motion</a></li>
<li>JS sp√©cifique React, utilis√© par react-native:
<a href="https://github.com/animatedjs/animated">Animated</a></li>
<li>Java (Android): <a href="http://facebook.github.io/rebound/">Rebound</a></li>
<li>Objective-C/Swift (iOS): <a href="https://github.com/facebook/pop">Pop</a></li>
</ul>
<p>La team WebKit <a href="https://twitter.com/webkit/status/748573524734812161">a √©galement
propos√©</a> l'ajout d'une
fonction <code>spring</code> √† CSS mais la discussion stagne (√† tester dans Safari
Technology Preview).</p>
<p>En esp√©rant que √ßa vous donne des id√©es d'animations cool √† faire.</p>
<p>Bisous bisous.</p>
]]></description><link>http://putaindecode.io/fr/articles/css/animations/</link><guid isPermaLink="true">http://putaindecode.io/fr/articles/css/animations/</guid><pubDate>Tue, 20 Dec 2016 00:00:00 GMT</pubDate></item><item><title><![CDATA[On lance un podcast]]></title><description><![CDATA[<p>√áa fait quelques mois qu'on en parle au sein de l'√©quipe de contributeurs, et
c'est un projet qui a mis du temps √† se d√©velopper mais le voil√† enfin.</p>
<p>On a pass√© pas mal de temps √† pr√©parer le format, √† se motiver √† le faire et √†
acheter le mat√©riel.</p>
<p>Ce premier √©pisode est encore un peu maladroit (on apprend sur le tas) mais on a
bon espoir de l'am√©liorer avec le temps.</p>
<p>Cet √©pisode 1 est intitul√© ‚Ä¶</p>
<h2 id="en-beta-emb√™tant"><a href="#en-beta-emb%C3%AAtant" class="phenomic-HeadingAnchor">#</a><em>En beta, emb√™tant</em></h2>
<p>Y participent :</p>
<ul>
<li>Maxime alias <a href="https://twitter.com/MoOx">MoOx</a></li>
<li>Mathieu alias <a href="https://twitter.com/Zoontek">Zoontek</a></li>
<li>Georges alias <a href="https://twitter.com/skinnyfoetusboy">skinnyfoetusboy</a></li>
<li>Matthias alias <a href="https://twitter.com/bloodyowl">bloodyowl</a></li>
</ul>
<p>et on vous y parle de :</p>
<ul>
<li>Yarn, le client NPM</li>
<li>Webpack 2</li>
<li>dotCSS, un retour sur chaque conf√©rence</li>
<li>Sketch 41</li>
<li>Origami Studio</li>
</ul>
<p>√âvidemment on digresse SANS ARR√äT, √ßa manque de structure et le son a quelques
soucis, on vous demande d'√™tre indulgents l√†-dessus : faut bien commencer
quelque part üò∂</p>
<p>Faites-nous part de vos retours pour qu'on puisse am√©liorer ce podcast √† chaque
√©pisode.</p>
<p>On esp√®re que √ßa vous plaira !</p>
<p>Bisous.</p>
<iframe width="100%" height="300" scrolling="no" frameborder="no" src="https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/297382854&amp;auto_play=false&amp;hide_related=false&amp;show_comments=true&amp;show_user=true&amp;show_reposts=false&amp;visual=true"></iframe>
<h3 id="edit"><a href="#edit" class="phenomic-HeadingAnchor">#</a>Edit:</h3>
<ul>
<li>Le
<a href="http://feeds.soundcloud.com/users/soundcloud:users:273901232/sounds.rss">RSS</a></li>
<li>Sur iTunes : <a href="https://itunes.apple.com/fr/podcast/putain-de-code-!/id1185311825?l=en&#x26;mt=2">Putain de
Code</a></li>
</ul>
]]></description><link>http://putaindecode.io/fr/articles/podcast/1/</link><guid isPermaLink="true">http://putaindecode.io/fr/articles/podcast/1/</guid><pubDate>Mon, 12 Dec 2016 00:00:00 GMT</pubDate></item><item><title><![CDATA[2 ans avec React, Babel, Webpack et cie]]></title><description><![CDATA[<p>Depuis fin 2014, et un virage radical vers l'√©cosyst√®me React, j'ai eu
l'occasion de mener plusieurs projets (applis pros, mobiles/hybrides, sites
web...) sur cette stack : React, Webpack, Babel, npm...</p>
<p>Ces deux ann√©es ont √©t√© tr√®s prolifiques dans la communaut√© JavaScript et React,
le tooling est encore parfois exotique, mais il se stabilise et de gros progr√®s
ont √©t√© faits sur la documentation.</p>
<p><strong>Nous disposons maintenant d'un √©cosyst√®me incroyablement riche et dynamique,
et d'un paradigme "universel" pour construire les applications de demain, web ou
natives.</strong></p>
<p>React est la biblioth√®que de facto pour ce type d'applications, mais on peut le
remplacer assez facilement par une alternative comme
<a href="https://preactjs.com/">Preact</a> ou <a href="http://infernojs.org/">Inferno</a>, donc toutes
les connaissances acquises sur cette biblioth√®que <strong>et son √©cosyst√®me</strong> sont
exploitables ailleurs dans la communaut√© JavaScript.</p>
<p>Voici un petit recap de cette stack magique :)</p>
<h2 id="tldr"><a href="#tldr" class="phenomic-HeadingAnchor">#</a>TL;DR;</h2>
<p>React en lui-m√™me est le plus simple √† appr√©hender dans cette stack.</p>
<p>Son √©cosyst√®me, riche et √©volutif, l'est moins.</p>
<h2 id="babeles2015"><a href="#babeles2015" class="phenomic-HeadingAnchor">#</a>Babel/ES2015</h2>
<p><img src="/assets/babel.png"></p>
<h3 id="use-next-generation-javascript-today"><a href="#use-next-generation-javascript-today" class="phenomic-HeadingAnchor">#</a>Use next generation JavaScript, today.</h3>
<p>La communaut√© JavaScript a massivement adopt√© le transpileur Babel, qui permet
de coder en JavaScript version ES2015 ou sup√©rieure puis de convertir en code
compatible avec les navigateurs du march√©.</p>
<p>Pour apprendre ES2015 et plus :</p>
<ul>
<li><a href="http://putaindecode.io/fr/tag/ES6">articles sur putaindecode.io</a></li>
<li>exercices en ligne : <a href="http://es6katas.org">es6katas.org</a></li>
<li>tutorial Babel : <a href="http://babeljs.io/docs/learn-es2015">babeljs.io</a></li>
<li>comparaisons ES5/ES2015 :
<a href="http://es6-features.org/#BlockScopedVariables">es6-features.org</a></li>
</ul>
<p>Vous pouvez tr√®s bien faire de l'ES2015 sans Babel, puisque <a href="https://kangax.github.io/compat-table/es6/">les navigateurs
modernes en supportent une grande
partie</a>, mais le support est in√©gal,
d'o√π l'id√©e d'utiliser un transpileur comme Babel qui convertit en ES5.</p>
<p>Le format JSX, est devenu un standard qui peut simplifier le d√©veloppement :</p>
<ul>
<li>il permet de centraliser la pr√©sentation et la logique d'un composant au m√™me
endroit</li>
<li>d'utiliser une syntaxe XML-like plus rigoureuse, mais b√©n√©fique</li>
<li>d'utiliser du JavaScript pur au lieu d'un pseudo-langage comme on trouve dans
les moteurs de template habituels</li>
</ul>
<p>√áa peut para√Ætre d√©routant au d√©but mais √ßa rentre vite !</p>
<p>Plus d'infos sur JSX dans <a href="https://facebook.github.io/react/docs/introducing-jsx.html">Introducing
JSX</a> sur la doc
React.</p>
<h2 id="npm"><a href="#npm" class="phenomic-HeadingAnchor">#</a>npm</h2>
<p><img src="/assets/npm.png"></p>
<p>Quel que soit votre besoin, il y a s√ªrement d√©j√† un module npm pour √ßa :)</p>
<p>Pour bien choisir vos packages, regardez l'activit√© du projet sur GitHub
(commits, issues, tests, contributeurs...)</p>
<h3 id="moins-de-code-cest-moins-de-bugs"><a href="#moins-de-code-cest-moins-de-bugs" class="phenomic-HeadingAnchor">#</a>Moins de code c'est moins de bugs</h3>
<p>Votre appli doit utiliser un maximum de code externe, qui est d√©j√† valid√©,
test√©... s√©par√©ment. Publiez un maximum de modules ind√©pendants, en open source
si possible, et utilisables hors-contexte (<a href="https://addyosmani.com/first/">FIRST
principle</a>).</p>
<p>Ceci implique de suivre les corrections/√©volutions des dits modules et
d'utiliser le <a href="https://docs.npmjs.com/getting-started/semantic-versioning">semantic
versioning</a> √† bon
escient.</p>
<p>NB: Dans sa lanc√©e open-source, Facebook vient de publier une alternative au CLI
npm : <a href="http://yarnpkg.org">yarn</a> plus rapide, fiable et s√©curis√©.</p>
<h2 id="webpack"><a href="#webpack" class="phenomic-HeadingAnchor">#</a>Webpack</h2>
<p><img src="/assets/webpack.png"></p>
<h3 id="le-saviez-vous-"><a href="#le-saviez-vous-" class="phenomic-HeadingAnchor">#</a>Le saviez-vous ?</h3>
<p>Webpack a co√ªt√© aux devs <strong>2.312.533 heures</strong> en 2015. Par jour.</p>
<h3 id="un-grand-pouvoir-implique-de-grandes-responsabilit√©s"><a href="#un-grand-pouvoir-implique-de-grandes-responsabilit%C3%A9s" class="phenomic-HeadingAnchor">#</a>Un grand pouvoir implique de grandes responsabilit√©s</h3>
<p>Webpack est puissant, il remplace browserify ou vos multiples t√¢ches grunt,
gulp, blurp... qui g√©raient votre pipeline d'assets.</p>
<p>√Ä partir du point d'entr√©e de votre application uniquement, par exemple
<code>index.js</code>, il est capable de servir et bundler toutes les d√©pendances (code,
images, CSS...) de votre projet automatiquement, gr√¢ce aux nombreux
<a href="https://webpack.github.io/docs/loaders.html">loaders</a>.</p>
<p>Pour cela, les assets doivent √™tre correctement d√©clar√©s dans le code :</p>
<pre><code class="hljs language-js"><span class="hljs-comment">// require some CSS</span>
<span class="hljs-keyword">import</span> styles <span class="hljs-keyword">from</span> <span class="hljs-string">"./styles.css"</span>;
<span class="hljs-keyword">const</span> ex1 = <span class="xml"><span class="hljs-tag">&#x3C;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">{styles.title}</span>></span>title<span class="hljs-tag">&#x3C;/<span class="hljs-name">div</span>></span></span>;

<span class="hljs-comment">// require an image</span>
<span class="hljs-keyword">import</span> logo <span class="hljs-keyword">from</span> <span class="hljs-string">"./logo.png"</span>;
<span class="hljs-keyword">const</span> img = <span class="xml"><span class="hljs-tag">&#x3C;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">{logo}</span> /></span>;</span></code></pre>
<p>Et la c√©l√®bre <a href="https://webpack.js.org/configuration/">config de webpack</a> permet
de tuner votre build √† tous les niveaux.</p>
<p>Plus de d√©tails sur Webpack sur <a href="http://putaindecode.io/fr/tag/webpack">les articles Putain de code !
d√©di√©s</a>.</p>
<h2 id="css"><a href="#css" class="phenomic-HeadingAnchor">#</a>CSS</h2>
<p><img src="/assets/css-modules.png"></p>
<h3 id="le-saviez-vous--1"><a href="#le-saviez-vous--1" class="phenomic-HeadingAnchor">#</a>Le saviez-vous ?</h3>
<p>Le CSS est un sport de haut niveau.</p>
<h3 id="css-in-2016"><a href="#css-in-2016" class="phenomic-HeadingAnchor">#</a>CSS in 2016</h3>
<p>Selon la complexit√© de vos designs, le CSS peut √™tre ce qui prend le plus de
temps, entre l'int√©gration, le responsive, et les animations.</p>
<p>Et la qualit√© et la modularit√© du CSS est essentielle pour la maintenabilit√© des
applications.</p>
<p>Pour cr√©er des composants r√©utilisables nous pouvons maintenant utiliser les
<a href="https://github.com/css-modules/css-modules">CSS modules</a>, qui ont l'avantage
d'√™tre du CSS classique, mais d'√™tre scop√©s aux composants, et, accessibles
depuis le JavaScript (plus de CSS global). Et le <a href="https://youtu.be/WyFGfMFjfH4?t=26m23s">CSS in
JS</a> peut compl√©ter/remplacer si besoin
pour les cas les plus dynamiques.</p>
<p>A d√©faut, vous pouvez toujours utiliser du CSS global si vous respectez
scrupuleusement les <a href="http://putaindecode.io/fr/articles/css/bem/">conventions
BEM</a>. D√©couvrez d'autres <a href="http://putaindecode.io/fr/tag/css">articles
d√©di√©s au CSS sur putaindecode.io</a>.</p>
<p>Il existe plusieurs biblioth√®ques de composants UI assez fournies pour React :</p>
<ul>
<li><a href="http://jxnblk.com/rebass/">rebass</a></li>
<li><a href="http://ant.design">ant.design</a></li>
<li><a href="http://semantic-ui.com">semantic-ui</a></li>
<li><a href="http://react-toolbox.com/">react-toolbox</a></li>
<li><a href="http://blueprintjs.com">blueprintjs</a></li>
</ul>
<p>Et voici un article recensant des <a href="http://davidwells.io/19-open-source-react-component-libraries-to-use-in-your-next-project/">librairies de composants React
open-source</a>.</p>
<h2 id="react--learn-once-run-everywhere"><a href="#react--learn-once-run-everywhere" class="phenomic-HeadingAnchor">#</a>React : Learn once, run everywhere</h2>
<p><img src="/assets/react.png"></p>
<p>Plus qu'une biblioth√®que ou un framework, React est un paradigme de
programmation d'interfaces utilisateurs, qui permet d'adresser de nombreuses
plateformes, avec toujours du code React "standard".</p>
<p>Th√©oriquement, une application cod√©e en React est capable de produire n'importe
quel output, par exemple du HTML pour le web, du natif avec
<a href="https://facebook.github.io/react-native/">react-native</a>, du
<a href="https://github.com/ProjectSeptemberInc/gl-react">WebGL</a>, du
<a href="https://github.com/Yomguithereal/react-blessed">terminal</a>, de la
<a href="https://github.com/FormidableLabs/react-music">musique</a>...</p>
<p>Et pour toutes ces targets, une convention g√©n√©rale s'applique :</p>
<pre><code style="font-size:2em">ui = f(state)</pre></code>
<p>√Ä tout moment, √† partir un <code>state</code> donn√©, une application ou un composant React
est capable de se "render" correctement dans l'√©tat d√©sir√©.</p>
<p>Le fonctionnement interne est donc plut√¥t straightforward, les composants se
passent simplement des <code>props</code> (valeurs et callbacks) de parent √† enfant, et
certains composants peuvent avoir un <code>state</code> local qui, une fois modifi√©,
d√©clenchera un re-render du composant et de ses descendants.</p>
<p>Les composants doivent √™tre simples, focus, composables.</p>
<pre><code class="hljs language-js">&#x3C;Toolbar>
  <span class="xml"><span class="hljs-tag">&#x3C;<span class="hljs-name">Icon</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"success"</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{onClickSuccess}</span> /></span>
  </span>&#x3C;Menu>
    &#x3C;Icon name="warning" onClick={onClickWarning} />
    &#x3C;Icon name="error" onClick={onClickError} />
  &#x3C;/Menu>
&#x3C;/Toolbar>;</code></pre>
<p>Au niveau performances, React ne fait pas de miracles malgr√© le
<a href="http://reactkungfu.com/2015/10/the-difference-between-virtual-dom-and-dom/">virtual-dom</a>;</p>
<p>√Ä chaque fois qu'un composant re√ßoit de nouvelles props ou modifie son state,
React appelle la m√©thode <code>render</code> de ce dernier ainsi que de ces descendants.
M√™me s'il ne modifie pas le DOM, le fait de comparer les deux arbres retourn√©s
par render peut s'av√©rer co√ªteux si votre composant pr√©sente beaucoup de
contenu. Heureusement, React permet aux d√©veloppeurs d'intervenir avant le
render et l'annuler s'il n'est pas n√©cessaire avec <code>shouldComponentUpdate</code>.</p>
<p>Plus d'<a href="http://putaindecode.io/fr/tag/react">articles sur React sur putain de
code</a></p>
<h2 id="redux"><a href="#redux" class="phenomic-HeadingAnchor">#</a>Redux</h2>
<p><a href="https://css-tricks.com/learning-react-redux/"><img src="react-redux-csstricks.png" alt="React standard VS redux architecture (from
css-tricks.com)"></a></p>
<p>Pour les applications plus complexes, <a href="http://reduxjs.org">redux</a> va g√®rer
l'√©tat de l'application de mani√®re globale et externe aux composants,
standardiser les √©v√®nements (actions), g√©rer les re-renders, et permettre
d'aller vers des <a href="https://github.com/markerikson/redux-ecosystem-links">interactions plus
avanc√©es</a>.</p>
<p>Id√©alement, <a href="https://medium.com/@dan_abramov/smart-and-dumb-components-7ca2f9a7c7d0#.j9rp2pr98">tous vos composants sont
dumbs</a>
et votre gestionnaire de state (par exemple redux) va g√©rer l'intelligence de
l'application et les re-renders de mani√®re d√©coupl√©e et optimis√©e.</p>
<p>Plus d'articles sur redux sur Putain de code ! :
<a href="http://putaindecode.io/fr/tag/redux/">http://putaindecode.io/fr/tag/redux/</a></p>
<h2 id="tips"><a href="#tips" class="phenomic-HeadingAnchor">#</a>Tips</h2>
<h3 id="storybook"><a href="#storybook" class="phenomic-HeadingAnchor">#</a>Storybook</h3>
<p>Utiliser un outil comme
<a href="https://github.com/storybooks/react-storybook">storybook</a> permet de travailler
sur les composants hors-contexte, de pouvoir les visualiser dans diff√©rents
√©tats pendant que vous travaillez... et ainsi d'avoir une base saine de
composants r√©utilisables.</p>
<p>Votre biblioth√®que de composants peut m√™me √™tre un projet √† part, que vous
importerez dans vos diff√©rentes applications. Par exemple, Cloudflare publie
s√©par√©ment <a href="https://github.com/cloudflare/cf-ui">tous ses composants UI
r√©utilisables</a>.</p>
<h3 id="composition"><a href="#composition" class="phenomic-HeadingAnchor">#</a>Composition</h3>
<p>Utilisez au maximum la composition de composants React pour garder des
composants simples et r√©utilisables.</p>
<p>Plus de d√©tails sur le <a href="http://putaindecode.io/fr/articles/js/react/higher-order-component">pattern "higher order
components"</a></p>
<h3 id="nvm"><a href="#nvm" class="phenomic-HeadingAnchor">#</a>nvm</h3>
<p>Utilisez <a href="https://github.com/creationix/nvm">Node Version Manager</a> aka nvm qui
permet de g√©rer plusieurs environnements Node.js sur une m√™me machine.
Indispensable pour travailler sur plusieurs projets.</p>
<h3 id="learning-curve"><a href="#learning-curve" class="phenomic-HeadingAnchor">#</a>Learning curve</h3>
<p>Concentrez-vous sur une techno/outil √† la fois et n'utilisez pas ce dont vous
n'avez pas encore besoin.</p>
<blockquote>
<p>Make it work, make it right, make it fast.</p>
</blockquote>
<h2 id="comment-d√©marrer-"><a href="#comment-d%C3%A9marrer-" class="phenomic-HeadingAnchor">#</a>Comment d√©marrer ?</h2>
<p>Pour cr√©er une application, le plus simple est d'utiliser
<a href="https://github.com/facebookincubator/create-react-app">create-react-app</a>.</p>
<p>Si c'est pour cr√©er un composant React que vous allez publier, alors
<a href="https://github.com/insin/nwb">nwb</a> est plus adapt√©.</p>
<p>Pour cr√©er un site web comme <a href="http://putaindecode.io">putaindecode.io</a> vous
pouvez utiliser un g√©n√©rateur de site statique comme
<a href="http://phenomic.io">phenomic.io</a>.</p>
<h2 id="pourquoi-cest-si-complexe-"><a href="#pourquoi-cest-si-complexe-" class="phenomic-HeadingAnchor">#</a>Pourquoi c'est si complexe ?</h2>
<p>Cette stack, qui peut para√Ætre lourde en outillage, permet de cr√©er des apps
riches, performantes, testables, √©volutives, multi-plateformes.</p>
<p>Une fois l'outillage en place et assimil√©, la productivit√© est excellente
(ES2015, npm, tests, developer experience, dev/build/deploy...).</p>
<p>Dans la plupart des cas, les boilerplates cit√©s ci-dessus vous fournissent tout
le n√©cessaire.</p>
<h2 id="must-read-and-watch"><a href="#must-read-and-watch" class="phenomic-HeadingAnchor">#</a>Must read and watch</h2>
<ul>
<li><a href="https://facebook.github.io/react/tutorial/tutorial.html">Intro to React</a></li>
<li>Free videos
<a href="https://egghead.io/courses/react-fundamentals">egghead.io/react-fundamentals</a></li>
<li>Free videos
<a href="https://egghead.io/courses/getting-started-with-redux">egghead.io/getting-started-with-redux</a></li>
<li><a href="https://medium.com/@dan_abramov/you-might-not-need-redux-be46360cf367#.8swndjba2">You might not need
redux</a></li>
<li><a href="https://medium.com/@dan_abramov/smart-and-dumb-components-7ca2f9a7c7d0#.v583rvea1">Smart VS dumb
components</a></li>
<li><a href="http://putaindecode.io/fr/articles/js/react/higher-order-component/">Les patterns Provider &#x26; Higher-Order Component avec
React</a></li>
<li><a href="https://medium.com/@franleplant/react-higher-order-components-in-depth-cf9032ee6c3e#.t74wxicu0">React higher components in
depth</a></li>
</ul>
<h2 id="liens"><a href="#liens" class="phenomic-HeadingAnchor">#</a>Liens</h2>
<blockquote>
<p>Quelques p√©pites</p>
</blockquote>
<ul>
<li><a href="https://github.com/facebookincubator/create-react-app">create-react-app</a> :
CLI complet pour faire une application react</li>
<li><a href="https://github.com/insin/nwb">nwb</a> : CLI complet faire un composant react
(dev,build,demo,tests,npm...)</li>
<li><a href="https://github.com/andreypopp/react-css-components">react-css-components</a> :
cr√©er des composants React √† partir de CSS</li>
<li><a href="https://github.com/markerikson/redux-ecosystem-links">redux-ecosystem-links</a></li>
<li><a href="https://docs.npmjs.com/misc/scripts">npm scripts docs</a></li>
<li><a href="https://github.com/ngokevin/aframe-react">aframe-react</a> : Build VR
experiences with A-Frame and React</li>
<li><a href="http://reactpatterns.com">reactpatterns.com</a> : quelques patterns react</li>
<li><a href="http://phenomic.io">phenomic.io</a> : react-based static site generator</li>
<li><a href="http://jsbooks.revolunet.com">jsbooks.revolunet.com</a> : free JavaScript ebooks</li>
</ul>
]]></description><link>http://putaindecode.io/fr/articles/frontend/2016-2-ans-avec-react-babel-webpack-et-cie/</link><guid isPermaLink="true">http://putaindecode.io/fr/articles/frontend/2016-2-ans-avec-react-babel-webpack-et-cie/</guid><pubDate>Thu, 01 Dec 2016 00:00:00 GMT</pubDate></item><item><title><![CDATA[Votre premi√®re app React Native]]></title><description><![CDATA[<p>Cela fait d√©j√† plus d'un an que Facebook a publi√© la premi√®re version de React
Native. Longtemps consid√©r√© comme une exp√©rimentation sympathique (apr√®s tout,
il est n√© lors d'un hackathon), un cycle de release soutenu d'une version
majeure toutes les 2 semaines a fait qu'aujourd'hui l'√©cosyst√®me est
suffisamment riche et stable pour d√©ployer une app iOS et Android en production.</p>
<h2 id="quels-probl√®mes-avec-les-solutions-hybrides-"><a href="#quels-probl%C3%A8mes-avec-les-solutions-hybrides-" class="phenomic-HeadingAnchor">#</a>Quels probl√®mes avec les solutions hybrides ?</h2>
<p>Des solutions pour d√©velopper une application mobile multiplateforme en JS
existent d√©j√† : je pense notamment √† <a href="https://cordova.apache.org/">Cordova</a> ou √†
son superset <a href="http://ionicframework.com/">Ionic</a>. Con√ßu autour d'une webview
syst√®me (un navigateur embedded - Safari sur iOS, Chrome sur Android) affich√©e
en plein √©cran, vous utilisez des technologies web classiques : HTML, CSS et JS.
Il est possible d'installer des plugins afin d'enrichir le moteur JavaScript
avec de nouvelles APIs en plus des APIs navigateur. Ainsi,
<code>cordova-plugin-contacts</code> permet d'acc√©der au carnet d'adresses du smartphone,
<code>cordova-plugin-vibration</code> permet de faire vibrer celui-ci, etc.</p>
<p>Le probl√®me, c'est que si l'utilisation de plugins permet de faire le pont avec
le code natif (un message est envoy√© de la partie JS √† la partie Objective-C /
Java, qui l'ex√©cute de son c√¥t√© et renvoie le r√©sultat au JS), l'UI de
l'application n'utilise elle pas du tout le layout natif des OS mobiles. Les
performances et le look'n'feel de celle-ci seront donc √©quivalente √† une app
web, et non une app mobile.</p>
<p>Avec React Native, point de navigateur embedded, de HTML ou de CSS : vous devez
composer vos interfaces √† l'aide de composants React qui font appel au layout
natif de la plateforme. Un exemple simple : <code>&#x3C;View></code> (qui est l'√©quivalent d'une
<code>&#x3C;div></code> HTML) communique via un pont JS &#x3C;-> Objective-C / Java pour contr√¥ler
une UIView (sur iOS) ou une android.view. Les performances de l'UI sont donc
quasi similaires aux performances natives.</p>
<h2 id="d√©couverte-de-lenvironnement-de-dev"><a href="#d%C3%A9couverte-de-lenvironnement-de-dev" class="phenomic-HeadingAnchor">#</a>D√©couverte de l'environnement de dev</h2>
<p>Fatigu√©s par JavaScript et son tooling un peu trop fourni ? Rassurez-vous : vous
n'avez strictement rien √† configurer pour commencer √† utiliser React Native.
Vous disposez out-of-the-box d'un packager Babel et d'un <a href="https://github.com/facebook/react-native/tree/master/babel-preset">preset
custom</a> qui
int√®gre les fonctionnalit√©s de ES2015, mais √©galement le support de React / JSX
(encore heureux), de <a href="https://flowtype.org/">Flow</a> et d'autres helpers bienvenus
tels que <code>async / await</code>.</p>
<p>En bons passionn√©s de bi√®re, nous allons r√©aliser ensemble une app qui requ√™te
la <a href="https://punkapi.com/">PunkAPI</a> (faites la demande d'une cl√© API via le
formulaire pr√©vu √† cet effet).</p>
<p>Je vous renvoie √† la <a href="https://facebook.github.io/react-native/docs/getting-started.html">documentation
officielle</a>
pour ce qui est de l'installation des d√©pendances (celles-ci variant selon votre
OS et l'OS cible). Xcode / Android Studio, node et watchman √©tant install√©s,
ouvrez un terminal et initiez le projet :</p>
<pre><code>npm install -g react-native-cli
react-native init PutainDeBiere
</code></pre>
<p>Une fois le projet initialis√©, le CLI vous informe de la fa√ßon dont lancer votre
application : faites-le dans la foul√©e. En ce qui me concerne, je d√©veloppe pour
iOS.</p>
<pre><code class="hljs language-bash">react-native run-ios</code></pre>
<p>Selon votre plateforme cible, ouvrez <code>index.ios.js</code> ou <code>index.android.js</code> dans
votre √©diteur pr√©f√©r√©. Modifiez quelque peu le texte et rafraichissez votre app
via <code>Command‚åò + R</code>, deux pressions sur la touche <code>R</code> (√©mulateur Android).</p>
<pre><code class="hljs language-javascript"><span class="hljs-comment">/* @flow */</span>

<span class="hljs-keyword">import</span> React, { Component } <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>;
<span class="hljs-keyword">import</span> { AppRegistry, StyleSheet, Text, View } <span class="hljs-keyword">from</span> <span class="hljs-string">"react-native"</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">App</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Component</span> </span>{
  render() {
    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&#x3C;<span class="hljs-name">View</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{styles.container}</span>></span>
        </span>&#x3C;Text style={styles.welcome}>Welcome to PutainDeBiere!&#x3C;/Text><span class="xml">
      <span class="hljs-tag">&#x3C;/<span class="hljs-name">View</span>></span></span>
    );
  }
}

<span class="hljs-keyword">const</span> styles = StyleSheet.create({
  <span class="hljs-attr">container</span>: {
    <span class="hljs-attr">flex</span>: <span class="hljs-number">1</span>,
    <span class="hljs-attr">justifyContent</span>: <span class="hljs-string">"center"</span>,
    <span class="hljs-attr">alignItems</span>: <span class="hljs-string">"center"</span>,
    <span class="hljs-attr">backgroundColor</span>: <span class="hljs-string">"#F5FCFF"</span>
  },
  <span class="hljs-attr">welcome</span>: {
    <span class="hljs-attr">fontSize</span>: <span class="hljs-number">20</span>,
    <span class="hljs-attr">textAlign</span>: <span class="hljs-string">"center"</span>,
    <span class="hljs-attr">margin</span>: <span class="hljs-number">10</span>
  }
});

AppRegistry.registerComponent(<span class="hljs-string">"PutainDeBiere"</span>, () => App);</code></pre>
<figure>
  <img src="welcome.png" alt="welcome PutainDeBiere preview" />
  <figcaption>Une bien jolie premi√®re √©tape</figcaption>
</figure>
<h2 id="r√©cup√©ration-des-donn√©es"><a href="#r%C3%A9cup%C3%A9ration-des-donn%C3%A9es" class="phenomic-HeadingAnchor">#</a>R√©cup√©ration des donn√©es</h2>
<p>Afin de requ√™ter notre API, React Native nous offre plusieurs plusieurs
solutions: <code>fetch()</code> ou <code>XMLHttpRequest</code>. Tenez vous en <strong>uniquement</strong> √†
l'utilisation de la premi√®re, la deuxi√®me n'√©tant pr√©sente que pour assurer une
compatibilit√© avec des librairies tierces.</p>
<p><em>/!\ Notre cl√© API doit √™tre encod√©e en base64. La function <code>btoa()</code> n'√©tant pas
disponible en React Native, il est n√©cessaire d'installer une d√©pendance.</em></p>
<pre><code class="hljs language-bash">npm install --save base-64</code></pre>
<p>Histoire de s√©parer notre logique API de nos composants React, nous allons cr√©er
un fichier nomm√© <code>punkapi.js</code> √† la racine de notre projet.</p>
<pre><code class="hljs language-javascript"><span class="hljs-keyword">import</span> base64 <span class="hljs-keyword">from</span> <span class="hljs-string">"base-64"</span>; <span class="hljs-comment">// importez la d√©pendance tout juste install√©e</span>

<span class="hljs-keyword">const</span> rootEndpoint = <span class="hljs-string">"https://punkapi.com/api/v1"</span>;
<span class="hljs-comment">// pour simplifier la compr√©hension de ce tuto, nous renseignons la cl√© API "en dur"</span>
<span class="hljs-comment">// ne faites jamais cela au sein de vos projets (voir http://12factor.net/fr/config)</span>
<span class="hljs-keyword">const</span> punkApiKey = <span class="hljs-string">"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"</span>;
<span class="hljs-keyword">const</span> password = <span class="hljs-string">""</span>; <span class="hljs-comment">// la punk API n'utilise aucun mot de passe</span>
<span class="hljs-keyword">const</span> authBase64 = base64.encode(<span class="hljs-string">`<span class="hljs-subst">${punkApiKey}</span>:<span class="hljs-subst">${password}</span>`</span>);

<span class="hljs-keyword">const</span> headers = {
  <span class="hljs-string">"Content-Type"</span>: <span class="hljs-string">"application/json"</span>,
  <span class="hljs-attr">Accept</span>: <span class="hljs-string">"application/json"</span>,
  <span class="hljs-attr">Authorization</span>: <span class="hljs-string">`Basic <span class="hljs-subst">${authBase64}</span>`</span> <span class="hljs-comment">// HTTP basic auth</span>
};

<span class="hljs-comment">// retourne une recette de bi√®re au hasard</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> getRandomBrewdog = <span class="hljs-function"><span class="hljs-params">()</span> =></span>
  fetch(<span class="hljs-string">`<span class="hljs-subst">${rootEndpoint}</span>/beers/random`</span>, { headers }).then(
    <span class="hljs-function">(<span class="hljs-params">{ status, json }</span>) =></span> {
      <span class="hljs-keyword">if</span> (status !== <span class="hljs-number">200</span>)
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">`API answered with status code <span class="hljs-subst">${status}</span>`</span>); <span class="hljs-comment">// gestion du status code HTTP</span>
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">return</span> json(); <span class="hljs-comment">// on parse la r√©ponse en JSON</span>
    }
  );</code></pre>
<p>Nous allons maintenant modifier notre composant <code>&#x3C;App></code> afin de faire une
requ√™te simple d'une bi√®re au hasard juste avant le montage de celui-ci.</p>
<pre><code class="hljs language-javascript"><span class="hljs-keyword">import</span> { getRandomBrewdog } <span class="hljs-keyword">from</span> <span class="hljs-string">'./punkapi'</span>

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">App</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Component</span> </span>{
  componentWillMount() {
    getRandomBrewdog() <span class="hljs-comment">// fetch() retourne une Promise</span>
      .then(<span class="hljs-function"><span class="hljs-params">json</span> =></span> <span class="hljs-built_in">console</span>.log(json))
      .catch(<span class="hljs-function"><span class="hljs-params">error</span> =></span> <span class="hljs-built_in">console</span>.error(error))
  }

  ‚Ä¶
}</code></pre>
<p>Vous apercevez la pr√©sence d'un appel √† <code>console.log()</code>. Pour y acc√©der, rien de
plus simple: pressez <code>Command‚åò + D</code> au sein de l'√©mulateur iOS, ou appuyez sur
le bouton <code>Menu</code> de l'√©mulateur Android. Celui-ci contient de multiples choses
avec lesquelles je vous laisserai exp√©rimenter par la suite; ce qui nous
int√©resse ici c'est le bouton <code>Debug JS Remotely</code>, qui va ouvrir un nouvel
onglet dans Chrome o√π sera ex√©cut√© notre code JS.</p>
<p>Il devient donc possible d'ouvrir les Chrome Devtools (dont la console) afin de
d√©buguer notre app.</p>
<figure>
  <img src="devmenu.png" alt="devmenu + chrome devtools" />
  <figcaption>Jusqu'ici tout va bien</figcaption>
</figure>
<h2 id="pr√©sentation-des-donn√©es"><a href="#pr%C3%A9sentation-des-donn%C3%A9es" class="phenomic-HeadingAnchor">#</a>Pr√©sentation des donn√©es</h2>
<p>Afin d'afficher les informations que nous venons de r√©cup√©rer, nous allons avoir
besoin de plusieurs √©l√©ments (heureusement fournis), √† savoir de quoi encapsuler
d'autres composants (une <code>&#x3C;View></code> ~= une <code>&#x3C;div></code> HTML), de quoi rendre du texte
(<code>&#x3C;Text></code> ~= <code>&#x3C;span></code>), un bouton (nous allons utiliser <code>&#x3C;TouchableOpacity></code>,
une zone dont l'opacit√© est modifi√©e lors d'un <code>onTouch</code>) et enfin d'un spinner
pour indiquer qu'une requ√™te est en cours (<code>&#x3C;ActivityIndicator></code>).</p>
<p>Nous allons √©galement rendre notre unique composant stateful afin de stocker
quelques informations retourn√©es par l'API.</p>
<pre><code class="hljs language-javascript"><span class="hljs-keyword">import</span> React, { Component } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>
<span class="hljs-keyword">import</span> {
  AppRegistry,
  StyleSheet,
  ActivityIndicator, <span class="hljs-comment">// import des composants</span>
  TouchableOpacity,
  Text,
  View,
} <span class="hljs-keyword">from</span> <span class="hljs-string">'react-native'</span>

<span class="hljs-keyword">import</span> { getRandomBrewdog } <span class="hljs-keyword">from</span> <span class="hljs-string">'./punkapi'</span>

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">App</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Component</span> </span>{
  <span class="hljs-keyword">constructor</span>(props) {
    <span class="hljs-keyword">super</span>(props)

    <span class="hljs-comment">// la state de notre composant est utilis√© pour</span>
    <span class="hljs-comment">// stocker quelques infos renvoy√©es par l'API</span>
    <span class="hljs-keyword">this</span>.state = {
      <span class="hljs-attr">name</span>: <span class="hljs-string">''</span>, <span class="hljs-comment">// nom de la bi√®re</span>
      description: <span class="hljs-string">''</span>, <span class="hljs-comment">// sa description</span>
      isLoading: <span class="hljs-literal">false</span> <span class="hljs-comment">// la requ√™te API est-elle en cours¬†?</span>
    }
  }

  <span class="hljs-comment">// nous externalisons cette fonction afin de</span>
  <span class="hljs-comment">// pouvoir l'appeler lorsqu'on le souhaite</span>
  _getRandomBrewdogWithFeedback = <span class="hljs-function"><span class="hljs-params">()</span> =></span> {
    <span class="hljs-keyword">this</span>.setState({ <span class="hljs-attr">isLoading</span>: <span class="hljs-literal">true</span> })

    getRandomBrewdog()
      .then(<span class="hljs-function"><span class="hljs-params">json</span> =></span> <span class="hljs-keyword">this</span>.setState({
        <span class="hljs-attr">name</span>: json.name,
        <span class="hljs-attr">description</span>: json.description,
        <span class="hljs-attr">isLoading</span>: <span class="hljs-literal">false</span> <span class="hljs-comment">// la requ√™te est termin√©e</span>
      }))
      .catch(<span class="hljs-function"><span class="hljs-params">error</span> =></span> <span class="hljs-built_in">console</span>.error(error))
  }

  componentWillMount() {
    <span class="hljs-keyword">this</span>._getRandomBrewdogWithFeedback()
  }

  render() {
    <span class="hljs-keyword">const</span> content = <span class="hljs-keyword">this</span>.state.isLoading
      ? <span class="xml"><span class="hljs-tag">&#x3C;<span class="hljs-name">ActivityIndicator</span> /></span> // si requ√™te en cours, on affiche un spinner
      : </span>&#x3C;Text style={styles.welcome}>
          Welcome to PutainDeBiere!
        &#x3C;/Text><span class="xml">

    return (
      </span>&#x3C;View style={styles.container}>
        {content}
      &#x3C;/View><span class="xml">
    )
  }
}

‚Ä¶</span></code></pre>
<p>Votre application affiche dor√©navant un spinner quelques secondes avant de
rendre le fameux "Welcome to PutainDeBiere!" le temps que la requ√™te √† la
punkAPI se fasse. Continuons de customiser ce render afin d'afficher les
informations retourn√©es (et maintenant pr√©sentes dans le state de notre app).</p>
<pre><code class="hljs language-javascript"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">App</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Component</span> </span>{
  ‚Ä¶

  render() {
    <span class="hljs-keyword">const</span> content = <span class="hljs-keyword">this</span>.state.isLoading
      ? <span class="xml"><span class="hljs-tag">&#x3C;<span class="hljs-name">ActivityIndicator</span> /></span> // si requ√™te en cours, on affiche un spinner
      : </span>&#x3C;View style={styles.infosContainer}>
          &#x3C;Text style={styles.name}>
            {this.state.name} // sinon on affiche le nom de la bi√®re
          &#x3C;/Text>

          &#x3C;Text style={styles.description}>
            {this.state.description} // sa description
          &#x3C;/Text>

          &#x3C;TouchableOpacity // on ajoute un "bouton" qui requ√™te une autre bi√®re al√©atoire
            onPress={this._getRandomBrewdogWithFeedback}
            style={styles.button}
          >
            &#x3C;Text>Grab a new beer!&#x3C;/Text>
          &#x3C;/TouchableOpacity>
        &#x3C;/View><span class="xml">

    return (
      </span>&#x3C;View style={styles.container}>
        {content}
      &#x3C;/View><span class="xml">
    )
  }
}

const styles = StyleSheet.create({
  container: {
    flex: 1,
    justifyContent: 'center',
    alignItems: 'center',
    backgroundColor: '#F5FCFF',
  },
  // ajout de styles divers
  infosContainer: {
    margin: 30,
  },
  name: {
    fontSize: 18,
    fontWeight: '700',
    marginBottom: 10,
  },
  description: {
    marginBottom: 10,
  },
  button: {
    borderWidth: 1,
    borderColor: '#000',
    borderRadius: 3,
    padding: 5,
    justifyContent: 'center',
    alignItems: 'center',
  }
})</span></code></pre>
<figure>
  <img src="final_result.png" alt="devmenu + chrome devtools" />
  <figcaption>Le rendu "final"</figcaption>
</figure>
<h2 id="et-maintenant-"><a href="#et-maintenant-" class="phenomic-HeadingAnchor">#</a>Et maintenant ?</h2>
<p>Si vous connaissez d√©j√† React, vous pouvez:</p>
<ul>
<li>am√©liorer le code de l'app avec l'ajout de redux (par exemple) afin de
supprimer le state de notre composant</li>
<li>cr√©er un composant stateless "&#x3C;Button>"</li>
<li>styliser davantage l'app √† l'aide
d'<a href="https://facebook.github.io/react-native/docs/image.html">images</a> ou
d'<a href="https://facebook.github.io/react-native/docs/animations.html">animations</a></li>
<li>d√©sactiver et modifier le style du bouton lors d'une requ√™te API</li>
<li>g√©rer les erreurs de requ√™tage de fa√ßon un poil plus √©l√©gante que de balancer
une erreur √† la t√™te de l'utilisateur</li>
</ul>
<p>Si ce n'est pas le cas, n'h√©sitez pas √† lire ces deux articles pour vous
familiariser avec ces librairies avant de continuer sur votre lanc√©e:</p>
<ul>
<li><a href="/fr/articles/js/react/">Introduction √† ReactJS</a></li>
<li><a href="/fr/articles/js/redux/">Redux, comment √ßa marche ?</a></li>
</ul>
<p>Bonne d√©couverte !</p>
]]></description><link>http://putaindecode.io/fr/articles/js/react/native/introduction/</link><guid isPermaLink="true">http://putaindecode.io/fr/articles/js/react/native/introduction/</guid><pubDate>Tue, 04 Oct 2016 00:00:00 GMT</pubDate></item><item><title><![CDATA[Pourquoi j'ai arr√™t√© d'utiliser CSS]]></title><description><![CDATA[<p>CSS est un langage horriblement dangereux, parce qu'il m√™le des concepts
compl√®tement p√©t√©s et une folle capacit√© √† faire confondre facilit√© et
simplicit√© aux gens qui l'utilisent.</p>
<h2 id="quest-ce-qui-ne-va-pas-"><a href="#quest-ce-qui-ne-va-pas-" class="phenomic-HeadingAnchor">#</a>Qu'est-ce qui ne va pas ?</h2>
<p>√Ä l'origine, CSS a √©t√© con√ßu pour styler des documents, pas des applications. Du
coup lorsqu'on doit <em>scale</em>, c'est rapidement douloureux.</p>
<h3 id="les-s√©lecteurs"><a href="#les-s%C3%A9lecteurs" class="phenomic-HeadingAnchor">#</a>Les s√©lecteurs</h3>
<p>Les s√©lecteurs sont des <strong>variables globales mutables</strong>. Lorsque vous faites :</p>
<pre><code class="hljs language-css"><span class="hljs-selector-class">.selector</span> {
  <span class="hljs-attribute">font-size</span>: <span class="hljs-number">1rem</span>;
}</code></pre>
<p>C'est comme si en JavaScript vous faisiez :</p>
<pre><code class="hljs language-javascript"><span class="hljs-built_in">window</span>.selector = (<span class="hljs-built_in">window</span>.selector || []).concat({
  <span class="hljs-attr">fontSize</span>: <span class="hljs-string">"1rem"</span>
});</code></pre>
<p>√áa veut dire que :</p>
<ul>
<li>La d√©finition d'un style associ√© √† un s√©lecteur peut √™tre red√©finie ailleurs</li>
<li>Si on associe plusieurs styles √† un s√©lecteur, les derniers d√©finis dans le
CSS auront toujours la priorit√©</li>
<li>Quelqu'un peut p√©ter les styles d'un composant pour peu qu'il ne sache pas
qu'un s√©lecteur est utilis√© ailleurs</li>
</ul>
<h3 id="la-sp√©cificit√©"><a href="#la-sp%C3%A9cificit%C3%A9" class="phenomic-HeadingAnchor">#</a>La sp√©cificit√©</h3>
<p>Alors √ßa, c'est particuli√®rement dr√¥le : la sp√©cificit√© d'un s√©lecteur va
d√©finir la priorit√© d'application d'un style.</p>
<table>
<thead>
<tr>
<th>S√©lecteur</th>
<th>Sp√©cificit√©</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>*</code></td>
<td>0,0,0,0</td>
</tr>
<tr>
<td><code>li</code></td>
<td>0,0,0,1</td>
</tr>
<tr>
<td><code>li:first-line</code></td>
<td>0,0,0,2</td>
</tr>
<tr>
<td><code>ul li</code></td>
<td>0,0,0,2</td>
</tr>
<tr>
<td><code>ul ol+li</code></td>
<td>0,0,0,3</td>
</tr>
<tr>
<td><code>h1 + *[rel=up]</code></td>
<td>0,0,1,1</td>
</tr>
<tr>
<td><code>ul ol li.red</code></td>
<td>0,0,1,3</td>
</tr>
<tr>
<td><code>li.red.level</code></td>
<td>0,0,2,1</td>
</tr>
<tr>
<td><code>#x34y</code></td>
<td>0,1,0,0</td>
</tr>
</tbody>
</table>
<p>Si le style est d√©fini dans l'attribut <code>style</code>, la sp√©cificit√© est de 1,0,0,0.
Si une valeur associ√©e √† une propri√©t√© est suffix√©e d'un <code>!important</code>, elle
prend quoi qu'il arrive l'ascendance.</p>
<p>Si on r√©sume, on nage en plein d√©lire, la priorit√© se d√©finit dans l'ordre par :
la pr√©sence de <code>!important</code>, la fa√ßon de d√©finir le style, la sp√©cificit√© du
s√©lecteur utilis√© puis par l'ordre de d√©finition dans l'ensemble des CSS de la
page. √âvidemment, √† l'√©poque o√π on n'avait qu'une pauvre petite feuille de style
pour l'ensemble de son site, √ßa marchait ; plus maintenant.</p>
<h3 id="les-r√©gressions"><a href="#les-r%C3%A9gressions" class="phenomic-HeadingAnchor">#</a>Les r√©gressions</h3>
<p>Prenons un exemple tout b√™te :</p>
<pre><code class="hljs language-css"><span class="hljs-selector-class">.item</span> {
  <span class="hljs-attribute">display</span>: block;
  <span class="hljs-attribute">font-size</span>: <span class="hljs-number">1rem</span>;
  <span class="hljs-attribute">color</span>: blue;
}

<span class="hljs-selector-class">.some-context</span> <span class="hljs-selector-class">.item</span> {
  <span class="hljs-attribute">display</span>: inline-block;
  <span class="hljs-attribute">color</span>: red;
}</code></pre>
<p>Quelqu'un de la team modifie <code>.item</code> :</p>
<pre><code class="hljs language-diff"> .item {
   display: block;
   font-size: 1rem;
   color: blue;
<span class="hljs-addition">+  border: 1px solid red;</span>
 }

 .some-context .item {
   display: inline-block;
   color: red;
}</code></pre>
<p>Super, une regression dans <code>some-context</code>. Face √† √ßa, deux possibilit√©s :</p>
<ul>
<li>Vous vous foutez d'avoir des r√©gressions qui p√®tent votre site</li>
<li>√Ä chaque changement minime du CSS vous v√©rifiez l'int√©gralit√© du site et
testez tous les comportements dans tous les contextes.</li>
</ul>
<h3 id="le-choix-de-priorisation-des-styles"><a href="#le-choix-de-priorisation-des-styles" class="phenomic-HeadingAnchor">#</a>Le choix de priorisation des styles</h3>
<p>Ce serait pas mal de d√©cider quel <code>className</code> est appliqu√© en priorit√© :</p>
<pre><code class="hljs language-html"><span class="hljs-tag">&#x3C;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"blue red"</span>></span>text<span class="hljs-tag">&#x3C;/<span class="hljs-name">div</span>></span>
<span class="hljs-tag">&#x3C;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"red blue"</span>></span>text<span class="hljs-tag">&#x3C;/<span class="hljs-name">div</span>></span></code></pre>
<p>mais bien √©videmment non, comme vu plus haut, c'est le foutu ordre de d√©finition
des s√©lecteurs qui d√©cide. Je vous laisse imaginer le bordel si on charge les
feuilles de style √† la demande, selon les actions utilisateur.</p>
<pre><code class="hljs language-css"><span class="hljs-selector-class">.blue</span> {
  <span class="hljs-attribute">color</span>: blue;
}
<span class="hljs-selector-class">.red</span> {
  <span class="hljs-attribute">color</span>: red;
}</code></pre>
<p>C'est pire si vous utilisez un pr√©processeur tel que Sass et LESS. Lorsque vous
faites un :</p>
<pre><code class="hljs language-css"><span class="hljs-selector-class">.blue</span> {
  <span class="hljs-attribute">color</span>: blue;
}

<span class="hljs-selector-class">.red</span> {
  <span class="hljs-attribute">color</span>: red;
}

<span class="hljs-selector-class">.my-selector</span> {
  @extend .red;
  @extend .blue;
}</code></pre>
<p>Vous imaginez que <code>.blue</code> √©tant appliqu√© apr√®s dans <code>.my-selector</code>, il va
prendre la priorit√©. EH BAH NON, c'est <code>.red</code>, parce que sa d√©claration est
situ√©e apr√®s <code>.blue</code>.</p>
<p>Si ce constat peut aussi permettre √† ceux et celles qui utilisent des CSS
atomiques d'arr√™ter imm√©diatement :</p>
<pre><code class="hljs language-css"><span class="hljs-selector-class">.relative</span> {
  <span class="hljs-attribute">position</span>: relative;
}
<span class="hljs-selector-class">.absolute</span> {
  <span class="hljs-attribute">position</span>: absolute;
}
<span class="hljs-selector-class">.static</span> {
  <span class="hljs-attribute">position</span>: static;
}</code></pre>
<p>Dans le cas pr√©c√©dent, si vous ajoutez une classe <code>relative</code> √† un √©lement ayant
d√©j√† la classe <code>static</code>, √ßa ne changera rien du tout, parce que <code>.static</code> est
d√©fini apr√®s <code>.relative</code>. G√©nial, non ?</p>
<h3 id="le-futur-de-css"><a href="#le-futur-de-css" class="phenomic-HeadingAnchor">#</a>Le futur de CSS</h3>
<p>Les variables sont une feature qui a √©t√© tr√®s demand√©e √† CSS. Mais cette feature
va d√©barquer avec son lot de souci :</p>
<pre><code class="hljs language-css"><span class="hljs-selector-pseudo">:root</span> {
  <span class="hljs-attribute">--mainColor</span>: blue;
}

<span class="hljs-selector-tag">body</span> {
  <span class="hljs-attribute">color</span>: <span class="hljs-built_in">var</span>(--mainColor);
}</code></pre>
<p>C'est super, mais si quelqu'un vient ajouter :</p>
<pre><code class="hljs language-css"><span class="hljs-selector-pseudo">:root</span> {
  <span class="hljs-attribute">--mainColor</span>: red;
}</code></pre>
<p>quelque part, il y a deux cas :</p>
<ul>
<li>soit c'est charg√© avant, et √ßa ne fait rien</li>
<li>soit c'est charg√© apr√®s, et √ßa override toutes les propri√©t√©s utilisant
<code>--mainColor</code>. On est bien contents.</li>
</ul>
<h2 id="vous-ne-pouvez-pas-vous-permettre-de-laisser-tomber-css-"><a href="#vous-ne-pouvez-pas-vous-permettre-de-laisser-tomber-css-" class="phenomic-HeadingAnchor">#</a>Vous ne pouvez pas vous permettre de laisser tomber CSS ?</h2>
<p>Dans ce cas, forcez vous √† utiliser la <a href="/fr/articles/css/bem/">m√©thodologie
BEM</a>. √áa ne r√©glera pas tout, mais au moins cela vous
permettra d'√©viter un maximum de conneries en vous for√ßant √† d√©couper en
composants isol√©s, et √† mieux ma√Ætriser la priorisation, puisque le scope auquel
vous devrez y veiller sera consid√©rablement r√©duit :</p>
<pre><code class="hljs language-css"><span class="hljs-comment">/* Header.css */</span>
<span class="hljs-selector-class">.Header</span> {
}

<span class="hljs-selector-class">.Header-nav</span> {
}

<span class="hljs-comment">/* Nav.css */</span>
<span class="hljs-selector-class">.Nav</span> {
}

<span class="hljs-selector-class">.Nav-item</span> {
}

<span class="hljs-selector-class">.Nav-item--active</span> {
}</code></pre>
<p>C'est quand m√™me plus pratique √† comprendre, non ?</p>
<p>Encore mieux, si vous avez du tooling √† la webpack, vous pouvez utiliser les
<a href="/fr/articles/css/modules/">CSS modules</a>, qui limiteront de m√™me le scope
d'application de vos feuilles de style.</p>
<h2 id="vous-pouvez-vous-permettre-de-laisser-tomber-css-"><a href="#vous-pouvez-vous-permettre-de-laisser-tomber-css-" class="phenomic-HeadingAnchor">#</a>Vous pouvez vous permettre de laisser tomber CSS ?</h2>
<p>JavaScript vous permet d√©j√† de b√©n√©ficier d'un syst√®me de modules, de variables,
de conditions, de fonctions r√©utilisables, et tout √ßa sans hack. En plus de √ßa,
vous maitrisez la priorisation, parce c'est que c'est vous qui d√©cidez ce qui
s'applique :</p>
<pre><code class="hljs language-javascript"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyComponent</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span> </span>{
  render() {
    <span class="hljs-keyword">const</span> { active, disabled } = <span class="hljs-keyword">this</span>.props;
    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&#x3C;<span class="hljs-name">div</span>
        <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span>
          <span class="hljs-attr">...styles.myComponent</span>,
          <span class="hljs-attr">...</span>(<span class="hljs-attr">active</span> ? <span class="hljs-attr">styles.active</span> <span class="hljs-attr">:</span> <span class="hljs-attr">null</span>),
          <span class="hljs-attr">...</span>(<span class="hljs-attr">disabled</span> &#x26;&#x26; !<span class="hljs-attr">active</span> ? <span class="hljs-attr">styles.disabled</span> <span class="hljs-attr">:</span> <span class="hljs-attr">null</span>)
        }}
      ></span>
        tadaa
      <span class="hljs-tag">&#x3C;/<span class="hljs-name">div</span>></span></span>
    );
  }
}

<span class="hljs-keyword">const</span> styles = {
  <span class="hljs-attr">myComponent</span>: {
    <span class="hljs-attr">fontSize</span>: <span class="hljs-number">18</span>
  },
  <span class="hljs-attr">active</span>: {
    <span class="hljs-attr">textDecoration</span>: <span class="hljs-string">"underline"</span>
  },
  <span class="hljs-attr">disabled</span>: {
    <span class="hljs-attr">opacity</span>: <span class="hljs-number">0.5</span>
  }
};</code></pre>
<p>Par ailleurs, avec certaines biblioth√®ques permettant naturellement l'usage
d'inline-styles (comme React), cela vous donne la possibilit√© d'avoir le style
et le markup dans le m√™me fichier, sans avoir besoin de naviguer entre les
onglets de votre √©diteur (vous pouvez cependant s√©parer en plusieurs fichiers si
√ßa vous fait plaisir).</p>
<p>En r√©sum√©, utiliser JS pour d√©finir et appliquer les styles vous permet de
prendre le contr√¥le sur le styling de vos composants, tout en apportant le
confort d'un langage offrant naturellement de nombreux avantages. Si vous √™tes
bloqu√©s avec CSS, partez sur les CSS modules ou la m√©thologie BEM selon vos
possibilit√©s. Le but, c'est d'√©liminer les <a href="https://github.com/necolas/react-native-web/blob/master/docs/guides/style.md">7 maux de
CSS</a>.</p>
<p>Bisous bisous.</p>
<h2 id="edit"><a href="#edit" class="phenomic-HeadingAnchor">#</a>Edit</h2>
<p>Afin de r√©pondre aux diverses incompr√©hensions et commentaires en r√©ponse √†
l‚Äôarticle, voil√† un follow-up qui va tenter d‚Äôaller plus en profondeur dans la
critique de CSS.</p>
<p>Je vais donc r√©pondre √† <a href="http://www.glazman.org/weblog/dotclear/index.php?post/2016/06/18/Pourquoi-il-n-aurait-pas-du-arr%C3%AAter-d-utiliser-CSS">l‚Äôarticle de Daniel
Glazman</a>,
ancien co-chairman du CSS Working Group.</p>
<p>Le premier point n‚Äôa rien √† voir avec le sujet, mais l‚Äôauteur fait un parall√®le
entre la r√©assignation dans JS et la mutabilit√© et absence de scope des
s√©lecteurs CSS. La comparaison n‚Äôa pas lieu d‚Äô√™tre, parce que JS est un langage
de programmation. De plus, en JS, les variables ont une port√©e, et l‚Äôop√©rateur
<code>const</code> existe pour pr√©venir la r√©assignation. <code>&#x3C;/digression></code></p>
<p>Le grand probl√®me de l‚Äô√©tat actuel des s√©lecteurs CSS, c‚Äôest qu‚Äôils n‚Äôoffrent
naturellement aucune API (hors <em>Shadow DOM</em>) permettant de limiter le scope d‚Äôun
s√©lecteur sans augmenter sa sp√©cificit√©. Si je veux ajouter des propri√©t√©s de
style √† un √©l√©ment comportant un certain s√©lecteur dans un certain contexte, je
suis oblig√© d‚Äôavoir connaissance de tous les s√©lecteurs correspondant
potentiellement √† cet √©l√©ments, de v√©rifier leur sp√©cificit√©, et possiblement
d‚Äôadapter le s√©lecteur simple que j‚Äôenvisageais √† l‚Äôorigine pour pallier le
manque de sp√©cificit√©. Super, ma codebase contient maintenant des s√©lecteurs
diff√©rents de leur sens original dans le simple but de les appliquer.</p>
<p>Lorsque je lis la r√©action √©pidermique de l‚Äôauteur face √† BEM, une m√©thodologie
ajoutant un namespace pour simuler ce scope c√¥t√© utilisateur qui apporte un
minimum de s√©curit√© lorsque l‚Äôon travaille sur un projet √† grande √©chelle,
j‚Äôavoue un peu flipper quant √† la conception des sp√©cifications CSS.</p>
<p>BEM est une r√©ponse de la communaut√© d‚Äôutilisateurs √† plusieurs soucis qu‚Äôils
ont rencontr√©s dans leurs utilisations vari√©es de CSS. On dirait m√™me dans sa
r√©ponse qu‚Äôil n‚Äôa pas pris le temps de se renseigner sur la nature de la
m√©thodologie, qui ne consiste selon lui qu‚Äô√† ajouter des indentations dont on se
fout parce que CSSOM les ignore. WTF.</p>
<p>Ignorer le feedback que constitue l‚Äôapparition de cette m√©thodologie et d√©nigrer
les utilisateurs pour qui elle r√®gle des probl√®mes pos√©s par le laxisme du
langage, √ßa ne fait pas avancer le langage, et √ßa ne donnera certainement pas
envie de retourner √† CSS.</p>
<p>Concernant la sp√©cificit√© des s√©lecteurs, √©videmment qu‚Äôune quantit√©
astronomique de sites utilise les s√©lecteurs CSS, simplement parce qu‚Äôils n‚Äôont
pas eu d‚Äôalternative viable. √áa n‚Äôen fait pas une fonctionnalit√© bien con√ßue
pour autant.</p>
<p>Sur les r√©gressions, l‚Äôid√©e √† comprendre, c‚Äôest que l‚Äôabsence de scope et de
namespace dans le langage peut cr√©er des r√©gressions potentiellement partout
dans un large site, parce qu‚Äôun s√©lecteur est global. Il n‚Äôy a pas moyen de
s√©curiser un rayon d‚Äôaction pour travailler, √† moins de g√©rer le namespace
soi-m√™me, dans le s√©lecteur.</p>
<p>Concernant le choix de priorisation des styles, c'est un fait que l'ordre de la
<code>DOMTokenList</code> n‚Äôa pas d'importance actuellement, et je ne fais que d√©plorer
qu‚Äôen utilisant des s√©lecteurs, le choix de l‚Äôapplication des styles ne puisse
pas se faire √† l‚Äôendroit o√π l‚Äô√©l√©ment est utilis√©, avec la connaissance pr√©cise
de son contexte.</p>
<p>Sur le futur de CSS, le reproche que je dresse n'est pas comme ce qui est
interpr√©t√© dans le post de l'auteur, disant que je r√¢le parce que si l'on fait
un parall√®le avec JS, on aurait :</p>
<pre><code class="hljs language-javascript"><span class="hljs-keyword">var</span> a = <span class="hljs-number">1</span>;
<span class="hljs-keyword">var</span> a = <span class="hljs-number">2</span>;
alert(a);
<span class="hljs-comment">// alerts 2</span></code></pre>
<p>C‚Äôest un comportement parfaitement attendu. Et ce n‚Äôest pas ce que j‚Äôai dit, je
reproche √† CSS de faire en sorte que, si l‚Äôon fait encore le parall√®le :</p>
<pre><code class="hljs language-javascript"><span class="hljs-comment">// coucou c'est CSS</span>
<span class="hljs-keyword">var</span> a = <span class="hljs-number">1</span>;
alert(a);
<span class="hljs-keyword">var</span> a = <span class="hljs-number">2</span>;
<span class="hljs-comment">// alerts 2</span></code></pre>
<p>Sur ma proposition alternative, outre √™tre <em>‚Äúune horreur non-maintenable,
verbeuse et error-prone‚Äù</em>, on va regarder ce que √ßa donne sur un cas plus simple
:</p>
<pre><code class="hljs language-javascript"><span class="hljs-keyword">import</span> React, { Component } <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>;
<span class="hljs-comment">// un syst√®me de modules analysable statiquement</span>
<span class="hljs-keyword">import</span> { mainBlue, mainRed } <span class="hljs-keyword">from</span> <span class="hljs-string">"../utils/Colors"</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> props => {
  <span class="hljs-keyword">return</span> (
    <span class="hljs-comment">// on peut appliquer un style dont le rayon d'action est par d√©finition</span>
    <span class="hljs-comment">// limit√© √† l‚Äô√©l√©ment sur lequel on le place</span>
    &#x3C;div style={styles.container}>
      {list.map(<span class="hljs-function">(<span class="hljs-params">item, index</span>) =></span> (
        <span class="xml"><span class="hljs-tag">&#x3C;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{styles.item}</span>></span>
          </span>&#x3C;span
            style={{
              ...styles.text,
              // appliquer un style conditionn√© par le contexte est tr√®s simple
              // et permet de prioriser √† la d√©finition du markup
              ...(index % 2 === 0 &#x26;&#x26; styles.oddText)
            }}
          >
            {item.text}
          &#x3C;/span><span class="xml">
        <span class="hljs-tag">&#x3C;/<span class="hljs-name">div</span>></span></span>
      ))}
    &#x3C;<span class="hljs-regexp">/div>
  );
};

/</span><span class="hljs-regexp">/ la feuille de style est limit√©e au module
const styles = {
  container: {
    display: "flex",
    flexDirection: "row"
  },
  item: {
    flexBasis: 200
  },
  text: {
    /</span><span class="hljs-regexp">/ peut utiliser des variables qui ne seront pas √©cras√©es si j'en d√©finis
    /</span><span class="hljs-regexp">/ une avec le m√™me nom ailleurs dans l'app
    color: mainBlue
  },
  oddText: {
    color: mainRed
  }
};</span></code></pre>
<p>C‚Äôest juste une application d‚Äôune approche centr√©e sur les composants.
L‚Äôimportant, c‚Äôest d‚Äôisoler ces composants pour les rendre facilement
r√©utilisables, pr√©venir les effets de bord, et passer moins de temps √† essayer
de travailler avec des propri√©t√©s du langage qui nous g√™nent dans notre travail
de tous les jours. R√©duire la libert√© d‚Äôutilisation permet ici d‚Äôapporter des
propri√©t√©s (immutabilit√© des styles, application d√©terministe des styles, scope)
qui nous permettent de raisonner notre code de mani√®re beaucoup plus simple.</p>
<p>Si l‚Äôon regarde du c√¥t√© des CSS modules, qu‚Äôest-ce que √ßa fait exactement ? La
m√™me chose. Le tooling va limiter le scope d‚Äôune feuille de style en rendant
opaques et globalement uniques les s√©lecteurs. Le CSS peut √™tre utilis√© en
target de compilation sans probl√®me, et la plupart des solutions rendant son
utilisation confortable font une chose simple : contraindre √† une utilisation
plus stricte en masquant des parties trop laxistes du langage. C‚Äôest ce que le
tooling JS a connu depuis quelques ann√©es, et on ne s‚Äôen porte que mieux.</p>
<p>Le dernier argument utilis√© est que ¬´ si le monde entier a adopt√© CSS (y compris
le monde de l'√©dition qui vient pourtant de solutions assez radicalement
diff√©rentes du Web), c'est bien parce que c'est bien et que √ßa marche ¬ª.
Qu‚Äôest-ce qu‚Äôon peut r√©pondre sinon que CSS a √©t√© adopt√© avant que les besoins
du web n'aient suffisamment √©volu√© pour que CSS dans son √©tat actuel ait un
√©norme potentiel de fragilisation d‚Äôune codebase. Ne pas remettre en question le
langage parce que ses utilisateurs n‚Äôont pas d‚Äôalternative, c‚Äôest condamner le
langage. C‚Äôest comme si la SNCF disait ¬´ BOARF √ßa sert √† rien de faire arriver
les trains √† l‚Äôheure, vu que tout le monde le prend d√©j√† c‚Äôest que c‚Äôest nickel
¬ª. Du coup, faut pas venir s‚Äô√©tonner que certains de ces utilisateurs aillent
chercher des alternatives ailleurs.</p>
<p>En conclusion, je d√©plore vraiment l'absence d'int√©r√™t apparent de l'auteur pour
√©couter le feedback des utilisateurs sur les probl√®mes d'un langage. Il faut
regarder ailleurs, et ne pas ignorer ou m√©priser ce que les utilisateurs font de
leur c√¥t√© pour travailler plus sainement, √ßa pourrait m√™me donner des id√©es pour
am√©liorer ce qui fait perdre du temps aux utilisateurs.</p>
]]></description><link>http://putaindecode.io/fr/articles/css/stop-css/</link><guid isPermaLink="true">http://putaindecode.io/fr/articles/css/stop-css/</guid><pubDate>Thu, 16 Jun 2016 00:00:00 GMT</pubDate></item><item><title><![CDATA[Les patterns Provider & Higher-Order Component avec React]]></title><description><![CDATA[<h2 id="le-pattern-provider"><a href="#le-pattern-provider" class="phenomic-HeadingAnchor">#</a>Le pattern provider</h2>
<p>Beaucoup de bibliot√®ques React ont besoin de faire passer des data au travers de
tout l'arbre de composants de votre app. Par exemple Redux a besoin de passer
son <em>store</em> et React Router doit passer l'objet <em>location</em>. Tout √ßa pourrait
possiblement passer par du <em>shared mutable state</em> (√©tat global mutable, ce qui
est rarement une bonne id√©e). Le <em>shared mutable state</em> rend impossible une
application √† plus d'un contexte. En d'autres mots, √ßa ne marcherait que sur le
client, o√π l'√©tat global correspond √† celui de l'utilisateur. Si vous d√©cidez de
rendre la page c√¥t√© serveur, c'est impossible de reposer sur une telle
impl√©mentation : cet √©tat ne doit pas d√©passer le scope de la requ√™te courante
au serveur.</p>
<p>Coup de bol, l'API de React nous offre une solution √† ce probl√®me: le
<a href="http://facebook.github.io/react/docs/context.html"><code>context</code></a>. Si l'on r√©sume
sa nature, c'est comme l'objet global de votre arbre de composants.</p>
<p>Le <code>context</code> fonctionne de la fa√ßon suivante:</p>
<ul>
<li>On d√©finit haut dans notre app un <code>context</code> que l'on donne aux composants
descendants de l'app</li>
<li>On r√©cup√®re ce contexte dans les composants descendants.</li>
</ul>
<p>Du coup, pour <em>donner</em> ce <code>context</code>, on doit avoir un <code>Provider</code>. Son r√¥le est
simplement de fournir un <code>context</code> pour que les composants enfants y aient
acc√®s.</p>
<p>On va illustrer ce pattern avec un use-case tr√®s simple : dans notre app, les
utilisateurs peuvent customiser le th√®me.</p>
<pre><code class="hljs language-javascript"><span class="hljs-keyword">import</span> React, { Component, PropTypes, Children } <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ThemeProvider</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Component</span> </span>{
  <span class="hljs-comment">// la m√©thode getChildContext est appel√©e pour fournir le `context`</span>
  <span class="hljs-comment">// dans notre cas, on le r√©cup√®re des `props`</span>
  getChildContext() {
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">theme</span>: <span class="hljs-keyword">this</span>.props.theme
    };
  }
  <span class="hljs-comment">// on render l'enfant</span>
  render() {
    <span class="hljs-keyword">return</span> Children.only(<span class="hljs-keyword">this</span>.props.children);
  }
}

ThemeProvider.propTypes = {
  <span class="hljs-attr">theme</span>: PropTypes.object.isRequired
};

<span class="hljs-comment">// pour que React prenne en compte le context fourni,</span>
<span class="hljs-comment">// on doit d√©finir les types des propri√©t√©s que l'on passe</span>
ThemeProvider.childContextTypes = {
  <span class="hljs-attr">theme</span>: PropTypes.object.isRequired
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> ThemeProvider;</code></pre>
<p>Pour utiliser le provider, il suffit de wrapper notre app avec:</p>
<pre><code class="hljs language-javascript"><span class="hljs-keyword">import</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>;
<span class="hljs-keyword">import</span> ReactDOM <span class="hljs-keyword">from</span> <span class="hljs-string">"react-dom"</span>;

<span class="hljs-keyword">import</span> ThemeProvider <span class="hljs-keyword">from</span> <span class="hljs-string">"ThemeProvider"</span>;
<span class="hljs-keyword">import</span> App <span class="hljs-keyword">from</span> <span class="hljs-string">"App"</span>;

<span class="hljs-keyword">const</span> theme = {
  <span class="hljs-attr">color</span>: <span class="hljs-string">"#cc3300"</span>,
  <span class="hljs-attr">fontFamily</span>: <span class="hljs-string">"Georgia"</span>
};

ReactDOM.render(
  <span class="xml"><span class="hljs-tag">&#x3C;<span class="hljs-name">ThemeProvider</span> <span class="hljs-attr">theme</span>=<span class="hljs-string">{theme}</span>></span>
    </span>&#x3C;App /><span class="xml">
  <span class="hljs-tag">&#x3C;/<span class="hljs-name">ThemeProvider</span>></span></span>,
  <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">"#App"</span>)
);</code></pre>
<p>Maintenant que notre <code>theme</code> est bien ajout√© au <code>context</code>, on a besoin d'un
moyen simple pour que nos composants dans l'app puissent le consommer. √áa nous
am√®ne au second pattern.</p>
<h2 id="le-pattern-higher-order-component"><a href="#le-pattern-higher-order-component" class="phenomic-HeadingAnchor">#</a>Le pattern Higher-Order Component</h2>
<p>Afin de consommer le <code>context</code>, un component doit d√©finir une propri√©t√© statique
<code>contextTypes</code> stipulant quelles propri√©t√©s le composant souhaite r√©cup√©rer. On
pourrait le d√©finir sur chaque composant, mais cela serait une mauvaise id√©e
pour deux raisons :</p>
<ul>
<li><strong>La maintenabilit√©</strong> : si √† un moment, on a besoin de refacto, avoir tous ces
<code>contextTypes</code> √©parpill√©s dans notre repository peut faire bien mal.</li>
<li><strong>La complexit√©</strong>: L'API des <code>context</code> √©tant encore obscure pour beaucoup, il
est pr√©f√©rable de faire une abstraction pour la masquer.</li>
</ul>
<p>Une autre solution serait d'utiliser l'h√©ritage d'une sous-classe de
<code>ReactComponent</code>. √áa ne marche pas pour deux raisons:</p>
<ul>
<li>Plus d'un niveau d'h√©ritage est en g√©n√©ral une id√©e de merde. Cela m√®ne
souvent √† des conflits entre m√©thodes, et force √† v√©rifier toute la cha√Æne
d'h√©ritage √† chaque fois que l'on souhaite modifier quelque chose. L'API des
<code>mixins</code> de <code>React.createClass</code> r√©glait ce souci en d√©finissant des
comportements de merge selon les m√©thodes, mais cela rend encore plus obscure
la compr√©hension du fonctionnement de nos composants.</li>
<li>Si l'on veut des APIs <strong>interop√©rables</strong>, on ne peut pas partir de l'h√©ritage.
React offre trois moyens de d√©finir un composant: <code>class extends React.Component {}</code>, <code>React.createClass({})</code> et <code>(props) => ReactElement</code>. Les
deux derniers ne peuvent pas b√©n√©ficier de l'h√©ritage.</li>
</ul>
<p>La meilleure fa√ßon de cr√©er une fonctionnalit√© r√©utilisable est d'utiliser le
pattern du <strong>Higher Order Component</strong> (ou <em>HOC</em>). Ce que √ßa veut dire, c'est
qu'on va simplement wrapper un composant dans un autre, lequel a pour unique
r√¥le d'injecter la fonctionnalit√© et de la passer via les <code>props</code>. Il s'agit
tout b√™tement du principe de composition : au lieu d'exporter <code>A</code>, vous exportez
<code>Wrapped(A)</code>, et ce dernier retourne un composant React qui va appeler <code>A</code> dans
sa m√©thode <code>render</code>.</p>
<p>Pour le voir simplement, il s'agit d'un point interm√©diaire dans l'arbre de vos
composants, qui injecte quelques <code>props</code>. Il existe beaucoup d'avantages
apport√©s par ce pattern :</p>
<ul>
<li><strong>Isolation</strong> : Il n'y a pas de risque de collision de propri√©t√©s au sein du
composant.</li>
<li><strong>Interop√©rabilit√©</strong> : Ce principe s'adapte √† tout composant React, peu
importe la fa√ßon dont il a √©t√© d√©fini.</li>
<li><strong>Maintenabilit√©</strong> : Le wrapper n'aura qu'une seule fonctionnalit√©, ce qui le
rend plus simple √† comprendre. De plus, si l'on utilise le <code>context</code>, on ne
trouvera le mapping <code>contextTypes</code> qu'√† un seul endroit dans l'app.</li>
</ul>
<pre><code class="hljs language-javascript"><span class="hljs-keyword">import</span> React, { Component, PropTypes } <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>

<span class="hljs-keyword">const</span> themed = <span class="hljs-function">(<span class="hljs-params">ComponentToWrap</span>) =></span> {
  <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ThemeComponent</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Component</span> </span>{
    render() {
      <span class="hljs-keyword">const</span> { theme } = <span class="hljs-keyword">this</span>.context
      <span class="hljs-comment">// le component va render `ComponentToWrap`</span>
      <span class="hljs-comment">// mais il va y ajouter la prop `theme`, qu'il r√©cup√®re du `context`</span>
      <span class="hljs-keyword">return</span> (
        <span class="xml"><span class="hljs-tag">&#x3C;<span class="hljs-name">ComponentToWrap</span> {‚Ä¶<span class="hljs-attr">this.props</span>} <span class="hljs-attr">theme</span>=<span class="hljs-string">{theme}</span> /></span>
      )
    }
  }
  // on d√©finit ce qu'on veut consommer du `context`
  ThemeComponent.contextTypes = {
    theme: PropTypes.object.isRequired,
  }

  // on retourne notre wrapper
  return ThemeComponent
}
export default themed</span></code></pre>
<p>Pour utiliser notre HOC, il suffira d'exporter nos composants wrapp√©s :</p>
<pre><code class="hljs language-javascript"><span class="hljs-keyword">import</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">"React"</span>;
<span class="hljs-keyword">import</span> themed <span class="hljs-keyword">from</span> <span class="hljs-string">"themed"</span>;

<span class="hljs-keyword">const</span> MyStatelessComponent = <span class="hljs-function">(<span class="hljs-params">{ text, theme }</span>) =></span> (
  <span class="xml"><span class="hljs-tag">&#x3C;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">color:</span> <span class="hljs-attr">theme.color</span> }}></span>{text}<span class="hljs-tag">&#x3C;/<span class="hljs-name">div</span>></span></span>
);

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> themed(MyStatelessComponent);</code></pre>
<p>Puisqu'il s'agit simplement d'une fonction, on peut y passer des options √†
l'aide d'une simple closure.</p>
<pre><code class="hljs language-javascript"><span class="hljs-keyword">const</span> defaultMergeProps = <span class="hljs-function">(<span class="hljs-params">ownProps, themeProps</span>) =></span> ({  ...ownProps, ...themeProps })

<span class="hljs-keyword">const</span> theme = <span class="hljs-function">(<span class="hljs-params">mergeProps = defaultMergeProps</span>) =></span>
  (ComponentToWrap) => {
    <span class="hljs-comment">// ‚Ä¶</span>
    render() {
      <span class="hljs-keyword">const</span> { theme } = <span class="hljs-keyword">this</span>.context
      <span class="hljs-keyword">const</span> props = mergeProps(<span class="hljs-keyword">this</span>.props, { theme })
      <span class="hljs-keyword">return</span> (
        <span class="xml"><span class="hljs-tag">&#x3C;<span class="hljs-name">ComponentToWrap</span> {‚Ä¶<span class="hljs-attr">props</span>} /></span>
      )
    }
    // ‚Ä¶
  }</span></code></pre>
<p>et l'utiliser de cette fa√ßon :</p>
<pre><code class="hljs language-javascript"><span class="hljs-keyword">const</span> mergeProps = <span class="hljs-function">(<span class="hljs-params">ownProps, themeProps</span>) =></span> ({
  ...themeProps,
  <span class="hljs-attr">color</span>: themeProps.theme.color
});
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> theme(mergeProps)(MyComponent);</code></pre>
<p>Une astuce sympathique lorsque vous utilisez plusieurs HOC, c'est de les
composer, puisque <code>compose(A, B, C)(props)</code> vaudra <code>A(B(C(props)))</code>, par exemple
:</p>
<pre><code class="hljs language-javascript"><span class="hljs-keyword">const</span> composed = compose(connect(mapStateToProps), theme());

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> composed(MyComponent);</code></pre>
<p>Bisous bisous.</p>
]]></description><link>http://putaindecode.io/fr/articles/js/react/higher-order-component/</link><guid isPermaLink="true">http://putaindecode.io/fr/articles/js/react/higher-order-component/</guid><pubDate>Tue, 14 Jun 2016 00:00:00 GMT</pubDate></item></channel></rss>